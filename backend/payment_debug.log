2025-05-10 14:19:15 - Yêu cầu OPTIONS được nhận
2025-05-10 14:19:15 - Kết nối cơ sở dữ liệu thành công
2025-05-10 14:19:15 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":2,"danh_muc":"CPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":28000000,"orderDate":"2025-05-10T07:19:15.795Z"}
2025-05-10 14:19:15 - Chuyển đổi ngay_dat_hang: 2025-05-10T07:19:15.795Z thành 2025-05-10 07:19:15
2025-05-10 14:19:15 - Xác thực đầu vào thành công
2025-05-10 14:19:15 - Tạo địa chỉ giao hàng mới với ID: 29 cho pickup
2025-05-10 14:19:15 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '29', '28030000', 'Chờ xử lý', '2025-05-10 07:19:15', '')
2025-05-10 14:19:15 - Chèn đơn hàng với ID: 36
2025-05-10 14:19:15 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('36', 'cpu001', 'Intel Core i9-13900K', 'CPU', '2', '14000000', 'pickup')
2025-05-10 14:19:15 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('36', 'cod', '28030000', 'Chưa thanh toán')
2025-05-10 14:19:16 - Giao dịch COD được xác nhận thành công
2025-05-10 14:19:16 - Đóng kết nối cơ sở dữ liệu
2025-05-10 14:19:59 - Yêu cầu OPTIONS được nhận
2025-05-10 14:19:59 - Kết nối cơ sở dữ liệu thành công
2025-05-10 14:19:59 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":2,"danh_muc":"CPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":28000000,"orderDate":"2025-05-10T07:19:59.870Z"}
2025-05-10 14:19:59 - Chuyển đổi ngay_dat_hang: 2025-05-10T07:19:59.870Z thành 2025-05-10 07:19:59
2025-05-10 14:19:59 - Xác thực đầu vào thành công
2025-05-10 14:19:59 - Tạo địa chỉ giao hàng mới với ID: 30 cho pickup
2025-05-10 14:19:59 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '30', '28030000', 'Chờ xử lý', '2025-05-10 07:19:59', '')
2025-05-10 14:19:59 - Chèn đơn hàng với ID: 37
2025-05-10 14:19:59 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('37', 'cpu001', 'Intel Core i9-13900K', 'CPU', '2', '14000000', 'pickup')
2025-05-10 14:19:59 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('37', 'cod', '28030000', 'Chưa thanh toán')
2025-05-10 14:19:59 - Giao dịch COD được xác nhận thành công
2025-05-10 14:19:59 - Đóng kết nối cơ sở dữ liệu
2025-05-10 14:21:54 - Yêu cầu OPTIONS được nhận
2025-05-10 14:21:54 - Kết nối cơ sở dữ liệu thành công
2025-05-10 14:21:54 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":2,"danh_muc":"CPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":28000000,"orderDate":"2025-05-10T07:21:54.624Z"}
2025-05-10 14:21:54 - Chuyển đổi ngay_dat_hang: 2025-05-10T07:21:54.624Z thành 2025-05-10 07:21:54
2025-05-10 14:21:54 - Xác thực đầu vào thành công
2025-05-10 14:21:54 - Tạo địa chỉ giao hàng mới với ID: 31 cho pickup
2025-05-10 14:21:54 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '31', '28030000', 'Chờ xử lý', '2025-05-10 07:21:54', '')
2025-05-10 14:21:54 - Chèn đơn hàng với ID: 38
2025-05-10 14:21:54 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('38', 'cpu001', 'Intel Core i9-13900K', 'CPU', '2', '14000000', 'pickup')
2025-05-10 14:21:54 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('38', 'cod', '28030000', 'Chưa thanh toán')
2025-05-10 14:21:54 - Giao dịch COD được xác nhận thành công
2025-05-10 14:21:54 - Đóng kết nối cơ sở dữ liệu
2025-05-10 14:24:36 - Yêu cầu OPTIONS được nhận
2025-05-10 14:24:36 - Kết nối cơ sở dữ liệu thành công
2025-05-10 14:24:36 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"cpu002","ten":"Intel Core i9-14900K","gia":14990000,"so_luong":3,"danh_muc":"CPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":44970000,"orderDate":"2025-05-10T07:24:36.181Z"}
2025-05-10 14:24:36 - Chuyển đổi ngay_dat_hang: 2025-05-10T07:24:36.181Z thành 2025-05-10 07:24:36
2025-05-10 14:24:36 - Xác thực đầu vào thành công
2025-05-10 14:24:36 - Tạo địa chỉ giao hàng mới với ID: 32 cho pickup
2025-05-10 14:24:36 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '32', '45000000', 'Chờ xử lý', '2025-05-10 07:24:36', '')
2025-05-10 14:24:36 - Chèn đơn hàng với ID: 39
2025-05-10 14:24:36 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('39', 'cpu002', 'Intel Core i9-14900K', 'CPU', '3', '14990000', 'pickup')
2025-05-10 14:24:36 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('39', 'cod', '45000000', 'Chưa thanh toán')
2025-05-10 14:24:36 - Giao dịch COD được xác nhận thành công
2025-05-10 14:24:36 - Đóng kết nối cơ sở dữ liệu
2025-05-10 14:35:26 - Yêu cầu OPTIONS được nhận
2025-05-10 14:35:26 - Kết nối cơ sở dữ liệu thành công
2025-05-10 14:35:26 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"cpu002","ten":"Intel Core i9-14900K","gia":14990000,"so_luong":3,"danh_muc":"CPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":44970000,"orderDate":"2025-05-10T07:35:26.291Z"}
2025-05-10 14:35:26 - Chuyển đổi ngay_dat_hang: 2025-05-10T07:35:26.291Z thành 2025-05-10 07:35:26
2025-05-10 14:35:26 - Xác thực đầu vào thành công
2025-05-10 14:35:26 - Tạo địa chỉ giao hàng mới với ID: 33 cho pickup
2025-05-10 14:35:26 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '33', '45000000', 'Chờ xử lý', '2025-05-10 07:35:26', '')
2025-05-10 14:35:26 - Chèn đơn hàng với ID: 40
2025-05-10 14:35:26 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('40', 'cpu002', 'Intel Core i9-14900K', 'CPU', '3', '14990000', 'pickup')
2025-05-10 14:35:26 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('40', 'cod', '45000000', 'Chưa thanh toán')
2025-05-10 14:35:26 - Giao dịch COD được xác nhận thành công
2025-05-10 14:35:26 - Đóng kết nối cơ sở dữ liệu
2025-05-10 14:36:37 - Yêu cầu OPTIONS được nhận
2025-05-10 14:36:37 - Kết nối cơ sở dữ liệu thành công
2025-05-10 14:36:37 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":2,"danh_muc":"CPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"TP HCM","district":"Quận 3","ward":"Phường 2","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":28000000,"orderDate":"2025-05-10T07:36:37.265Z"}
2025-05-10 14:36:37 - Chuyển đổi ngay_dat_hang: 2025-05-10T07:36:37.265Z thành 2025-05-10 07:36:37
2025-05-10 14:36:37 - Xác thực đầu vào thành công
2025-05-10 14:36:37 - Tạo địa chỉ giao hàng mới với ID: 34
2025-05-10 14:36:37 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '34', '28000000', 'Chờ xử lý', '2025-05-10 07:36:37', '')
2025-05-10 14:36:37 - Chèn đơn hàng với ID: 41
2025-05-10 14:36:37 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('41', 'cpu001', 'Intel Core i9-13900K', 'CPU', '2', '14000000', 'ship')
2025-05-10 14:36:37 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('41', 'vnpay', '28000000', 'Chưa thanh toán')
2025-05-10 14:36:37 - Chuỗi truy vấn VNPay: vnp_Amount=2800000000&vnp_Command=pay&vnp_CreateDate=20250510143637&vnp_CurrCode=VND&vnp_ExpireDate=20250510150637&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+41&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=41&vnp_Version=2.1.0&
2025-05-10 14:36:37 - Dữ liệu băm VNPay: vnp_Amount=2800000000&vnp_Command=pay&vnp_CreateDate=20250510143637&vnp_CurrCode=VND&vnp_ExpireDate=20250510150637&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+41&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=41&vnp_Version=2.1.0
2025-05-10 14:36:37 - Hash VNPay được tạo: 4131c62e160dce79034ef154907d7c3917a7245ed588e2abc16ac4e9b7787edcd141aafc2faeeb8ea893ce15accfbd8a510d8e78982b001324caa09cc1cb04ff
2025-05-10 14:36:37 - Khởi tạo thanh toán VNPay cho đơn hàng 41: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=2800000000&vnp_Command=pay&vnp_CreateDate=20250510143637&vnp_CurrCode=VND&vnp_ExpireDate=20250510150637&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+41&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=41&vnp_Version=2.1.0&vnp_SecureHash=4131c62e160dce79034ef154907d7c3917a7245ed588e2abc16ac4e9b7787edcd141aafc2faeeb8ea893ce15accfbd8a510d8e78982b001324caa09cc1cb04ff
2025-05-10 14:41:42 - Yêu cầu OPTIONS được nhận
2025-05-10 14:41:42 - Kết nối cơ sở dữ liệu thành công
2025-05-10 14:41:42 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"gpu001","ten":"NVIDIA GeForce RTX 4090","gia":40000000,"so_luong":2,"danh_muc":"GPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":80000000,"orderDate":"2025-05-10T07:41:42.537Z"}
2025-05-10 14:41:42 - Chuyển đổi ngay_dat_hang: 2025-05-10T07:41:42.537Z thành 2025-05-10 07:41:42
2025-05-10 14:41:42 - Xác thực đầu vào thành công
2025-05-10 14:41:42 - Tạo địa chỉ giao hàng mới với ID: 35 cho pickup
2025-05-10 14:41:42 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '35', '80030000', 'Chờ xử lý', '2025-05-10 07:41:42', '')
2025-05-10 14:41:42 - Chèn đơn hàng với ID: 42
2025-05-10 14:41:42 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('42', 'gpu001', 'NVIDIA GeForce RTX 4090', 'GPU', '2', '40000000', 'pickup')
2025-05-10 14:41:42 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('42', 'vnpay', '80030000', 'Chưa thanh toán')
2025-05-10 14:41:42 - Chuỗi truy vấn VNPay: vnp_Amount=8003000000&vnp_Command=pay&vnp_CreateDate=20250510144142&vnp_CurrCode=VND&vnp_ExpireDate=20250510151142&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+42&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=42&vnp_Version=2.1.0&
2025-05-10 14:41:42 - Dữ liệu băm VNPay: vnp_Amount=8003000000&vnp_Command=pay&vnp_CreateDate=20250510144142&vnp_CurrCode=VND&vnp_ExpireDate=20250510151142&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+42&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=42&vnp_Version=2.1.0
2025-05-10 14:41:42 - Hash VNPay được tạo: 48dde80706c1995b8bc01a6d18a8799238dae3d85cd8bbd1c3f2d39de936e804b6fb9c88348adc79614b061de8c862c6e8f54bba4d7b83073afa6305c7301f8b
2025-05-10 14:41:42 - Khởi tạo thanh toán VNPay cho đơn hàng 42: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=8003000000&vnp_Command=pay&vnp_CreateDate=20250510144142&vnp_CurrCode=VND&vnp_ExpireDate=20250510151142&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+42&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=42&vnp_Version=2.1.0&vnp_SecureHash=48dde80706c1995b8bc01a6d18a8799238dae3d85cd8bbd1c3f2d39de936e804b6fb9c88348adc79614b061de8c862c6e8f54bba4d7b83073afa6305c7301f8b
2025-05-10 15:04:16 - Yêu cầu OPTIONS được nhận
2025-05-10 15:04:16 - Kết nối cơ sở dữ liệu thành công
2025-05-10 15:04:16 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"gpu001","ten":"NVIDIA GeForce RTX 4090","gia":40000000,"so_luong":2,"danh_muc":"GPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":80000000,"orderDate":"2025-05-10T08:04:16.709Z"}
2025-05-10 15:04:16 - Chuyển đổi ngay_dat_hang: 2025-05-10T08:04:16.709Z thành 2025-05-10 08:04:16
2025-05-10 15:04:16 - Xác thực đầu vào thành công
2025-05-10 15:04:16 - Tạo địa chỉ giao hàng mới với ID: 36 cho pickup
2025-05-10 15:04:16 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '36', '80030000', 'Chờ xử lý', '2025-05-10 08:04:16', '')
2025-05-10 15:04:16 - Chèn đơn hàng với ID: 43
2025-05-10 15:04:16 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('43', 'gpu001', 'NVIDIA GeForce RTX 4090', 'GPU', '2', '40000000', 'pickup')
2025-05-10 15:04:16 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('43', 'vnpay', '80030000', 'Chưa thanh toán')
2025-05-10 15:04:16 - Chuỗi truy vấn VNPay: vnp_Amount=80030000&vnp_Command=pay&vnp_CreateDate=20250510150416&vnp_CurrCode=VND&vnp_ExpireDate=20250510153416&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+43&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=43&vnp_Version=2.1.0&
2025-05-10 15:04:16 - Dữ liệu băm VNPay: vnp_Amount=80030000&vnp_Command=pay&vnp_CreateDate=20250510150416&vnp_CurrCode=VND&vnp_ExpireDate=20250510153416&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+43&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=43&vnp_Version=2.1.0
2025-05-10 15:04:16 - Hash VNPay được tạo: 25f8c5e90a4bb2120c1ba12b488fe54e0bb27d8af083f2dbff661eaa4df1a690e95fc85a8f375c4587caa98a5f685285fa3847db6fdd46e1264b9c441bc2eb4d
2025-05-10 15:04:16 - Khởi tạo thanh toán VNPay cho đơn hàng 43: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=80030000&vnp_Command=pay&vnp_CreateDate=20250510150416&vnp_CurrCode=VND&vnp_ExpireDate=20250510153416&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+43&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=43&vnp_Version=2.1.0&vnp_SecureHash=25f8c5e90a4bb2120c1ba12b488fe54e0bb27d8af083f2dbff661eaa4df1a690e95fc85a8f375c4587caa98a5f685285fa3847db6fdd46e1264b9c441bc2eb4d
2025-05-10 15:08:24 - Yêu cầu OPTIONS được nhận
2025-05-10 15:08:24 - Kết nối cơ sở dữ liệu thành công
2025-05-10 15:08:24 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"gpu001","ten":"NVIDIA GeForce RTX 4090","gia":40000000,"so_luong":2,"danh_muc":"GPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":80000000,"orderDate":"2025-05-10T08:08:24.879Z"}
2025-05-10 15:08:24 - Chuyển đổi ngay_dat_hang: 2025-05-10T08:08:24.879Z thành 2025-05-10 08:08:24
2025-05-10 15:08:24 - Xác thực đầu vào thành công
2025-05-10 15:08:24 - Tạo địa chỉ giao hàng mới với ID: 37 cho pickup
2025-05-10 15:08:24 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '37', '80030000', 'Chờ xử lý', '2025-05-10 08:08:24', '')
2025-05-10 15:08:24 - Chèn đơn hàng với ID: 44
2025-05-10 15:08:24 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('44', 'gpu001', 'NVIDIA GeForce RTX 4090', 'GPU', '2', '40000000', 'pickup')
2025-05-10 15:08:25 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('44', 'vnpay', '80030000', 'Chưa thanh toán')
2025-05-10 15:08:25 - Chuỗi truy vấn VNPay: vnp_Amount=8003000000&vnp_Command=pay&vnp_CreateDate=20250510150825&vnp_CurrCode=VND&vnp_ExpireDate=20250510153825&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+44&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=44&vnp_Version=2.1.0&
2025-05-10 15:08:25 - Dữ liệu băm VNPay: vnp_Amount=8003000000&vnp_Command=pay&vnp_CreateDate=20250510150825&vnp_CurrCode=VND&vnp_ExpireDate=20250510153825&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+44&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=44&vnp_Version=2.1.0
2025-05-10 15:08:25 - Hash VNPay được tạo: 4fed20b38ba4f822e6ae51405d3b08654ab087b3e5038cb696a37ee67dd6007d4f90fe72fd7850cce604a03f28702745c5016c5adb3e8b6ef123d62076c0f375
2025-05-10 15:08:25 - Khởi tạo thanh toán VNPay cho đơn hàng 44: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=8003000000&vnp_Command=pay&vnp_CreateDate=20250510150825&vnp_CurrCode=VND&vnp_ExpireDate=20250510153825&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+44&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=44&vnp_Version=2.1.0&vnp_SecureHash=4fed20b38ba4f822e6ae51405d3b08654ab087b3e5038cb696a37ee67dd6007d4f90fe72fd7850cce604a03f28702745c5016c5adb3e8b6ef123d62076c0f375
2025-05-10 15:13:58 - Yêu cầu OPTIONS được nhận
2025-05-10 15:13:58 - Kết nối cơ sở dữ liệu thành công
2025-05-10 15:13:58 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"gpu001","ten":"NVIDIA GeForce RTX 4090","gia":40000000,"so_luong":1,"danh_muc":"GPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":40000000,"orderDate":"2025-05-10T08:13:58.410Z"}
2025-05-10 15:13:58 - Chuyển đổi ngay_dat_hang: 2025-05-10T08:13:58.410Z thành 2025-05-10 08:13:58
2025-05-10 15:13:58 - Xác thực đầu vào thành công
2025-05-10 15:13:58 - Tạo địa chỉ giao hàng mới với ID: 38 cho pickup
2025-05-10 15:13:58 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '38', '40030000', 'Chờ xử lý', '2025-05-10 08:13:58', '')
2025-05-10 15:13:58 - Chèn đơn hàng với ID: 45
2025-05-10 15:13:58 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('45', 'gpu001', 'NVIDIA GeForce RTX 4090', 'GPU', '1', '40000000', 'pickup')
2025-05-10 15:13:58 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('45', 'vnpay', '40030000', 'Chưa thanh toán')
2025-05-10 15:13:58 - Chuỗi truy vấn VNPay: vnp_Amount=4003000000&vnp_Command=pay&vnp_CreateDate=20250510151358&vnp_CurrCode=VND&vnp_ExpireDate=20250510154358&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+45&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=45&vnp_Version=2.1.0&
2025-05-10 15:13:58 - Dữ liệu băm VNPay: vnp_Amount=4003000000&vnp_Command=pay&vnp_CreateDate=20250510151358&vnp_CurrCode=VND&vnp_ExpireDate=20250510154358&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+45&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=45&vnp_Version=2.1.0
2025-05-10 15:13:58 - Hash VNPay được tạo: 31a9a8d22ded8ab376f32dca5262a2184af9a7fda5ca0c38c9cb523a2bd8fe9ba877d325f9f0172f72bffdae35735a728f3663602b9cedd42744ffea1353883b
2025-05-10 15:13:58 - Khởi tạo thanh toán VNPay cho đơn hàng 45: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=4003000000&vnp_Command=pay&vnp_CreateDate=20250510151358&vnp_CurrCode=VND&vnp_ExpireDate=20250510154358&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+45&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=45&vnp_Version=2.1.0&vnp_SecureHash=31a9a8d22ded8ab376f32dca5262a2184af9a7fda5ca0c38c9cb523a2bd8fe9ba877d325f9f0172f72bffdae35735a728f3663602b9cedd42744ffea1353883b
2025-05-10 15:14:42 - Yêu cầu OPTIONS được nhận
2025-05-10 15:14:42 - Kết nối cơ sở dữ liệu thành công
2025-05-10 15:14:42 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"gpu001","ten":"NVIDIA GeForce RTX 4090","gia":40000000,"so_luong":1,"danh_muc":"GPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":40000000,"orderDate":"2025-05-10T08:14:42.334Z"}
2025-05-10 15:14:42 - Chuyển đổi ngay_dat_hang: 2025-05-10T08:14:42.334Z thành 2025-05-10 08:14:42
2025-05-10 15:14:42 - Xác thực đầu vào thành công
2025-05-10 15:14:42 - Tạo địa chỉ giao hàng mới với ID: 39 cho pickup
2025-05-10 15:14:42 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '39', '40030000', 'Chờ xử lý', '2025-05-10 08:14:42', '')
2025-05-10 15:14:42 - Chèn đơn hàng với ID: 46
2025-05-10 15:14:42 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('46', 'gpu001', 'NVIDIA GeForce RTX 4090', 'GPU', '1', '40000000', 'pickup')
2025-05-10 15:14:42 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('46', 'vnpay', '40030000', 'Chưa thanh toán')
2025-05-10 15:14:42 - Chuỗi truy vấn VNPay: vnp_Amount=4003000000&vnp_Command=pay&vnp_CreateDate=20250510151442&vnp_CurrCode=VND&vnp_ExpireDate=20250510154442&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+46&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=46&vnp_Version=2.1.0&
2025-05-10 15:14:42 - Dữ liệu băm VNPay: vnp_Amount=4003000000&vnp_Command=pay&vnp_CreateDate=20250510151442&vnp_CurrCode=VND&vnp_ExpireDate=20250510154442&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+46&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=46&vnp_Version=2.1.0
2025-05-10 15:14:42 - Hash VNPay được tạo: 0dbbf31da469c1ed6df43d717ab56107900d59b8c588b8f90d61371ab03f3224faf52284efbb3690a6740655fb9ef279d3baec83c394ba7b5ac205e6f6811c75
2025-05-10 15:14:42 - Khởi tạo thanh toán VNPay cho đơn hàng 46: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=4003000000&vnp_Command=pay&vnp_CreateDate=20250510151442&vnp_CurrCode=VND&vnp_ExpireDate=20250510154442&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+46&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=46&vnp_Version=2.1.0&vnp_SecureHash=0dbbf31da469c1ed6df43d717ab56107900d59b8c588b8f90d61371ab03f3224faf52284efbb3690a6740655fb9ef279d3baec83c394ba7b5ac205e6f6811c75
2025-05-10 15:43:18 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-10 15:43:18 - Yêu cầu OPTIONS được nhận
2025-05-10 15:43:57 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-10 15:43:57 - Yêu cầu OPTIONS được nhận
2025-05-10 15:47:03 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-10 15:47:03 - Yêu cầu OPTIONS được nhận
2025-05-10 15:51:31 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-10 15:51:31 - Yêu cầu OPTIONS được nhận
2025-05-10 15:51:31 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-10 15:51:31 - Kết nối cơ sở dữ liệu thành công
2025-05-10 15:51:31 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"gpu005","ten":"Gigabyte RTX 4070 GAMING OC 12GB GDDR6X","gia":21900000,"so_luong":2,"danh_muc":"GPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":43800000,"orderDate":"2025-05-10T08:51:31.359Z"}
2025-05-10 15:51:31 - Chuyển đổi ngay_dat_hang: 2025-05-10T08:51:31.359Z thành 2025-05-10 08:51:31
2025-05-10 15:51:31 - Xác thực đầu vào thành công
2025-05-10 15:51:31 - Tạo địa chỉ giao hàng mới với ID: 40 cho pickup
2025-05-10 15:51:31 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '40', '43830000', 'Chờ xử lý', '2025-05-10 08:51:31', '')
2025-05-10 15:51:31 - Chèn đơn hàng với ID: 47
2025-05-10 15:51:31 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('47', 'gpu005', 'Gigabyte RTX 4070 GAMING OC 12GB GDDR6X', 'GPU', '2', '21900000', 'pickup')
2025-05-10 15:51:31 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('47', 'vnpay', '43830000', 'Chưa thanh toán')
2025-05-10 15:51:31 - Chuỗi truy vấn VNPay: vnp_Amount=43830000&vnp_Command=pay&vnp_CreateDate=20250510155131&vnp_CurrCode=VND&vnp_ExpireDate=20250510162131&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+47&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=47&vnp_Version=2.1.0&
2025-05-10 15:51:31 - Dữ liệu băm VNPay: vnp_Amount=43830000&vnp_Command=pay&vnp_CreateDate=20250510155131&vnp_CurrCode=VND&vnp_ExpireDate=20250510162131&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+47&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=47&vnp_Version=2.1.0
2025-05-10 15:51:31 - Hash VNPay được tạo: 1b52c27cb0b8f5ffdc604d3703a94e26c5b2363776ced3823c9afa9d759690c7d367350483bb9a128152fb1b548871afb99bc9bc0bf3db285b3bbf9a0552e54a
2025-05-10 15:51:31 - Khởi tạo thanh toán VNPay cho đơn hàng 47: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=43830000&vnp_Command=pay&vnp_CreateDate=20250510155131&vnp_CurrCode=VND&vnp_ExpireDate=20250510162131&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+47&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=47&vnp_Version=2.1.0&vnp_SecureHash=1b52c27cb0b8f5ffdc604d3703a94e26c5b2363776ced3823c9afa9d759690c7d367350483bb9a128152fb1b548871afb99bc9bc0bf3db285b3bbf9a0552e54a
2025-05-10 15:52:12 - Nhận yêu cầu: GET /BaiTapNhom/backend/payments.php?vnp_Amount=43830000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14949193&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+47&vnp_PayDate=20250510155230&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14949193&vnp_TransactionStatus=00&vnp_TxnRef=47&vnp_SecureHash=549bfd60c90175748015cbb8a7bae2deb523aac2c52d48c1603fa026a465afb2a15d64e1490f1fe2510c3873950cedf05b3f08274f18e8031de03dad0150feb5
2025-05-10 15:52:12 - --------- Gỡ lỗi Callback VNPay ---------
2025-05-10 15:52:12 - Tất cả tham số GET: {"vnp_Amount":"43830000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14949193","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 47","vnp_PayDate":"20250510155230","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14949193","vnp_TransactionStatus":"00","vnp_TxnRef":"47","vnp_SecureHash":"549bfd60c90175748015cbb8a7bae2deb523aac2c52d48c1603fa026a465afb2a15d64e1490f1fe2510c3873950cedf05b3f08274f18e8031de03dad0150feb5"}
2025-05-10 15:52:12 - vnp_SecureHash nhận được: 549bfd60c90175748015cbb8a7bae2deb523aac2c52d48c1603fa026a465afb2a15d64e1490f1fe2510c3873950cedf05b3f08274f18e8031de03dad0150feb5
2025-05-10 15:52:12 - inputData sau khi sắp xếp: {"vnp_Amount":"43830000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14949193","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 47","vnp_PayDate":"20250510155230","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14949193","vnp_TransactionStatus":"00","vnp_TxnRef":"47"}
2025-05-10 15:52:12 - Chuỗi hashData: vnp_Amount=43830000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14949193&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+47&vnp_PayDate=20250510155230&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14949193&vnp_TransactionStatus=00&vnp_TxnRef=47
2025-05-10 15:52:12 - secureHash được tạo: 549bfd60c90175748015cbb8a7bae2deb523aac2c52d48c1603fa026a465afb2a15d64e1490f1fe2510c3873950cedf05b3f08274f18e8031de03dad0150feb5
2025-05-10 15:52:12 - Khớp hash: Có
2025-05-10 15:52:12 - Trạng thái thanh toán được cập nhật cho đơn hàng 47: Đã thanh toán
2025-05-10 15:52:12 - Cập nhật trạng thái đơn hàng 47 thành 'Đã thanh toán'
2025-05-10 18:55:06 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-10 18:55:06 - Yêu cầu OPTIONS được nhận
2025-05-10 18:55:06 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-10 18:55:06 - Kết nối cơ sở dữ liệu thành công
2025-05-10 18:55:06 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":"test chức năng"},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":14000000,"orderDate":"2025-05-10T11:55:05.994Z"}
2025-05-10 18:55:06 - Chuyển đổi ngay_dat_hang: 2025-05-10T11:55:05.994Z thành 2025-05-10 11:55:05
2025-05-10 18:55:06 - Xác thực đầu vào thành công
2025-05-10 18:55:06 - Tạo địa chỉ giao hàng mới với ID: 41 cho pickup
2025-05-10 18:55:06 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '41', '14030000', 'Chờ xử lý', '2025-05-10 11:55:05', 'test chức năng')
2025-05-10 18:55:06 - Chèn đơn hàng với ID: 48
2025-05-10 18:55:06 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('48', 'cpu001', 'Intel Core i9-13900K', 'CPU', '1', '14000000', 'pickup')
2025-05-10 18:55:06 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('48', 'vnpay', '14030000', 'Chưa thanh toán')
2025-05-10 18:55:06 - Chuỗi truy vấn VNPay: vnp_Amount=1403000000&vnp_Command=pay&vnp_CreateDate=20250510185506&vnp_CurrCode=VND&vnp_ExpireDate=20250510192506&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+48&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=48&vnp_Version=2.1.0&
2025-05-10 18:55:06 - Dữ liệu băm VNPay: vnp_Amount=1403000000&vnp_Command=pay&vnp_CreateDate=20250510185506&vnp_CurrCode=VND&vnp_ExpireDate=20250510192506&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+48&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=48&vnp_Version=2.1.0
2025-05-10 18:55:06 - Hash VNPay được tạo: 062d245dbf1f87a406d44af0154009f2e192b1e1c774849f36bc18c96917b6b3d73b077e78b61e5dbda6b9c65fd77c4acabde04da73ceaa2dec1d509336fbbc0
2025-05-10 18:55:06 - Khởi tạo thanh toán VNPay cho đơn hàng 48: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=1403000000&vnp_Command=pay&vnp_CreateDate=20250510185506&vnp_CurrCode=VND&vnp_ExpireDate=20250510192506&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+48&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=48&vnp_Version=2.1.0&vnp_SecureHash=062d245dbf1f87a406d44af0154009f2e192b1e1c774849f36bc18c96917b6b3d73b077e78b61e5dbda6b9c65fd77c4acabde04da73ceaa2dec1d509336fbbc0
2025-05-10 19:00:35 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-10 19:00:35 - Yêu cầu OPTIONS được nhận
2025-05-10 19:00:35 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-10 19:00:35 - Kết nối cơ sở dữ liệu thành công
2025-05-10 19:00:35 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"peripheral009","ten":"Keychron K6","gia":2000000,"so_luong":1,"danh_muc":"Peripherals"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":2000000,"orderDate":"2025-05-10T12:00:35.534Z"}
2025-05-10 19:00:35 - Chuyển đổi ngay_dat_hang: 2025-05-10T12:00:35.534Z thành 2025-05-10 12:00:35
2025-05-10 19:00:35 - Xác thực đầu vào thành công
2025-05-10 19:00:35 - Tạo địa chỉ giao hàng mới với ID: 42 cho pickup
2025-05-10 19:00:35 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '42', '2030000', 'Chờ xử lý', '2025-05-10 12:00:35', '')
2025-05-10 19:00:35 - Chèn đơn hàng với ID: 49
2025-05-10 19:00:35 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('49', 'peripheral009', 'Keychron K6', 'Peripherals', '1', '2000000', 'pickup')
2025-05-10 19:00:35 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('49', 'vnpay', '2030000', 'Chưa thanh toán')
2025-05-10 19:00:35 - Chuỗi truy vấn VNPay: vnp_Amount=203000000&vnp_Command=pay&vnp_CreateDate=20250510190035&vnp_CurrCode=VND&vnp_ExpireDate=20250510193035&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+49&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=49&vnp_Version=2.1.0&
2025-05-10 19:00:35 - Dữ liệu băm VNPay: vnp_Amount=203000000&vnp_Command=pay&vnp_CreateDate=20250510190035&vnp_CurrCode=VND&vnp_ExpireDate=20250510193035&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+49&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=49&vnp_Version=2.1.0
2025-05-10 19:00:35 - Hash VNPay được tạo: 5e09ac46733be58b4fd6bfe4df11ab42cfbc4db98f7b06b3910f8ed9460cf8b33ded954fd3ef1bbc2383f85471c7768f666667c57326e677fad22ea0173dc428
2025-05-10 19:00:35 - Khởi tạo thanh toán VNPay cho đơn hàng 49: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=203000000&vnp_Command=pay&vnp_CreateDate=20250510190035&vnp_CurrCode=VND&vnp_ExpireDate=20250510193035&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+49&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=49&vnp_Version=2.1.0&vnp_SecureHash=5e09ac46733be58b4fd6bfe4df11ab42cfbc4db98f7b06b3910f8ed9460cf8b33ded954fd3ef1bbc2383f85471c7768f666667c57326e677fad22ea0173dc428
2025-05-10 19:08:34 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-10 19:08:34 - Yêu cầu OPTIONS được nhận
2025-05-10 19:08:34 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-10 19:08:34 - Kết nối cơ sở dữ liệu thành công
2025-05-10 19:08:34 - Dữ liệu thô: {"userId":4,"cartItems":[{"id_product":"gpu001","ten":"NVIDIA GeForce RTX 4090","gia":40000000,"so_luong":1,"danh_muc":"GPU"}],"customerInfo":{"fullName":"test123","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":40000000,"orderDate":"2025-05-10T12:08:34.785Z"}
2025-05-10 19:08:34 - Chuyển đổi ngay_dat_hang: 2025-05-10T12:08:34.785Z thành 2025-05-10 12:08:34
2025-05-10 19:08:34 - Xác thực đầu vào thành công
2025-05-10 19:08:34 - Tạo địa chỉ giao hàng mới với ID: 43 cho pickup
2025-05-10 19:08:34 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('4', '43', '40030000', 'Chờ xử lý', '2025-05-10 12:08:34', '')
2025-05-10 19:08:34 - Chèn đơn hàng với ID: 50
2025-05-10 19:08:34 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('50', 'gpu001', 'NVIDIA GeForce RTX 4090', 'GPU', '1', '40000000', 'pickup')
2025-05-10 19:08:34 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('50', 'vnpay', '40030000', 'Chưa thanh toán')
2025-05-10 19:08:34 - Chuỗi truy vấn VNPay: vnp_Amount=4003000000&vnp_Command=pay&vnp_CreateDate=20250510190834&vnp_CurrCode=VND&vnp_ExpireDate=20250510193834&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+50&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=50&vnp_Version=2.1.0&
2025-05-10 19:08:34 - Dữ liệu băm VNPay: vnp_Amount=4003000000&vnp_Command=pay&vnp_CreateDate=20250510190834&vnp_CurrCode=VND&vnp_ExpireDate=20250510193834&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+50&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=50&vnp_Version=2.1.0
2025-05-10 19:08:34 - Hash VNPay được tạo: 91cc33a5791945b738765c0272ba829d766981efe63d8d1b01fd3d89affd6e87850d5267393f36f09193d63bc50cd369f26367d9c81e715cf544c05df3cf66a4
2025-05-10 19:08:34 - Khởi tạo thanh toán VNPay cho đơn hàng 50: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=4003000000&vnp_Command=pay&vnp_CreateDate=20250510190834&vnp_CurrCode=VND&vnp_ExpireDate=20250510193834&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+50&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=50&vnp_Version=2.1.0&vnp_SecureHash=91cc33a5791945b738765c0272ba829d766981efe63d8d1b01fd3d89affd6e87850d5267393f36f09193d63bc50cd369f26367d9c81e715cf544c05df3cf66a4
2025-05-10 19:09:37 - Nhận yêu cầu: GET /BaiTapNhom/backend/payments.php?vnp_Amount=4003000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14949383&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+50&vnp_PayDate=20250510190948&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14949383&vnp_TransactionStatus=00&vnp_TxnRef=50&vnp_SecureHash=40e67589667faf3909585d90f5ff6ec01fdd955911f7578401ee44b41277c0e5d6fc3217fa18e2e62293325342d43d278eb6a1107583cdbae56d9dd245619f61
2025-05-10 19:09:37 - --------- Gỡ lỗi Callback VNPay ---------
2025-05-10 19:09:37 - Tất cả tham số GET: {"vnp_Amount":"4003000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14949383","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 50","vnp_PayDate":"20250510190948","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14949383","vnp_TransactionStatus":"00","vnp_TxnRef":"50","vnp_SecureHash":"40e67589667faf3909585d90f5ff6ec01fdd955911f7578401ee44b41277c0e5d6fc3217fa18e2e62293325342d43d278eb6a1107583cdbae56d9dd245619f61"}
2025-05-10 19:09:37 - vnp_SecureHash nhận được: 40e67589667faf3909585d90f5ff6ec01fdd955911f7578401ee44b41277c0e5d6fc3217fa18e2e62293325342d43d278eb6a1107583cdbae56d9dd245619f61
2025-05-10 19:09:37 - inputData sau khi sắp xếp: {"vnp_Amount":"4003000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14949383","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 50","vnp_PayDate":"20250510190948","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14949383","vnp_TransactionStatus":"00","vnp_TxnRef":"50"}
2025-05-10 19:09:37 - Chuỗi hashData: vnp_Amount=4003000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14949383&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+50&vnp_PayDate=20250510190948&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14949383&vnp_TransactionStatus=00&vnp_TxnRef=50
2025-05-10 19:09:37 - secureHash được tạo: 40e67589667faf3909585d90f5ff6ec01fdd955911f7578401ee44b41277c0e5d6fc3217fa18e2e62293325342d43d278eb6a1107583cdbae56d9dd245619f61
2025-05-10 19:09:37 - Khớp hash: Có
2025-05-10 19:09:37 - Trạng thái thanh toán được cập nhật cho đơn hàng 50: Đã thanh toán
2025-05-10 19:09:37 - Cập nhật trạng thái đơn hàng 50 thành 'Đã thanh toán'
2025-05-10 19:09:37 - Chuyển hướng người dùng đến trang thankyou
2025-05-10 20:03:53 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-10 20:03:53 - Yêu cầu OPTIONS được nhận
2025-05-10 20:03:53 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-10 20:03:53 - Kết nối cơ sở dữ liệu thành công
2025-05-10 20:03:53 - Dữ liệu thô: {"userId":2,"cartItems":[{"id_product":"cpu005","ten":"CPU Intel Core i5 14500","gia":66900000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":"hello"},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":66900000,"orderDate":"2025-05-10T13:03:53.777Z"}
2025-05-10 20:03:53 - Chuyển đổi ngay_dat_hang: 2025-05-10T13:03:53.777Z thành 2025-05-10 13:03:53
2025-05-10 20:03:53 - Xác thực đầu vào thành công
2025-05-10 20:03:53 - Tạo địa chỉ giao hàng mới với ID: 44 cho pickup
2025-05-10 20:03:53 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '44', '66930000', 'Chờ xử lý', '2025-05-10 13:03:53', 'hello')
2025-05-10 20:03:53 - Chèn đơn hàng với ID: 51
2025-05-10 20:03:53 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('51', 'cpu005', 'CPU Intel Core i5 14500', 'CPU', '1', '66900000', 'pickup')
2025-05-10 20:03:53 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('51', 'vnpay', '66930000', 'Chưa thanh toán')
2025-05-10 20:03:53 - Chuỗi truy vấn VNPay: vnp_Amount=6693000000&vnp_Command=pay&vnp_CreateDate=20250510200353&vnp_CurrCode=VND&vnp_ExpireDate=20250510203353&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+51&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=51&vnp_Version=2.1.0&
2025-05-10 20:03:53 - Dữ liệu băm VNPay: vnp_Amount=6693000000&vnp_Command=pay&vnp_CreateDate=20250510200353&vnp_CurrCode=VND&vnp_ExpireDate=20250510203353&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+51&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=51&vnp_Version=2.1.0
2025-05-10 20:03:53 - Hash VNPay được tạo: a5008b320f85438bdfdd4f1c721bacc3cebe38a1499d6d10ae9b5e1c31e97d2a04df2bc84610bb4cb9aed602fcd16a884f2d64147f8630c7d4c293456fdf0a12
2025-05-10 20:03:53 - Khởi tạo thanh toán VNPay cho đơn hàng 51: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=6693000000&vnp_Command=pay&vnp_CreateDate=20250510200353&vnp_CurrCode=VND&vnp_ExpireDate=20250510203353&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+51&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=51&vnp_Version=2.1.0&vnp_SecureHash=a5008b320f85438bdfdd4f1c721bacc3cebe38a1499d6d10ae9b5e1c31e97d2a04df2bc84610bb4cb9aed602fcd16a884f2d64147f8630c7d4c293456fdf0a12
2025-05-10 20:04:39 - Nhận yêu cầu: GET /BaiTapNhom/backend/payments.php?vnp_Amount=6693000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14949411&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+51&vnp_PayDate=20250510200459&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14949411&vnp_TransactionStatus=00&vnp_TxnRef=51&vnp_SecureHash=c36864e3617e2c79bd02221bdf96b8be1fb7d1cbf472d178f19a059f94785ad6c0f73d9ea454cfe019db30325c83859b594fa25e7c22eb18bf998d152fb26538
2025-05-10 20:04:39 - --------- Gỡ lỗi Callback VNPay ---------
2025-05-10 20:04:39 - Tất cả tham số GET: {"vnp_Amount":"6693000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14949411","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 51","vnp_PayDate":"20250510200459","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14949411","vnp_TransactionStatus":"00","vnp_TxnRef":"51","vnp_SecureHash":"c36864e3617e2c79bd02221bdf96b8be1fb7d1cbf472d178f19a059f94785ad6c0f73d9ea454cfe019db30325c83859b594fa25e7c22eb18bf998d152fb26538"}
2025-05-10 20:04:39 - vnp_SecureHash nhận được: c36864e3617e2c79bd02221bdf96b8be1fb7d1cbf472d178f19a059f94785ad6c0f73d9ea454cfe019db30325c83859b594fa25e7c22eb18bf998d152fb26538
2025-05-10 20:04:39 - inputData sau khi sắp xếp: {"vnp_Amount":"6693000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14949411","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 51","vnp_PayDate":"20250510200459","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14949411","vnp_TransactionStatus":"00","vnp_TxnRef":"51"}
2025-05-10 20:04:39 - Chuỗi hashData: vnp_Amount=6693000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14949411&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+51&vnp_PayDate=20250510200459&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14949411&vnp_TransactionStatus=00&vnp_TxnRef=51
2025-05-10 20:04:39 - secureHash được tạo: c36864e3617e2c79bd02221bdf96b8be1fb7d1cbf472d178f19a059f94785ad6c0f73d9ea454cfe019db30325c83859b594fa25e7c22eb18bf998d152fb26538
2025-05-10 20:04:39 - Khớp hash: Có
2025-05-10 20:04:39 - Trạng thái thanh toán được cập nhật cho đơn hàng 51: Đã thanh toán
2025-05-10 20:04:39 - Cập nhật trạng thái đơn hàng 51 thành 'Đã thanh toán'
2025-05-10 20:04:39 - Chuyển hướng người dùng đến trang thankyou
2025-05-15 13:25:49 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-15 13:25:49 - Yêu cầu OPTIONS được nhận
2025-05-15 13:25:49 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-15 13:25:49 - Kết nối cơ sở dữ liệu thành công
2025-05-15 13:25:49 - Dữ liệu thô: {"userId":2,"cartItems":[{"id_product":"cpu007","ten":"AMD Ryzen 9 9950X","gia":18500000,"so_luong":2,"danh_muc":"CPU"}],"customerInfo":{"fullName":"admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":37000000,"orderDate":"2025-05-15T06:25:49.802Z"}
2025-05-15 13:25:49 - Chuyển đổi ngay_dat_hang: 2025-05-15T06:25:49.802Z thành 2025-05-15 06:25:49
2025-05-15 13:25:49 - Xác thực đầu vào thành công
2025-05-15 13:25:49 - Tạo địa chỉ giao hàng mới với ID: 45 cho pickup
2025-05-15 13:25:49 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '45', '37030000', 'Chờ xử lý', '2025-05-15 06:25:49', '')
2025-05-15 13:25:49 - Chèn đơn hàng với ID: 52
2025-05-15 13:25:49 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('52', 'cpu007', 'AMD Ryzen 9 9950X', 'CPU', '2', '18500000', 'pickup')
2025-05-15 13:25:49 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('52', 'cod', '37030000', 'Chưa thanh toán')
2025-05-15 13:25:49 - Giao dịch COD được xác nhận thành công
2025-05-15 13:25:49 - Đóng kết nối cơ sở dữ liệu
2025-05-16 13:47:23 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-16 13:47:23 - Yêu cầu OPTIONS được nhận
2025-05-16 13:47:23 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-16 13:47:23 - Kết nối cơ sở dữ liệu thành công
2025-05-16 13:47:23 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu003","ten":"CPU Intel Core Ultra 9 285K","gia":17290000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"TP HCM","district":"Quận 2","ward":"Phường 1","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":17290000,"orderDate":"2025-05-16T06:47:23.886Z"}
2025-05-16 13:47:23 - Chuyển đổi ngay_dat_hang: 2025-05-16T06:47:23.886Z thành 2025-05-16 06:47:23
2025-05-16 13:47:24 - Xác thực đầu vào thành công
2025-05-16 13:47:24 - Tạo địa chỉ giao hàng mới với ID: 46
2025-05-16 13:47:24 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '46', '17290000', 'Chờ xử lý', '2025-05-16 06:47:23', '')
2025-05-16 13:47:24 - Chèn đơn hàng với ID: 53
2025-05-16 13:47:24 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('53', 'cpu003', 'CPU Intel Core Ultra 9 285K', 'CPU', '1', '17290000', 'ship')
2025-05-16 13:47:24 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('53', 'vnpay', '17290000', 'Chưa thanh toán')
2025-05-16 13:47:24 - Chuỗi truy vấn VNPay: vnp_Amount=1729000000&vnp_Command=pay&vnp_CreateDate=20250516134724&vnp_CurrCode=VND&vnp_ExpireDate=20250516141724&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+53&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=53&vnp_Version=2.1.0&
2025-05-16 13:47:24 - Dữ liệu băm VNPay: vnp_Amount=1729000000&vnp_Command=pay&vnp_CreateDate=20250516134724&vnp_CurrCode=VND&vnp_ExpireDate=20250516141724&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+53&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=53&vnp_Version=2.1.0
2025-05-16 13:47:24 - Hash VNPay được tạo: fae6f8e4f1294b1b335580de10abdf1d770103f5c0f45d3001a08417325e5b5e3f81b4eb67641f867a8d2aff4d628d93b5ff14daa0316390551062629639e9a0
2025-05-16 13:47:24 - Khởi tạo thanh toán VNPay cho đơn hàng 53: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=1729000000&vnp_Command=pay&vnp_CreateDate=20250516134724&vnp_CurrCode=VND&vnp_ExpireDate=20250516141724&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+53&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=53&vnp_Version=2.1.0&vnp_SecureHash=fae6f8e4f1294b1b335580de10abdf1d770103f5c0f45d3001a08417325e5b5e3f81b4eb67641f867a8d2aff4d628d93b5ff14daa0316390551062629639e9a0
2025-05-16 16:06:23 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-16 16:06:23 - Yêu cầu OPTIONS được nhận
2025-05-16 16:06:23 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-16 16:06:23 - Kết nối cơ sở dữ liệu thành công
2025-05-16 16:06:23 - Dữ liệu thô: {"userId":"3","cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"test","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":14000000,"orderDate":"2025-05-16T09:06:23.265Z"}
2025-05-16 16:06:23 - Chuyển đổi ngay_dat_hang: 2025-05-16T09:06:23.265Z thành 2025-05-16 09:06:23
2025-05-16 16:06:23 - Xác thực đầu vào thành công
2025-05-16 16:06:23 - Tạo địa chỉ giao hàng mới với ID: 47 cho pickup
2025-05-16 16:06:23 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('3', '47', '14030000', 'Chờ xử lý', '2025-05-16 09:06:23', '')
2025-05-16 16:06:23 - Chèn đơn hàng với ID: 54
2025-05-16 16:06:23 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('54', 'cpu001', 'Intel Core i9-13900K', 'CPU', '1', '14000000', 'pickup')
2025-05-16 16:06:23 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('54', 'cod', '14030000', 'Chưa thanh toán')
2025-05-16 16:06:23 - Giao dịch COD được xác nhận thành công
2025-05-16 16:06:23 - Đóng kết nối cơ sở dữ liệu
2025-05-22 16:40:41 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-22 16:40:41 - Yêu cầu OPTIONS được nhận
2025-05-22 16:40:41 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-22 16:40:41 - Kết nối cơ sở dữ liệu thành công
2025-05-22 16:40:41 - Dữ liệu thô: {"userId":"1","cartItems":[{"id_product":"cpu006","ten":"AMD Ryzen 9 7950X3D","gia":16500000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"hacker","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":16500000,"orderDate":"2025-05-22T09:40:41.820Z"}
2025-05-22 16:40:41 - Chuyển đổi ngay_dat_hang: 2025-05-22T09:40:41.820Z thành 2025-05-22 09:40:41
2025-05-22 16:40:41 - Xác thực đầu vào thành công
2025-05-22 16:40:41 - Tạo địa chỉ giao hàng mới với ID: 48 cho pickup
2025-05-22 16:40:41 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('1', '48', '16530000', 'Chờ xử lý', '2025-05-22 09:40:41', '')
2025-05-22 16:40:41 - Chèn đơn hàng với ID: 55
2025-05-22 16:40:41 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('55', 'cpu006', 'AMD Ryzen 9 7950X3D', 'CPU', '1', '16500000', 'pickup')
2025-05-22 16:40:41 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('55', 'cod', '16530000', 'Chưa thanh toán')
2025-05-22 16:40:41 - Giao dịch COD được xác nhận thành công
2025-05-22 16:40:41 - Đóng kết nối cơ sở dữ liệu
2025-05-22 16:42:30 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-22 16:42:30 - Yêu cầu OPTIONS được nhận
2025-05-22 16:42:30 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-22 16:42:30 - Kết nối cơ sở dữ liệu thành công
2025-05-22 16:42:30 - Dữ liệu thô: {"userId":"1","cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":2,"danh_muc":"CPU"}],"customerInfo":{"fullName":"hacker","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":28000000,"orderDate":"2025-05-22T09:42:30.745Z"}
2025-05-22 16:42:30 - Chuyển đổi ngay_dat_hang: 2025-05-22T09:42:30.745Z thành 2025-05-22 09:42:30
2025-05-22 16:42:30 - Xác thực đầu vào thành công
2025-05-22 16:42:30 - Tạo địa chỉ giao hàng mới với ID: 49 cho pickup
2025-05-22 16:42:30 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('1', '49', '28030000', 'Chờ xử lý', '2025-05-22 09:42:30', '')
2025-05-22 16:42:30 - Chèn đơn hàng với ID: 56
2025-05-22 16:42:30 - Thực thi truy vấn chèn chi tiết đơn hàng: INSERT INTO chi_tiet_don_hang (ma_don_hang, id_product, ten_san_pham, danh_muc, so_luong, gia, phuong_thuc_van_chuyen)
                    VALUES ('56', 'cpu001', 'Intel Core i9-13900K', 'CPU', '2', '14000000', 'pickup')
2025-05-22 16:42:30 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('56', 'cod', '28030000', 'Chưa thanh toán')
2025-05-22 16:42:30 - Giao dịch COD được xác nhận thành công
2025-05-22 16:42:30 - Đóng kết nối cơ sở dữ liệu
2025-05-23 09:08:53 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-23 09:08:53 - Yêu cầu OPTIONS được nhận
2025-05-23 09:08:53 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-23 09:08:53 - Kết nối cơ sở dữ liệu thành công
2025-05-23 09:08:53 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"TP HCM","district":"Quận 1","ward":"Phường 2","note":"nope"},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":14000000,"orderDate":"2025-05-23T02:08:53.755Z"}
2025-05-23 09:08:53 - Chuyển đổi ngay_dat_hang: 2025-05-23T02:08:53.755Z thành 2025-05-23 02:08:53
2025-05-23 09:08:53 - Xác thực đầu vào thành công
2025-05-23 09:08:53 - Tạo địa chỉ giao hàng mới với ID: 50
2025-05-23 09:08:53 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '50', '14000000', 'Chờ xử lý', '2025-05-23 02:08:53', 'nope')
2025-05-23 09:08:53 - Chèn đơn hàng với ID: 57
2025-05-23 09:08:53 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('57', 'Admin', 'Intel Core i9-13900K (x1)', '14000000', 'HCM, Phường 2, Quận 1, TP HCM', 'cod')
2025-05-23 09:08:53 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('57', 'cod', '14000000', 'Chưa thanh toán')
2025-05-23 09:08:53 - Giao dịch COD được xác nhận thành công
2025-05-23 09:08:53 - Đóng kết nối cơ sở dữ liệu
2025-05-23 09:10:18 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-23 09:10:18 - Yêu cầu OPTIONS được nhận
2025-05-23 09:10:18 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-23 09:10:18 - Kết nối cơ sở dữ liệu thành công
2025-05-23 09:10:18 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu002","ten":"Intel Core i9-14900K","gia":14990000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"TP HCM","district":"Quận 2","ward":"Phường 5","note":"npe"},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":14990000,"orderDate":"2025-05-23T02:10:18.851Z"}
2025-05-23 09:10:18 - Chuyển đổi ngay_dat_hang: 2025-05-23T02:10:18.851Z thành 2025-05-23 02:10:18
2025-05-23 09:10:18 - Xác thực đầu vào thành công
2025-05-23 09:10:18 - Tạo địa chỉ giao hàng mới với ID: 51
2025-05-23 09:10:18 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '51', '14990000', 'Chờ xử lý', '2025-05-23 02:10:18', 'npe')
2025-05-23 09:10:18 - Chèn đơn hàng với ID: 58
2025-05-23 09:10:18 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('58', 'Admin', 'Intel Core i9-14900K (x1)', '14990000', 'HCM, Phường 5, Quận 2, TP HCM', 'vnpay')
2025-05-23 09:10:18 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('58', 'vnpay', '14990000', 'Chưa thanh toán')
2025-05-23 09:10:18 - Chuỗi truy vấn VNPay: vnp_Amount=1499000000&vnp_Command=pay&vnp_CreateDate=20250523091018&vnp_CurrCode=VND&vnp_ExpireDate=20250523094018&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+58&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=58&vnp_Version=2.1.0&
2025-05-23 09:10:18 - Dữ liệu băm VNPay: vnp_Amount=1499000000&vnp_Command=pay&vnp_CreateDate=20250523091018&vnp_CurrCode=VND&vnp_ExpireDate=20250523094018&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+58&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=58&vnp_Version=2.1.0
2025-05-23 09:10:18 - Hash VNPay được tạo: 98f91689cd1aee7b9f26dabae654bb05f8cf151fba0a404fdb200420de37a2cdaacd11a35ecb1575d88b60f23036539f35b6ca31ba11a09346be3fade4c05fc5
2025-05-23 09:10:18 - Khởi tạo thanh toán VNPay cho đơn hàng 58: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=1499000000&vnp_Command=pay&vnp_CreateDate=20250523091018&vnp_CurrCode=VND&vnp_ExpireDate=20250523094018&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+58&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=58&vnp_Version=2.1.0&vnp_SecureHash=98f91689cd1aee7b9f26dabae654bb05f8cf151fba0a404fdb200420de37a2cdaacd11a35ecb1575d88b60f23036539f35b6ca31ba11a09346be3fade4c05fc5
2025-05-23 09:10:44 - Nhận yêu cầu: GET /BaiTapNhom/backend/payments.php?vnp_Amount=1499000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14974486&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+58&vnp_PayDate=20250523091110&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14974486&vnp_TransactionStatus=00&vnp_TxnRef=58&vnp_SecureHash=92e0194bd2df7adba01e4c49e10d002139dc26de20389aa8fecd25089b2e03dd4cb4d49a1df72c5e3d4fa9b82857dc071b3bfb966e0fd9f4cea7f1a44d17e37c
2025-05-23 09:10:44 - --------- Gỡ lỗi Callback VNPay ---------
2025-05-23 09:10:44 - Tất cả tham số GET: {"vnp_Amount":"1499000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14974486","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 58","vnp_PayDate":"20250523091110","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14974486","vnp_TransactionStatus":"00","vnp_TxnRef":"58","vnp_SecureHash":"92e0194bd2df7adba01e4c49e10d002139dc26de20389aa8fecd25089b2e03dd4cb4d49a1df72c5e3d4fa9b82857dc071b3bfb966e0fd9f4cea7f1a44d17e37c"}
2025-05-23 09:10:44 - vnp_SecureHash nhận được: 92e0194bd2df7adba01e4c49e10d002139dc26de20389aa8fecd25089b2e03dd4cb4d49a1df72c5e3d4fa9b82857dc071b3bfb966e0fd9f4cea7f1a44d17e37c
2025-05-23 09:10:44 - inputData sau khi sắp xếp: {"vnp_Amount":"1499000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14974486","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 58","vnp_PayDate":"20250523091110","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14974486","vnp_TransactionStatus":"00","vnp_TxnRef":"58"}
2025-05-23 09:10:44 - Chuỗi hashData: vnp_Amount=1499000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14974486&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+58&vnp_PayDate=20250523091110&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14974486&vnp_TransactionStatus=00&vnp_TxnRef=58
2025-05-23 09:10:44 - secureHash được tạo: 92e0194bd2df7adba01e4c49e10d002139dc26de20389aa8fecd25089b2e03dd4cb4d49a1df72c5e3d4fa9b82857dc071b3bfb966e0fd9f4cea7f1a44d17e37c
2025-05-23 09:10:44 - Khớp hash: Có
2025-05-23 09:10:44 - Trạng thái thanh toán được cập nhật cho đơn hàng 58: Đã thanh toán
2025-05-23 09:10:44 - Cập nhật trạng thái đơn hàng 58 thành 'Đã thanh toán'
2025-05-23 09:10:44 - Chuyển hướng người dùng đến trang thankyou
2025-05-23 09:18:49 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-23 09:18:49 - Yêu cầu OPTIONS được nhận
2025-05-23 09:18:49 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-23 09:18:49 - Kết nối cơ sở dữ liệu thành công
2025-05-23 09:18:49 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"mb002","ten":"MSI MPG B650 Tomahawk WiFi","gia":6500000,"so_luong":1,"danh_muc":"Mainboard"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"TP HCM","district":"Quận 4","ward":"Phường 2","note":"nopeeee"},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":6500000,"orderDate":"2025-05-23T02:18:49.011Z"}
2025-05-23 09:18:49 - Chuyển đổi ngay_dat_hang: 2025-05-23T02:18:49.011Z thành 2025-05-23 02:18:49
2025-05-23 09:18:49 - Xác thực đầu vào thành công
2025-05-23 09:18:49 - Tạo địa chỉ giao hàng mới với ID: 52
2025-05-23 09:18:49 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '52', '6500000', 'Chờ xử lý', '2025-05-23 02:18:49', 'nopeeee')
2025-05-23 09:18:49 - Chèn đơn hàng với ID: 59
2025-05-23 09:18:49 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('59', 'Admin', 'MSI MPG B650 Tomahawk WiFi (x1)', '6500000', 'HCM, Phường 2, Quận 4, TP HCM', 'cod')
2025-05-23 09:18:49 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('59', 'cod', '6500000', 'Chưa thanh toán')
2025-05-23 09:18:49 - Giao dịch COD được xác nhận thành công
2025-05-23 09:18:49 - Đóng kết nối cơ sở dữ liệu
2025-05-30 00:20:34 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-30 00:20:34 - Yêu cầu OPTIONS được nhận
2025-05-30 00:20:34 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-30 00:20:34 - Kết nối cơ sở dữ liệu thành công
2025-05-30 00:20:34 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu008","ten":"AMD Ryzen 7 5700X","gia":5990000,"so_luong":1,"danh_muc":"CPU"},{"id_product":"cpu010","ten":"AMD Ryzen 7 9800X3D","gia":14390000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"ubuntu20.04.2@gmail.com","phone":"7878987909","address":"HCM","city":"TP HCM","district":"Quận 2","ward":"Phường 5","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":20380000,"orderDate":"2025-05-29T17:20:34.191Z"}
2025-05-30 00:20:34 - Chuyển đổi ngay_dat_hang: 2025-05-29T17:20:34.191Z thành 2025-05-29 17:20:34
2025-05-30 00:20:34 - Xác thực đầu vào thành công
2025-05-30 00:20:34 - Tạo địa chỉ giao hàng mới với ID: 53
2025-05-30 00:20:34 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '53', '20380000', 'Chờ xử lý', '2025-05-29 17:20:34', '')
2025-05-30 00:20:34 - Chèn đơn hàng với ID: 60
2025-05-30 00:20:34 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('60', 'Admin', 'AMD Ryzen 7 5700X (x1), AMD Ryzen 7 9800X3D (x1)', '20380000', 'HCM, Phường 5, Quận 2, TP HCM', 'cod')
2025-05-30 00:20:34 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('60', 'cod', '20380000', 'Chưa thanh toán')
2025-05-30 00:20:34 - Giao dịch COD được xác nhận thành công
2025-05-30 00:20:34 - Đóng kết nối cơ sở dữ liệu
2025-05-30 00:22:02 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-30 00:22:02 - Yêu cầu OPTIONS được nhận
2025-05-30 00:22:02 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-30 00:22:02 - Kết nối cơ sở dữ liệu thành công
2025-05-30 00:22:02 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"mb008","ten":"Gigabyte B760M Gaming Plus Wifi D4","gia":4890000,"so_luong":1,"danh_muc":"Mainboard"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":4890000,"orderDate":"2025-05-29T17:22:02.508Z"}
2025-05-30 00:22:02 - Chuyển đổi ngay_dat_hang: 2025-05-29T17:22:02.508Z thành 2025-05-29 17:22:02
2025-05-30 00:22:02 - Xác thực đầu vào thành công
2025-05-30 00:22:02 - Tạo địa chỉ giao hàng mới với ID: 54 cho pickup
2025-05-30 00:22:02 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '54', '4920000', 'Chờ xử lý', '2025-05-29 17:22:02', '')
2025-05-30 00:22:02 - Chèn đơn hàng với ID: 61
2025-05-30 00:22:02 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('61', 'Admin', 'Gigabyte B760M Gaming Plus Wifi D4 (x1)', '4920000', 'Lấy tại cửa hàng', 'vnpay')
2025-05-30 00:22:02 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('61', 'vnpay', '4920000', 'Chưa thanh toán')
2025-05-30 00:22:02 - Chuỗi truy vấn VNPay: vnp_Amount=492000000&vnp_Command=pay&vnp_CreateDate=20250530002202&vnp_CurrCode=VND&vnp_ExpireDate=20250530005202&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+61&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=61&vnp_Version=2.1.0&
2025-05-30 00:22:02 - Dữ liệu băm VNPay: vnp_Amount=492000000&vnp_Command=pay&vnp_CreateDate=20250530002202&vnp_CurrCode=VND&vnp_ExpireDate=20250530005202&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+61&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=61&vnp_Version=2.1.0
2025-05-30 00:22:02 - Hash VNPay được tạo: efd855ab297a241c3d7ce5766ddb2ded1678138902645d71a30f6192e2ea4bd36a9035374c2f95662ddbb259f445f92f6918c1120f117a88c94b302bbb045fa7
2025-05-30 00:22:02 - Khởi tạo thanh toán VNPay cho đơn hàng 61: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=492000000&vnp_Command=pay&vnp_CreateDate=20250530002202&vnp_CurrCode=VND&vnp_ExpireDate=20250530005202&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+61&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=61&vnp_Version=2.1.0&vnp_SecureHash=efd855ab297a241c3d7ce5766ddb2ded1678138902645d71a30f6192e2ea4bd36a9035374c2f95662ddbb259f445f92f6918c1120f117a88c94b302bbb045fa7
2025-05-30 00:22:41 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-30 00:22:41 - Yêu cầu OPTIONS được nhận
2025-05-30 00:22:41 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-30 00:22:41 - Kết nối cơ sở dữ liệu thành công
2025-05-30 00:22:41 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"mb008","ten":"Gigabyte B760M Gaming Plus Wifi D4","gia":4890000,"so_luong":1,"danh_muc":"Mainboard"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"TP HCM","district":"Quận 2","ward":"Phường 2","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":4890000,"orderDate":"2025-05-29T17:22:41.775Z"}
2025-05-30 00:22:41 - Chuyển đổi ngay_dat_hang: 2025-05-29T17:22:41.775Z thành 2025-05-29 17:22:41
2025-05-30 00:22:41 - Xác thực đầu vào thành công
2025-05-30 00:22:41 - Tạo địa chỉ giao hàng mới với ID: 55
2025-05-30 00:22:41 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '55', '4890000', 'Chờ xử lý', '2025-05-29 17:22:41', '')
2025-05-30 00:22:41 - Chèn đơn hàng với ID: 62
2025-05-30 00:22:41 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('62', 'Admin', 'Gigabyte B760M Gaming Plus Wifi D4 (x1)', '4890000', 'HCM, Phường 2, Quận 2, TP HCM', 'vnpay')
2025-05-30 00:22:41 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('62', 'vnpay', '4890000', 'Chưa thanh toán')
2025-05-30 00:22:41 - Chuỗi truy vấn VNPay: vnp_Amount=489000000&vnp_Command=pay&vnp_CreateDate=20250530002241&vnp_CurrCode=VND&vnp_ExpireDate=20250530005241&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+62&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=62&vnp_Version=2.1.0&
2025-05-30 00:22:41 - Dữ liệu băm VNPay: vnp_Amount=489000000&vnp_Command=pay&vnp_CreateDate=20250530002241&vnp_CurrCode=VND&vnp_ExpireDate=20250530005241&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+62&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=62&vnp_Version=2.1.0
2025-05-30 00:22:41 - Hash VNPay được tạo: a8d465bc6386a3260ad4c9b01592c2d8471707afafbb595a1531ff404612af353077f84dddcc099531b6c601c851ddb13ac27beccbee407fb129334f97f482eb
2025-05-30 00:22:41 - Khởi tạo thanh toán VNPay cho đơn hàng 62: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=489000000&vnp_Command=pay&vnp_CreateDate=20250530002241&vnp_CurrCode=VND&vnp_ExpireDate=20250530005241&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+62&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=62&vnp_Version=2.1.0&vnp_SecureHash=a8d465bc6386a3260ad4c9b01592c2d8471707afafbb595a1531ff404612af353077f84dddcc099531b6c601c851ddb13ac27beccbee407fb129334f97f482eb
2025-05-30 00:24:07 - Nhận yêu cầu: GET /BaiTapNhom/backend/payments.php?vnp_Amount=489000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14988853&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+62&vnp_PayDate=20250530002431&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14988853&vnp_TransactionStatus=00&vnp_TxnRef=62&vnp_SecureHash=d597be4801a56af32f875189969e7e9ed7c5f8fdf5608195c1a385166792c057c6444cd0d65dad8f8860630fa36696df0a3292bd5025f601237309a2368e000d
2025-05-30 00:24:07 - --------- Gỡ lỗi Callback VNPay ---------
2025-05-30 00:24:07 - Tất cả tham số GET: {"vnp_Amount":"489000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14988853","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 62","vnp_PayDate":"20250530002431","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14988853","vnp_TransactionStatus":"00","vnp_TxnRef":"62","vnp_SecureHash":"d597be4801a56af32f875189969e7e9ed7c5f8fdf5608195c1a385166792c057c6444cd0d65dad8f8860630fa36696df0a3292bd5025f601237309a2368e000d"}
2025-05-30 00:24:07 - vnp_SecureHash nhận được: d597be4801a56af32f875189969e7e9ed7c5f8fdf5608195c1a385166792c057c6444cd0d65dad8f8860630fa36696df0a3292bd5025f601237309a2368e000d
2025-05-30 00:24:07 - inputData sau khi sắp xếp: {"vnp_Amount":"489000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14988853","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 62","vnp_PayDate":"20250530002431","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14988853","vnp_TransactionStatus":"00","vnp_TxnRef":"62"}
2025-05-30 00:24:07 - Chuỗi hashData: vnp_Amount=489000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14988853&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+62&vnp_PayDate=20250530002431&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14988853&vnp_TransactionStatus=00&vnp_TxnRef=62
2025-05-30 00:24:07 - secureHash được tạo: d597be4801a56af32f875189969e7e9ed7c5f8fdf5608195c1a385166792c057c6444cd0d65dad8f8860630fa36696df0a3292bd5025f601237309a2368e000d
2025-05-30 00:24:07 - Khớp hash: Có
2025-05-30 00:24:07 - Trạng thái thanh toán được cập nhật cho đơn hàng 62: Đã thanh toán
2025-05-30 00:24:07 - Cập nhật trạng thái đơn hàng 62 thành 'Đã thanh toán'
2025-05-30 00:24:07 - Chuyển hướng người dùng đến trang thankyou
2025-05-30 10:47:02 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-30 10:47:02 - Yêu cầu OPTIONS được nhận
2025-05-30 10:47:02 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-30 10:47:02 - Kết nối cơ sở dữ liệu thành công
2025-05-30 10:47:02 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu002","ten":"Intel Core i9-14900K","gia":14990000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"unkown999@gmail.com","phone":"7878987909","address":"873 tam trinh","city":"Hà Nội","district":"hoàng kiếm","ward":"","note":"test chức năng"},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":14990000,"orderDate":"2025-05-30T03:47:02.821Z"}
2025-05-30 10:47:02 - Chuyển đổi ngay_dat_hang: 2025-05-30T03:47:02.821Z thành 2025-05-30 03:47:02
2025-05-30 10:47:02 - Xác thực đầu vào thành công
2025-05-30 10:47:02 - Tạo địa chỉ giao hàng mới với ID: 56 cho pickup
2025-05-30 10:47:02 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '56', '15020000', 'Chờ xử lý', '2025-05-30 03:47:02', 'test chức năng')
2025-05-30 10:47:02 - Chèn đơn hàng với ID: 63
2025-05-30 10:47:02 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('63', 'Admin', 'Intel Core i9-14900K (x1)', '15020000', 'Lấy tại cửa hàng', 'cod')
2025-05-30 10:47:02 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('63', 'cod', '15020000', 'Chưa thanh toán')
2025-05-30 10:47:02 - Giao dịch COD được xác nhận thành công
2025-05-30 10:47:02 - Đóng kết nối cơ sở dữ liệu
2025-05-30 11:23:00 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-30 11:23:00 - Yêu cầu OPTIONS được nhận
2025-05-30 11:23:00 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-30 11:23:00 - Kết nối cơ sở dữ liệu thành công
2025-05-30 11:23:00 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"gpu001","ten":"NVIDIA GeForce RTX 4090","gia":40000000,"so_luong":1,"danh_muc":"GPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Quận Long Biên","ward":"Phường Phúc Đồng","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":40000000,"orderDate":"2025-05-30T04:23:00.293Z"}
2025-05-30 11:23:00 - Chuyển đổi ngay_dat_hang: 2025-05-30T04:23:00.293Z thành 2025-05-30 04:23:00
2025-05-30 11:23:00 - Xác thực đầu vào thành công
2025-05-30 11:23:00 - Tạo địa chỉ giao hàng mới với ID: 57
2025-05-30 11:23:00 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '57', '40000000', 'Chờ xử lý', '2025-05-30 04:23:00', '')
2025-05-30 11:23:00 - Chèn đơn hàng với ID: 64
2025-05-30 11:23:00 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('64', 'Admin', 'NVIDIA GeForce RTX 4090 (x1)', '40000000', 'nhà số 1, Phường Phúc Đồng, Quận Long Biên, Thành phố Hà Nội', 'vnpay')
2025-05-30 11:23:00 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('64', 'vnpay', '40000000', 'Chưa thanh toán')
2025-05-30 11:23:00 - Chuỗi truy vấn VNPay: vnp_Amount=4000000000&vnp_Command=pay&vnp_CreateDate=20250530112300&vnp_CurrCode=VND&vnp_ExpireDate=20250530115300&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+64&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=64&vnp_Version=2.1.0&
2025-05-30 11:23:00 - Dữ liệu băm VNPay: vnp_Amount=4000000000&vnp_Command=pay&vnp_CreateDate=20250530112300&vnp_CurrCode=VND&vnp_ExpireDate=20250530115300&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+64&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=64&vnp_Version=2.1.0
2025-05-30 11:23:00 - Hash VNPay được tạo: d7319eedd704af01987f9354d8d6a507b9dd93141e4b8000294c1acb84c90f7c82a4922fa6e6c4300d595a7221b2a7354f313cb886d833d8b4dca09f8d74dad8
2025-05-30 11:23:00 - Khởi tạo thanh toán VNPay cho đơn hàng 64: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=4000000000&vnp_Command=pay&vnp_CreateDate=20250530112300&vnp_CurrCode=VND&vnp_ExpireDate=20250530115300&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+64&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=64&vnp_Version=2.1.0&vnp_SecureHash=d7319eedd704af01987f9354d8d6a507b9dd93141e4b8000294c1acb84c90f7c82a4922fa6e6c4300d595a7221b2a7354f313cb886d833d8b4dca09f8d74dad8
2025-05-30 11:24:15 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-30 11:24:15 - Yêu cầu OPTIONS được nhận
2025-05-30 11:24:15 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-30 11:24:15 - Kết nối cơ sở dữ liệu thành công
2025-05-30 11:24:15 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu004","ten":"CPU Intel Core i7 14700K","gia":10690000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Tỉnh Điện Biên","district":"Huyện Mường Nhé","ward":"Xã Quảng Lâm","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":10690000,"orderDate":"2025-05-30T04:24:15.134Z"}
2025-05-30 11:24:15 - Chuyển đổi ngay_dat_hang: 2025-05-30T04:24:15.134Z thành 2025-05-30 04:24:15
2025-05-30 11:24:15 - Xác thực đầu vào thành công
2025-05-30 11:24:15 - Tạo địa chỉ giao hàng mới với ID: 58
2025-05-30 11:24:15 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '58', '10690000', 'Chờ xử lý', '2025-05-30 04:24:15', '')
2025-05-30 11:24:15 - Chèn đơn hàng với ID: 65
2025-05-30 11:24:15 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('65', 'Admin', 'CPU Intel Core i7 14700K (x1)', '10690000', 'HCM, Xã Quảng Lâm, Huyện Mường Nhé, Tỉnh Điện Biên', 'cod')
2025-05-30 11:24:15 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('65', 'cod', '10690000', 'Chưa thanh toán')
2025-05-30 11:24:15 - Giao dịch COD được xác nhận thành công
2025-05-30 11:24:15 - Đóng kết nối cơ sở dữ liệu
2025-05-30 12:52:45 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-30 12:52:45 - Yêu cầu OPTIONS được nhận
2025-05-30 12:52:45 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-30 12:52:45 - Kết nối cơ sở dữ liệu thành công
2025-05-30 12:52:45 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu007","ten":"AMD Ryzen 9 9950X","gia":18500000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"unkown999@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":18500000,"orderDate":"2025-05-30T05:52:45.230Z"}
2025-05-30 12:52:45 - Chuyển đổi ngay_dat_hang: 2025-05-30T05:52:45.230Z thành 2025-05-30 05:52:45
2025-05-30 12:52:45 - Xác thực đầu vào thành công
2025-05-30 12:52:45 - Tạo địa chỉ giao hàng mới với ID: 59 cho pickup
2025-05-30 12:52:45 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '59', '18530000', 'Chờ xử lý', '2025-05-30 05:52:45', '')
2025-05-30 12:52:45 - Chèn đơn hàng với ID: 66
2025-05-30 12:52:45 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('66', 'Admin', 'AMD Ryzen 9 9950X (x1)', '18530000', 'Lấy tại cửa hàng', 'vnpay')
2025-05-30 12:52:45 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('66', 'vnpay', '18530000', 'Chưa thanh toán')
2025-05-30 12:52:45 - Chuỗi truy vấn VNPay: vnp_Amount=1853000000&vnp_Command=pay&vnp_CreateDate=20250530125245&vnp_CurrCode=VND&vnp_ExpireDate=20250530132245&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+66&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=66&vnp_Version=2.1.0&
2025-05-30 12:52:45 - Dữ liệu băm VNPay: vnp_Amount=1853000000&vnp_Command=pay&vnp_CreateDate=20250530125245&vnp_CurrCode=VND&vnp_ExpireDate=20250530132245&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+66&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=66&vnp_Version=2.1.0
2025-05-30 12:52:45 - Hash VNPay được tạo: 65eed671087854c7e24218225b4428ca0486d68336f5b6a2187d8a2ee9479685f27aa897d34d3ba529407a336cc4ebbec4fea97f423227bd7cc927719e220043
2025-05-30 12:52:45 - Khởi tạo thanh toán VNPay cho đơn hàng 66: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=1853000000&vnp_Command=pay&vnp_CreateDate=20250530125245&vnp_CurrCode=VND&vnp_ExpireDate=20250530132245&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+66&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=66&vnp_Version=2.1.0&vnp_SecureHash=65eed671087854c7e24218225b4428ca0486d68336f5b6a2187d8a2ee9479685f27aa897d34d3ba529407a336cc4ebbec4fea97f423227bd7cc927719e220043
2025-05-30 12:53:31 - Nhận yêu cầu: GET /BaiTapNhom/backend/payments.php?vnp_Amount=1853000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14989557&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+66&vnp_PayDate=20250530125359&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14989557&vnp_TransactionStatus=00&vnp_TxnRef=66&vnp_SecureHash=9a99064b8852b88d51e20d20c9bd0b0611276b8fe0153aff150f778ef137bede85e7ecea08b14834beb9c9164adc2af812ea685c2bd38a9e21d7d213cac56cd7
2025-05-30 12:53:31 - --------- Gỡ lỗi Callback VNPay ---------
2025-05-30 12:53:31 - Tất cả tham số GET: {"vnp_Amount":"1853000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14989557","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 66","vnp_PayDate":"20250530125359","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14989557","vnp_TransactionStatus":"00","vnp_TxnRef":"66","vnp_SecureHash":"9a99064b8852b88d51e20d20c9bd0b0611276b8fe0153aff150f778ef137bede85e7ecea08b14834beb9c9164adc2af812ea685c2bd38a9e21d7d213cac56cd7"}
2025-05-30 12:53:31 - vnp_SecureHash nhận được: 9a99064b8852b88d51e20d20c9bd0b0611276b8fe0153aff150f778ef137bede85e7ecea08b14834beb9c9164adc2af812ea685c2bd38a9e21d7d213cac56cd7
2025-05-30 12:53:31 - inputData sau khi sắp xếp: {"vnp_Amount":"1853000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14989557","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 66","vnp_PayDate":"20250530125359","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14989557","vnp_TransactionStatus":"00","vnp_TxnRef":"66"}
2025-05-30 12:53:31 - Chuỗi hashData: vnp_Amount=1853000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14989557&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+66&vnp_PayDate=20250530125359&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14989557&vnp_TransactionStatus=00&vnp_TxnRef=66
2025-05-30 12:53:31 - secureHash được tạo: 9a99064b8852b88d51e20d20c9bd0b0611276b8fe0153aff150f778ef137bede85e7ecea08b14834beb9c9164adc2af812ea685c2bd38a9e21d7d213cac56cd7
2025-05-30 12:53:31 - Khớp hash: Có
2025-05-30 12:53:31 - Trạng thái thanh toán được cập nhật cho đơn hàng 66: Đã thanh toán
2025-05-30 12:53:31 - Cập nhật trạng thái đơn hàng 66 thành 'Đã thanh toán'
2025-05-30 12:53:31 - Chuyển hướng người dùng đến trang thankyou
2025-05-30 13:01:42 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-30 13:01:42 - Yêu cầu OPTIONS được nhận
2025-05-30 13:01:42 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-30 13:01:42 - Kết nối cơ sở dữ liệu thành công
2025-05-30 13:01:42 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu004","ten":"CPU Intel Core i7 14700K","gia":10690000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Tỉnh Phú Thọ","district":"Huyện Thanh Thuỷ","ward":"Xã Đào Xá","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":10690000,"orderDate":"2025-05-30T06:01:42.899Z"}
2025-05-30 13:01:42 - Chuyển đổi ngay_dat_hang: 2025-05-30T06:01:42.899Z thành 2025-05-30 06:01:42
2025-05-30 13:01:42 - Xác thực đầu vào thành công
2025-05-30 13:01:42 - Tạo địa chỉ giao hàng mới với ID: 60
2025-05-30 13:01:42 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '60', '10690000', 'Chờ xử lý', '2025-05-30 06:01:42', '')
2025-05-30 13:01:42 - Chèn đơn hàng với ID: 67
2025-05-30 13:01:42 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('67', 'Admin', 'CPU Intel Core i7 14700K (x1)', '10690000', 'HCM, Xã Đào Xá, Huyện Thanh Thuỷ, Tỉnh Phú Thọ', 'cod')
2025-05-30 13:01:42 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('67', 'cod', '10690000', 'Chưa thanh toán')
2025-05-30 13:01:42 - Giao dịch COD được xác nhận thành công
2025-05-30 13:01:42 - Đóng kết nối cơ sở dữ liệu
2025-05-30 13:06:39 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-30 13:06:39 - Yêu cầu OPTIONS được nhận
2025-05-30 13:06:39 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-30 13:06:39 - Kết nối cơ sở dữ liệu thành công
2025-05-30 13:06:39 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu003","ten":"CPU Intel Core Ultra 9 285K","gia":17290000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Thành phố Hà Nội","district":"Huyện Đông Anh","ward":"Xã Bắc Hồng","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":17290000,"orderDate":"2025-05-30T06:06:39.455Z"}
2025-05-30 13:06:39 - Chuyển đổi ngay_dat_hang: 2025-05-30T06:06:39.455Z thành 2025-05-30 06:06:39
2025-05-30 13:06:39 - Xác thực đầu vào thành công
2025-05-30 13:06:39 - Tạo địa chỉ giao hàng mới với ID: 61
2025-05-30 13:06:39 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '61', '17290000', 'Chờ xử lý', '2025-05-30 06:06:39', '')
2025-05-30 13:06:39 - Chèn đơn hàng với ID: 68
2025-05-30 13:06:39 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('68', 'Admin', 'CPU Intel Core Ultra 9 285K (x1)', '17290000', 'HCM, Xã Bắc Hồng, Huyện Đông Anh, Thành phố Hà Nội', 'cod')
2025-05-30 13:06:39 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('68', 'cod', '17290000', 'Chưa thanh toán')
2025-05-30 13:06:39 - Giao dịch COD được xác nhận thành công
2025-05-30 13:06:39 - Đóng kết nối cơ sở dữ liệu
2025-05-30 14:25:43 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-05-30 14:25:43 - Yêu cầu OPTIONS được nhận
2025-05-30 14:25:44 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-05-30 14:25:44 - Kết nối cơ sở dữ liệu thành công
2025-05-30 14:25:44 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"gpu005","ten":"Gigabyte RTX 4070 GAMING OC 12GB GDDR6X","gia":21900000,"so_luong":1,"danh_muc":"GPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Thành phố Hà Nội","district":"Quận Ba Đình","ward":"Phường Kim Mã","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":21900000,"orderDate":"2025-05-30T07:25:43.983Z"}
2025-05-30 14:25:44 - Chuyển đổi ngay_dat_hang: 2025-05-30T07:25:43.983Z thành 2025-05-30 07:25:43
2025-05-30 14:25:44 - Xác thực đầu vào thành công
2025-05-30 14:25:44 - Tạo địa chỉ giao hàng mới với ID: 62
2025-05-30 14:25:44 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '62', '21900000', 'Chờ xử lý', '2025-05-30 07:25:43', '')
2025-05-30 14:25:44 - Chèn đơn hàng với ID: 69
2025-05-30 14:25:44 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('69', 'Admin', 'Gigabyte RTX 4070 GAMING OC 12GB GDDR6X (x1)', '21900000', 'HCM, Phường Kim Mã, Quận Ba Đình, Thành phố Hà Nội', 'vnpay')
2025-05-30 14:25:44 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('69', 'vnpay', '21900000', 'Chưa thanh toán')
2025-05-30 14:25:44 - Chuỗi truy vấn VNPay: vnp_Amount=2190000000&vnp_Command=pay&vnp_CreateDate=20250530142544&vnp_CurrCode=VND&vnp_ExpireDate=20250530145544&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+69&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=69&vnp_Version=2.1.0&
2025-05-30 14:25:44 - Dữ liệu băm VNPay: vnp_Amount=2190000000&vnp_Command=pay&vnp_CreateDate=20250530142544&vnp_CurrCode=VND&vnp_ExpireDate=20250530145544&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+69&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=69&vnp_Version=2.1.0
2025-05-30 14:25:44 - Hash VNPay được tạo: 3f5149def6cdd4e80ad0121a1c3b7fb40f2cf02d68a09aa6ba7b01515138e9055aebdabcc70b2e53c176bc485607717410f073f8c14ad800d6be94826ce881f5
2025-05-30 14:25:44 - Khởi tạo thanh toán VNPay cho đơn hàng 69: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=2190000000&vnp_Command=pay&vnp_CreateDate=20250530142544&vnp_CurrCode=VND&vnp_ExpireDate=20250530145544&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+69&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=69&vnp_Version=2.1.0&vnp_SecureHash=3f5149def6cdd4e80ad0121a1c3b7fb40f2cf02d68a09aa6ba7b01515138e9055aebdabcc70b2e53c176bc485607717410f073f8c14ad800d6be94826ce881f5
2025-05-30 14:26:07 - Nhận yêu cầu: GET /BaiTapNhom/backend/payments.php?vnp_Amount=2190000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14989745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+69&vnp_PayDate=20250530142634&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14989745&vnp_TransactionStatus=00&vnp_TxnRef=69&vnp_SecureHash=a254f4852153b049bcf6b75caa7827b02f1c26be585ad8177921521caead5931fcc087242c349ca1ff87d27999d953140de31a87a9acd5dbbef0efab8f16a4a7
2025-05-30 14:26:07 - --------- Gỡ lỗi Callback VNPay ---------
2025-05-30 14:26:07 - Tất cả tham số GET: {"vnp_Amount":"2190000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14989745","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 69","vnp_PayDate":"20250530142634","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14989745","vnp_TransactionStatus":"00","vnp_TxnRef":"69","vnp_SecureHash":"a254f4852153b049bcf6b75caa7827b02f1c26be585ad8177921521caead5931fcc087242c349ca1ff87d27999d953140de31a87a9acd5dbbef0efab8f16a4a7"}
2025-05-30 14:26:07 - vnp_SecureHash nhận được: a254f4852153b049bcf6b75caa7827b02f1c26be585ad8177921521caead5931fcc087242c349ca1ff87d27999d953140de31a87a9acd5dbbef0efab8f16a4a7
2025-05-30 14:26:07 - inputData sau khi sắp xếp: {"vnp_Amount":"2190000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP14989745","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 69","vnp_PayDate":"20250530142634","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"14989745","vnp_TransactionStatus":"00","vnp_TxnRef":"69"}
2025-05-30 14:26:07 - Chuỗi hashData: vnp_Amount=2190000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14989745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+69&vnp_PayDate=20250530142634&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=14989745&vnp_TransactionStatus=00&vnp_TxnRef=69
2025-05-30 14:26:07 - secureHash được tạo: a254f4852153b049bcf6b75caa7827b02f1c26be585ad8177921521caead5931fcc087242c349ca1ff87d27999d953140de31a87a9acd5dbbef0efab8f16a4a7
2025-05-30 14:26:07 - Khớp hash: Có
2025-05-30 14:26:07 - Trạng thái thanh toán được cập nhật cho đơn hàng 69: Đã thanh toán
2025-05-30 14:26:07 - Cập nhật trạng thái đơn hàng 69 thành 'Đã thanh toán'
2025-05-30 14:26:07 - Chuyển hướng người dùng đến trang thankyou
2025-06-02 23:05:17 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-02 23:05:17 - Yêu cầu OPTIONS được nhận
2025-06-02 23:05:17 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-02 23:05:17 - Kết nối cơ sở dữ liệu thành công
2025-06-02 23:05:17 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu002","ten":"Intel Core i9-14900K","gia":14990000,"so_luong":1,"danh_muc":"CPU"},{"id_product":"mb005","ten":"MSI PRO Z790-S WIFI DDR5","gia":5190000,"so_luong":5,"danh_muc":"Mainboard"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Tỉnh Bắc Giang","district":"Huyện Hiệp Hòa","ward":"Xã Hương Lâm","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":40940000,"orderDate":"2025-06-02T16:05:17.759Z"}
2025-06-02 23:05:17 - Chuyển đổi ngay_dat_hang: 2025-06-02T16:05:17.759Z thành 2025-06-02 16:05:17
2025-06-02 23:05:17 - Xác thực đầu vào thành công
2025-06-02 23:05:17 - Tạo địa chỉ giao hàng mới với ID: 63
2025-06-02 23:05:17 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '63', '40940000', 'Chờ xử lý', '2025-06-02 16:05:17', '')
2025-06-02 23:05:17 - Chèn đơn hàng với ID: 70
2025-06-02 23:05:17 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('70', 'Admin', 'Intel Core i9-14900K (x1), MSI PRO Z790-S WIFI DDR5 (x5)', '40940000', 'HCM, Xã Hương Lâm, Huyện Hiệp Hòa, Tỉnh Bắc Giang', 'cod')
2025-06-02 23:05:17 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('70', 'cod', '40940000', 'Chưa thanh toán')
2025-06-02 23:05:17 - Giao dịch COD được xác nhận thành công
2025-06-02 23:05:17 - Đóng kết nối cơ sở dữ liệu
2025-06-03 15:00:12 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-03 15:00:12 - Yêu cầu OPTIONS được nhận
2025-06-03 15:00:12 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-03 15:00:12 - Kết nối cơ sở dữ liệu thành công
2025-06-03 15:00:12 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"1","city":"Thành phố Hà Nội","district":"Quận Hoàng Mai","ward":"Phường Lĩnh Nam","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":14000000,"orderDate":"2025-06-03T08:00:12.287Z"}
2025-06-03 15:00:12 - Chuyển đổi ngay_dat_hang: 2025-06-03T08:00:12.287Z thành 2025-06-03 08:00:12
2025-06-03 15:00:12 - Xác thực đầu vào thành công
2025-06-03 15:00:12 - Tạo địa chỉ giao hàng mới với ID: 64
2025-06-03 15:00:12 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '64', '14000000', 'Chờ xử lý', '2025-06-03 08:00:12', '')
2025-06-03 15:00:12 - Chèn đơn hàng với ID: 71
2025-06-03 15:00:12 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('71', 'Admin', 'Intel Core i9-13900K (x1)', '14000000', '1, Phường Lĩnh Nam, Quận Hoàng Mai, Thành phố Hà Nội', 'cod')
2025-06-03 15:00:12 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('71', 'cod', '14000000', 'Chưa thanh toán')
2025-06-03 15:00:12 - Giao dịch COD được xác nhận thành công
2025-06-03 15:00:12 - Đóng kết nối cơ sở dữ liệu
2025-06-04 10:37:36 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-04 10:37:36 - Yêu cầu OPTIONS được nhận
2025-06-04 10:37:36 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-04 10:37:36 - Kết nối cơ sở dữ liệu thành công
2025-06-04 10:37:36 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu010","ten":"AMD Ryzen 7 9800X3D","gia":14390000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"1","city":"Thành phố Hà Nội","district":"Quận Ba Đình","ward":"Phường Kim Mã","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":14390000,"orderDate":"2025-06-04T03:37:36.650Z"}
2025-06-04 10:37:36 - Chuyển đổi ngay_dat_hang: 2025-06-04T03:37:36.650Z thành 2025-06-04 03:37:36
2025-06-04 10:37:36 - Xác thực đầu vào thành công
2025-06-04 10:37:36 - Tạo địa chỉ giao hàng mới với ID: 65
2025-06-04 10:37:36 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '65', '14390000', 'Chờ xử lý', '2025-06-04 03:37:36', '')
2025-06-04 10:37:36 - Chèn đơn hàng với ID: 72
2025-06-04 10:37:36 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('72', 'Admin', 'AMD Ryzen 7 9800X3D (x1)', '14390000', '1, Phường Kim Mã, Quận Ba Đình, Thành phố Hà Nội', 'cod')
2025-06-04 10:37:36 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('72', 'cod', '14390000', 'Chưa thanh toán')
2025-06-04 10:37:36 - Giao dịch COD được xác nhận thành công
2025-06-04 10:37:36 - Đóng kết nối cơ sở dữ liệu
2025-06-04 14:47:44 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-04 14:47:44 - Yêu cầu OPTIONS được nhận
2025-06-04 14:47:44 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-04 14:47:44 - Kết nối cơ sở dữ liệu thành công
2025-06-04 14:47:44 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"storage004","ten":"Crucial P3 Plus 2TB NVMe PCIe Gen4","gia":3890000,"so_luong":10,"danh_muc":"Storage"}],"customerInfo":{"fullName":"admin32","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Tỉnh Bắc Ninh","district":"Thành phố Bắc Ninh","ward":"Phường Vũ Ninh","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":38900000,"orderDate":"2025-06-04T07:47:44.226Z"}
2025-06-04 14:47:44 - Chuyển đổi ngay_dat_hang: 2025-06-04T07:47:44.226Z thành 2025-06-04 07:47:44
2025-06-04 14:47:44 - Xác thực đầu vào thành công
2025-06-04 14:47:44 - Tạo địa chỉ giao hàng mới với ID: 66
2025-06-04 14:47:44 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '66', '38900000', 'Chờ xử lý', '2025-06-04 07:47:44', '')
2025-06-04 14:47:44 - Chèn đơn hàng với ID: 73
2025-06-04 14:47:44 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('73', 'admin32', 'Crucial P3 Plus 2TB NVMe PCIe Gen4 (x10)', '38900000', 'HCM, Phường Vũ Ninh, Thành phố Bắc Ninh, Tỉnh Bắc Ninh', 'cod')
2025-06-04 14:47:44 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('73', 'cod', '38900000', 'Chưa thanh toán')
2025-06-04 14:47:44 - Giao dịch COD được xác nhận thành công
2025-06-04 14:47:44 - Đóng kết nối cơ sở dữ liệu
2025-06-05 19:28:17 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-05 19:28:17 - Yêu cầu OPTIONS được nhận
2025-06-05 19:28:17 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-05 19:28:17 - Kết nối cơ sở dữ liệu thành công
2025-06-05 19:28:17 - Dữ liệu thô: {"userId":"9","cartItems":[{"id_product":"ram010","ten":"Transcend DDR4 3200MHz 16GB JM3200JSB-16GB","gia":950000,"so_luong":2,"danh_muc":"RAM"}],"customerInfo":{"fullName":"ldhoa","email":"hoa@gmail.com","phone":"7878987909","address":"17 đường 18 ngọc trà 2","city":"Tỉnh Thanh Hóa","district":"Huyện Quảng Xương","ward":"Xã Quảng Trung","note":"giao muộn không lấy"},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":1900000,"orderDate":"2025-06-05T12:28:17.836Z"}
2025-06-05 19:28:17 - Chuyển đổi ngay_dat_hang: 2025-06-05T12:28:17.836Z thành 2025-06-05 12:28:17
2025-06-05 19:28:17 - Xác thực đầu vào thành công
2025-06-05 19:28:17 - Tạo địa chỉ giao hàng mới với ID: 67
2025-06-05 19:28:17 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('9', '67', '1900000', 'Chờ xử lý', '2025-06-05 12:28:17', 'giao muộn không lấy')
2025-06-05 19:28:17 - Chèn đơn hàng với ID: 74
2025-06-05 19:28:17 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('74', 'ldhoa', 'Transcend DDR4 3200MHz 16GB JM3200JSB-16GB (x2)', '1900000', '17 đường 18 ngọc trà 2, Xã Quảng Trung, Huyện Quảng Xương, Tỉnh Thanh Hóa', 'cod')
2025-06-05 19:28:17 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('74', 'cod', '1900000', 'Chưa thanh toán')
2025-06-05 19:28:17 - Giao dịch COD được xác nhận thành công
2025-06-05 19:28:17 - Đóng kết nối cơ sở dữ liệu
2025-06-06 14:20:51 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-06 14:20:51 - Yêu cầu OPTIONS được nhận
2025-06-06 14:20:51 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-06 14:20:51 - Kết nối cơ sở dữ liệu thành công
2025-06-06 14:20:51 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":3,"danh_muc":"CPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Tỉnh Bắc Giang","district":"Thị xã Việt Yên","ward":"Phường Ninh Sơn","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":42000000,"orderDate":"2025-06-06T07:20:51.410Z"}
2025-06-06 14:20:51 - Chuyển đổi ngay_dat_hang: 2025-06-06T07:20:51.410Z thành 2025-06-06 07:20:51
2025-06-06 14:20:51 - Xác thực đầu vào thành công
2025-06-06 14:20:51 - Tạo địa chỉ giao hàng mới với ID: 68
2025-06-06 14:20:51 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '68', '42000000', 'Chờ xử lý', '2025-06-06 07:20:51', '')
2025-06-06 14:20:51 - Chèn đơn hàng với ID: 75
2025-06-06 14:20:51 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('75', 'Admin', 'Intel Core i9-13900K (x3)', '42000000', 'HCM, Phường Ninh Sơn, Thị xã Việt Yên, Tỉnh Bắc Giang', 'cod')
2025-06-06 14:20:51 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('75', 'cod', '42000000', 'Chưa thanh toán')
2025-06-06 14:20:51 - Giao dịch COD được xác nhận thành công
2025-06-06 14:20:51 - Đóng kết nối cơ sở dữ liệu
2025-06-06 14:28:01 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-06 14:28:01 - Yêu cầu OPTIONS được nhận
2025-06-06 14:28:01 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-06 14:28:01 - Kết nối cơ sở dữ liệu thành công
2025-06-06 14:28:01 - Dữ liệu thô: {"userId":"7","cartItems":[{"id_product":"ram001","ten":"G.Skill Trident Z5 RGB 32GB","gia":3500000,"so_luong":1,"danh_muc":"RAM"}],"customerInfo":{"fullName":"12","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Tỉnh Bắc Giang","district":"Huyện Tân Yên","ward":"Xã Ngọc Châu","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":3500000,"orderDate":"2025-06-06T07:28:01.132Z"}
2025-06-06 14:28:01 - Chuyển đổi ngay_dat_hang: 2025-06-06T07:28:01.132Z thành 2025-06-06 07:28:01
2025-06-06 14:28:01 - Xác thực đầu vào thành công
2025-06-06 14:28:01 - Tạo địa chỉ giao hàng mới với ID: 69
2025-06-06 14:28:01 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('7', '69', '3500000', 'Chờ xử lý', '2025-06-06 07:28:01', '')
2025-06-06 14:28:01 - Chèn đơn hàng với ID: 76
2025-06-06 14:28:01 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('76', '12', 'G.Skill Trident Z5 RGB 32GB (x1)', '3500000', 'HCM, Xã Ngọc Châu, Huyện Tân Yên, Tỉnh Bắc Giang', 'vnpay')
2025-06-06 14:28:01 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('76', 'vnpay', '3500000', 'Chưa thanh toán')
2025-06-06 14:28:01 - Chuỗi truy vấn VNPay: vnp_Amount=350000000&vnp_Command=pay&vnp_CreateDate=20250606142801&vnp_CurrCode=VND&vnp_ExpireDate=20250606145801&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+76&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=76&vnp_Version=2.1.0&
2025-06-06 14:28:01 - Dữ liệu băm VNPay: vnp_Amount=350000000&vnp_Command=pay&vnp_CreateDate=20250606142801&vnp_CurrCode=VND&vnp_ExpireDate=20250606145801&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+76&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=76&vnp_Version=2.1.0
2025-06-06 14:28:01 - Hash VNPay được tạo: c1398173680816588eaf87c07123b6f31e7100fcebeac1dac22af54ab985a8767bceefa033a6d228529cc8f74e6f5e7a357459736f9c7ab75af597cf2db49073
2025-06-06 14:28:01 - Khởi tạo thanh toán VNPay cho đơn hàng 76: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=350000000&vnp_Command=pay&vnp_CreateDate=20250606142801&vnp_CurrCode=VND&vnp_ExpireDate=20250606145801&vnp_IpAddr=%3A%3A1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+76&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=76&vnp_Version=2.1.0&vnp_SecureHash=c1398173680816588eaf87c07123b6f31e7100fcebeac1dac22af54ab985a8767bceefa033a6d228529cc8f74e6f5e7a357459736f9c7ab75af597cf2db49073
2025-06-06 14:29:16 - Nhận yêu cầu: GET /BaiTapNhom/backend/payments.php?vnp_Amount=350000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP15003552&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+76&vnp_PayDate=20250606142949&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=15003552&vnp_TransactionStatus=00&vnp_TxnRef=76&vnp_SecureHash=eb0097cf8e3fbd871aa9bc079235c235b4ae54761e75d6fa97266488e4116225050449c512ce76599914b39a395f6367694ed29cbc161fc72707eff16114e294
2025-06-06 14:29:16 - --------- Gỡ lỗi Callback VNPay ---------
2025-06-06 14:29:16 - Tất cả tham số GET: {"vnp_Amount":"350000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15003552","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 76","vnp_PayDate":"20250606142949","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15003552","vnp_TransactionStatus":"00","vnp_TxnRef":"76","vnp_SecureHash":"eb0097cf8e3fbd871aa9bc079235c235b4ae54761e75d6fa97266488e4116225050449c512ce76599914b39a395f6367694ed29cbc161fc72707eff16114e294"}
2025-06-06 14:29:16 - vnp_SecureHash nhận được: eb0097cf8e3fbd871aa9bc079235c235b4ae54761e75d6fa97266488e4116225050449c512ce76599914b39a395f6367694ed29cbc161fc72707eff16114e294
2025-06-06 14:29:16 - inputData sau khi sắp xếp: {"vnp_Amount":"350000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15003552","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 76","vnp_PayDate":"20250606142949","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15003552","vnp_TransactionStatus":"00","vnp_TxnRef":"76"}
2025-06-06 14:29:16 - Chuỗi hashData: vnp_Amount=350000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP15003552&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+76&vnp_PayDate=20250606142949&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=15003552&vnp_TransactionStatus=00&vnp_TxnRef=76
2025-06-06 14:29:16 - secureHash được tạo: eb0097cf8e3fbd871aa9bc079235c235b4ae54761e75d6fa97266488e4116225050449c512ce76599914b39a395f6367694ed29cbc161fc72707eff16114e294
2025-06-06 14:29:16 - Khớp hash: Có
2025-06-06 14:29:16 - Trạng thái thanh toán được cập nhật cho đơn hàng 76: Đã thanh toán
2025-06-06 14:29:16 - Cập nhật trạng thái đơn hàng 76 thành 'Đã thanh toán'
2025-06-06 14:29:16 - Chuyển hướng người dùng đến trang thankyou
2025-06-08 16:25:09 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-08 16:25:09 - Yêu cầu OPTIONS được nhận
2025-06-08 16:25:09 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-08 16:25:09 - Kết nối cơ sở dữ liệu thành công
2025-06-08 16:25:09 - Dữ liệu thô: {"userId":"9","cartItems":[{"id_product":"peripheral004","ten":"Logitech MX Master 3S","gia":2500000,"so_luong":1,"danh_muc":"Peripherals"}],"customerInfo":{"fullName":"ldhoa","email":"hoa@gmail.com","phone":"7878987909","address":"17 đường 18 ngọc trà 2","city":"Tỉnh Thanh Hóa","district":"Huyện Quan Sơn","ward":"Xã Trung Thượng","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":2500000,"orderDate":"2025-06-08T09:25:09.454Z"}
2025-06-08 16:25:09 - Chuyển đổi ngay_dat_hang: 2025-06-08T09:25:09.454Z thành 2025-06-08 09:25:09
2025-06-08 16:25:09 - Xác thực đầu vào thành công
2025-06-08 16:25:09 - Tạo địa chỉ giao hàng mới với ID: 70
2025-06-08 16:25:09 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('9', '70', '2500000', 'Chờ xử lý', '2025-06-08 09:25:09', '')
2025-06-08 16:25:09 - Chèn đơn hàng với ID: 77
2025-06-08 16:25:09 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('77', 'ldhoa', 'Logitech MX Master 3S (x1)', '2500000', '17 đường 18 ngọc trà 2, Xã Trung Thượng, Huyện Quan Sơn, Tỉnh Thanh Hóa', 'cod')
2025-06-08 16:25:09 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('77', 'cod', '2500000', 'Chưa thanh toán')
2025-06-08 16:25:09 - Giao dịch COD được xác nhận thành công
2025-06-08 16:25:09 - Đóng kết nối cơ sở dữ liệu
2025-06-08 20:49:18 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-08 20:49:18 - Yêu cầu OPTIONS được nhận
2025-06-08 20:49:19 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-08 20:49:19 - Kết nối cơ sở dữ liệu thành công
2025-06-08 20:49:19 - Dữ liệu thô: {"userId":"9","cartItems":[{"id_product":"cpu001","ten":"Intel Core i9-13900K","gia":14000000,"so_luong":1,"danh_muc":"CPU"}],"customerInfo":{"fullName":"ldhoa","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":14000000,"orderDate":"2025-06-08T13:49:18.833Z"}
2025-06-08 20:49:19 - Chuyển đổi ngay_dat_hang: 2025-06-08T13:49:18.833Z thành 2025-06-08 13:49:18
2025-06-08 20:49:19 - Xác thực đầu vào thành công
2025-06-08 20:49:19 - Tạo địa chỉ giao hàng mới với ID: 71 cho pickup
2025-06-08 20:49:19 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('9', '71', '14030000', 'Chờ xử lý', '2025-06-08 13:49:18', '')
2025-06-08 20:49:19 - Chèn đơn hàng với ID: 78
2025-06-08 20:49:19 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('78', 'ldhoa', 'Intel Core i9-13900K (x1)', '14030000', 'Lấy tại cửa hàng', 'cod')
2025-06-08 20:49:19 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('78', 'cod', '14030000', 'Chưa thanh toán')
2025-06-08 20:49:19 - Giao dịch COD được xác nhận thành công
2025-06-08 20:49:19 - Đóng kết nối cơ sở dữ liệu
2025-06-08 22:15:46 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-08 22:15:46 - Yêu cầu OPTIONS được nhận
2025-06-08 22:15:47 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-08 22:15:47 - Kết nối cơ sở dữ liệu thành công
2025-06-08 22:15:47 - Dữ liệu thô: {"userId":"9","cartItems":[{"id_product":"gpu001","ten":"NVIDIA GeForce RTX 4090","gia":40000000,"so_luong":1,"danh_muc":"GPU"}],"customerInfo":{"fullName":"ldhoa","email":"ho@hah.com","phone":"0123456789","address":"Nszn","city":"Tỉnh Lào Cai","district":"Huyện Bảo Yên","ward":"Xã Bảo Hà","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":40000000,"orderDate":"2025-06-08T15:15:47.753Z"}
2025-06-08 22:15:47 - Chuyển đổi ngay_dat_hang: 2025-06-08T15:15:47.753Z thành 2025-06-08 15:15:47
2025-06-08 22:15:47 - Xác thực đầu vào thành công
2025-06-08 22:15:47 - Tạo địa chỉ giao hàng mới với ID: 72
2025-06-08 22:15:47 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('9', '72', '40000000', 'Chờ xử lý', '2025-06-08 15:15:47', '')
2025-06-08 22:15:47 - Chèn đơn hàng với ID: 79
2025-06-08 22:15:47 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('79', 'ldhoa', 'NVIDIA GeForce RTX 4090 (x1)', '40000000', 'Nszn, Xã Bảo Hà, Huyện Bảo Yên, Tỉnh Lào Cai', 'cod')
2025-06-08 22:15:47 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('79', 'cod', '40000000', 'Chưa thanh toán')
2025-06-08 22:15:47 - Giao dịch COD được xác nhận thành công
2025-06-08 22:15:47 - Đóng kết nối cơ sở dữ liệu
2025-06-24 17:58:04 - Nhận yêu cầu: OPTIONS /BaiTapNhom/backend/payments.php
2025-06-24 17:58:04 - Yêu cầu OPTIONS được nhận
2025-06-24 17:58:05 - Nhận yêu cầu: POST /BaiTapNhom/backend/payments.php
2025-06-24 17:58:05 - Kết nối cơ sở dữ liệu thành công
2025-06-24 17:58:05 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"peripheral004","ten":"Logitech MX Master 3S","gia":2500000,"so_luong":1,"danh_muc":"Peripherals"}],"customerInfo":{"fullName":"Admin","email":"há@gmail.com","phone":"09875461846","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":2500000,"orderDate":"2025-06-24T10:58:02.029Z"}
2025-06-24 17:58:05 - Chuyển đổi ngay_dat_hang: 2025-06-24T10:58:02.029Z thành 2025-06-24 10:58:02
2025-06-24 17:58:05 - Định dạng email không hợp lệ: há@gmail.com
2025-06-28 22:58:05 - Nhận yêu cầu: OPTIONS /payments.php
2025-06-28 22:58:05 - Yêu cầu OPTIONS được nhận
2025-06-28 22:58:05 - Nhận yêu cầu: POST /payments.php
2025-06-28 22:58:05 - Kết nối cơ sở dữ liệu thành công
2025-06-28 22:58:05 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"peripheral009","ten":"Keychron K6","gia":2000000,"so_luong":1,"danh_muc":"Peripherals"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Tỉnh Hoà Bình","district":"Huyện Đà Bắc","ward":"Xã Tiền Phong","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":2000000,"orderDate":"2025-06-28T15:58:05.083Z"}
2025-06-28 22:58:05 - Chuyển đổi ngay_dat_hang: 2025-06-28T15:58:05.083Z thành 2025-06-28 15:58:05
2025-06-28 22:58:05 - Xác thực đầu vào thành công
2025-06-28 22:58:05 - Tạo địa chỉ giao hàng mới với ID: 65
2025-06-28 22:58:05 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '65', '2000000', 'Chờ xử lý', '2025-06-28 15:58:05', '')
2025-06-28 22:58:05 - Chèn đơn hàng với ID: 72
2025-06-28 22:58:05 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('72', 'Admin', 'Keychron K6 (x1)', '2000000', 'HCM, Xã Tiền Phong, Huyện Đà Bắc, Tỉnh Hoà Bình', 'vnpay')
2025-06-28 22:58:05 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('72', 'vnpay', '2000000', 'Chưa thanh toán')
2025-06-28 22:58:05 - Chuỗi truy vấn VNPay: vnp_Amount=200000000&vnp_Command=pay&vnp_CreateDate=20250628225805&vnp_CurrCode=VND&vnp_ExpireDate=20250628232805&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+72&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=72&vnp_Version=2.1.0&
2025-06-28 22:58:05 - Dữ liệu băm VNPay: vnp_Amount=200000000&vnp_Command=pay&vnp_CreateDate=20250628225805&vnp_CurrCode=VND&vnp_ExpireDate=20250628232805&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+72&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=72&vnp_Version=2.1.0
2025-06-28 22:58:05 - Hash VNPay được tạo: 9fd2b118d03402bd365344d4148e67bcde1269877ad7e81fd1aaf31d12e034b600f9f3427b9b2424969cc36462f950a29ec84e8ddab56bd65885d70718bab503
2025-06-28 22:58:05 - Khởi tạo thanh toán VNPay cho đơn hàng 72: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=200000000&vnp_Command=pay&vnp_CreateDate=20250628225805&vnp_CurrCode=VND&vnp_ExpireDate=20250628232805&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+72&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=72&vnp_Version=2.1.0&vnp_SecureHash=9fd2b118d03402bd365344d4148e67bcde1269877ad7e81fd1aaf31d12e034b600f9f3427b9b2424969cc36462f950a29ec84e8ddab56bd65885d70718bab503
2025-06-28 23:07:41 - Nhận yêu cầu: OPTIONS /payments.php
2025-06-28 23:07:41 - Yêu cầu OPTIONS được nhận
2025-06-28 23:07:42 - Nhận yêu cầu: POST /payments.php
2025-06-28 23:07:42 - Kết nối cơ sở dữ liệu thành công
2025-06-28 23:07:42 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"gpu001","ten":"NVIDIA GeForce RTX 4090","gia":40000000,"so_luong":1,"danh_muc":"GPU"}],"customerInfo":{"fullName":"Admin","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":40000000,"orderDate":"2025-06-28T16:07:41.808Z"}
2025-06-28 23:07:42 - Chuyển đổi ngay_dat_hang: 2025-06-28T16:07:41.808Z thành 2025-06-28 16:07:41
2025-06-28 23:07:42 - Xác thực đầu vào thành công
2025-06-28 23:07:42 - Tạo địa chỉ giao hàng mới với ID: 66 cho pickup
2025-06-28 23:07:42 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '66', '40000000', 'Chờ xử lý', '2025-06-28 16:07:41', '')
2025-06-28 23:07:42 - Chèn đơn hàng với ID: 73
2025-06-28 23:07:42 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('73', 'Admin', 'NVIDIA GeForce RTX 4090 (x1)', '40000000', 'Lấy tại cửa hàng', 'vnpay')
2025-06-28 23:07:42 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('73', 'vnpay', '40000000', 'Chưa thanh toán')
2025-06-28 23:07:42 - Chuỗi truy vấn VNPay: vnp_Amount=4000000000&vnp_Command=pay&vnp_CreateDate=20250628230742&vnp_CurrCode=VND&vnp_ExpireDate=20250628233742&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+73&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=73&vnp_Version=2.1.0&
2025-06-28 23:07:42 - Dữ liệu băm VNPay: vnp_Amount=4000000000&vnp_Command=pay&vnp_CreateDate=20250628230742&vnp_CurrCode=VND&vnp_ExpireDate=20250628233742&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+73&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=73&vnp_Version=2.1.0
2025-06-28 23:07:42 - Hash VNPay được tạo: 95718b5cca3688b49f4295715f8a3582561a22fa4782c2de72415bf8c2d239a5334731530bf15a80ae11f059df5a8c66bd579e9a6c07c30acd8ee3c0fc59906c
2025-06-28 23:07:42 - Khởi tạo thanh toán VNPay cho đơn hàng 73: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=4000000000&vnp_Command=pay&vnp_CreateDate=20250628230742&vnp_CurrCode=VND&vnp_ExpireDate=20250628233742&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+73&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=73&vnp_Version=2.1.0&vnp_SecureHash=95718b5cca3688b49f4295715f8a3582561a22fa4782c2de72415bf8c2d239a5334731530bf15a80ae11f059df5a8c66bd579e9a6c07c30acd8ee3c0fc59906c
2025-06-28 23:09:26 - Nhận yêu cầu: OPTIONS /payments.php
2025-06-28 23:09:26 - Yêu cầu OPTIONS được nhận
2025-06-28 23:09:27 - Nhận yêu cầu: POST /payments.php
2025-06-28 23:09:27 - Kết nối cơ sở dữ liệu thành công
2025-06-28 23:09:27 - Dữ liệu thô: {"userId":"2","cartItems":[{"id_product":"gpu001","ten":"NVIDIA GeForce RTX 4090","gia":40000000,"so_luong":1,"danh_muc":"GPU"}],"customerInfo":{"fullName":"Admin","email":"ubuntu20.04.2@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","totalAmount":40000000,"orderDate":"2025-06-28T16:09:26.681Z"}
2025-06-28 23:09:27 - Chuyển đổi ngay_dat_hang: 2025-06-28T16:09:26.681Z thành 2025-06-28 16:09:26
2025-06-28 23:09:27 - Xác thực đầu vào thành công
2025-06-28 23:09:27 - Tạo địa chỉ giao hàng mới với ID: 67 cho pickup
2025-06-28 23:09:27 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '67', '40000000', 'Chờ xử lý', '2025-06-28 16:09:26', '')
2025-06-28 23:09:27 - Chèn đơn hàng với ID: 74
2025-06-28 23:09:27 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('74', 'Admin', 'NVIDIA GeForce RTX 4090 (x1)', '40000000', 'Lấy tại cửa hàng', 'vnpay')
2025-06-28 23:09:27 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('74', 'vnpay', '40000000', 'Chưa thanh toán')
2025-06-28 23:09:27 - Chuỗi truy vấn VNPay: vnp_Amount=4000000000&vnp_Command=pay&vnp_CreateDate=20250628230927&vnp_CurrCode=VND&vnp_ExpireDate=20250628233927&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+74&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=74&vnp_Version=2.1.0&
2025-06-28 23:09:27 - Dữ liệu băm VNPay: vnp_Amount=4000000000&vnp_Command=pay&vnp_CreateDate=20250628230927&vnp_CurrCode=VND&vnp_ExpireDate=20250628233927&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+74&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=74&vnp_Version=2.1.0
2025-06-28 23:09:27 - Hash VNPay được tạo: fdf2718fa346c9f95304994641cdb62068322a99b8292ccbbd16511c4562f4403a5a0062e1906449577ea84a6ee0ebd705c25fc8c3c44a908b00aa629771231c
2025-06-28 23:09:27 - Khởi tạo thanh toán VNPay cho đơn hàng 74: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=4000000000&vnp_Command=pay&vnp_CreateDate=20250628230927&vnp_CurrCode=VND&vnp_ExpireDate=20250628233927&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+74&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%2FBaiTapNhom%2Fbackend%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=74&vnp_Version=2.1.0&vnp_SecureHash=fdf2718fa346c9f95304994641cdb62068322a99b8292ccbbd16511c4562f4403a5a0062e1906449577ea84a6ee0ebd705c25fc8c3c44a908b00aa629771231c
2025-07-01 13:13:35 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 13:13:35 - Yêu cầu OPTIONS được nhận
2025-07-01 13:13:35 - Nhận yêu cầu: POST /payments.php
2025-07-01 13:13:35 - Kết nối cơ sở dữ liệu thành công
2025-07-01 13:13:35 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":2,"ten_sp":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia_sau":109990000,"so_luong":1,"loai":"GPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Thành phố Hà Nội","district":"Quận Đống Đa","ward":"Phường Phương Liên - Trung Tự","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":109990000,"orderDate":"2025-07-01T06:13:34.971Z"}
2025-07-01 13:13:35 - Chuyển đổi ngay_dat_hang: 2025-07-01T06:13:34.971Z thành 2025-07-01 06:13:34
2025-07-01 13:13:35 - Mục giỏ hàng không hợp lệ tại chỉ số 0: thiếu trường bắt buộc hoặc giá không hợp lệ
2025-07-01 13:14:51 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 13:14:51 - Yêu cầu OPTIONS được nhận
2025-07-01 13:14:51 - Nhận yêu cầu: POST /payments.php
2025-07-01 13:14:51 - Kết nối cơ sở dữ liệu thành công
2025-07-01 13:14:51 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":2,"ten_sp":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia_sau":109990000,"so_luong":1,"loai":"GPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Thành phố Hà Nội","district":"Quận Long Biên","ward":"Phường Đức Giang","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":109990000,"orderDate":"2025-07-01T06:14:51.668Z"}
2025-07-01 13:14:51 - Chuyển đổi ngay_dat_hang: 2025-07-01T06:14:51.668Z thành 2025-07-01 06:14:51
2025-07-01 13:14:52 - Mục giỏ hàng không hợp lệ tại chỉ số 0: thiếu trường bắt buộc hoặc giá không hợp lệ
2025-07-01 13:24:56 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 13:24:56 - Yêu cầu OPTIONS được nhận
2025-07-01 13:24:56 - Nhận yêu cầu: POST /payments.php
2025-07-01 13:24:56 - Kết nối cơ sở dữ liệu thành công
2025-07-01 13:24:57 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":2,"ten_sp":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia_sau":109990000,"so_luong":1,"loai":"GPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":109990000,"orderDate":"2025-07-01T06:24:56.664Z"}
2025-07-01 13:24:57 - Chuyển đổi ngay_dat_hang: 2025-07-01T06:24:56.664Z thành 2025-07-01 06:24:56
2025-07-01 13:24:57 - Mục giỏ hàng không hợp lệ tại chỉ số 0: thiếu trường bắt buộc hoặc giá không hợp lệ
2025-07-01 13:26:38 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 13:26:38 - Yêu cầu OPTIONS được nhận
2025-07-01 13:26:39 - Nhận yêu cầu: POST /payments.php
2025-07-01 13:26:39 - Kết nối cơ sở dữ liệu thành công
2025-07-01 13:26:39 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":5,"ten_sp":"RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8","gia_sau":650000,"so_luong":1,"loai":"RAM"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":650000,"orderDate":"2025-07-01T06:26:38.856Z"}
2025-07-01 13:26:39 - Chuyển đổi ngay_dat_hang: 2025-07-01T06:26:38.856Z thành 2025-07-01 06:26:38
2025-07-01 13:26:39 - Mục giỏ hàng không hợp lệ tại chỉ số 0: thiếu trường bắt buộc hoặc giá không hợp lệ
2025-07-01 13:32:57 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 13:32:57 - Yêu cầu OPTIONS được nhận
2025-07-01 13:32:57 - Nhận yêu cầu: POST /payments.php
2025-07-01 13:32:57 - Kết nối cơ sở dữ liệu thành công
2025-07-01 13:32:57 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":5,"ten_sp":"RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8","gia_sau":650000,"so_luong":1,"loai":"RAM"}],"customerInfo":{"fullName":"Admin","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":650000,"orderDate":"2025-07-01T06:32:57.092Z"}
2025-07-01 13:32:57 - Chuyển đổi ngay_dat_hang: 2025-07-01T06:32:57.092Z thành 2025-07-01 06:32:57
2025-07-01 13:32:57 - Mục giỏ hàng không hợp lệ tại chỉ số 0: thiếu trường bắt buộc hoặc giá không hợp lệ
2025-07-01 13:34:47 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 13:34:47 - Yêu cầu OPTIONS được nhận
2025-07-01 13:34:47 - Nhận yêu cầu: POST /payments.php
2025-07-01 13:34:47 - Kết nối cơ sở dữ liệu thành công
2025-07-01 13:34:47 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":5,"ten":"RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8","gia":650000,"so_luong":1,"loai":"RAM"}],"customerInfo":{"fullName":"Admin","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":650000,"orderDate":"2025-07-01T06:34:47.576Z"}
2025-07-01 13:34:47 - Chuyển đổi ngay_dat_hang: 2025-07-01T06:34:47.576Z thành 2025-07-01 06:34:47
2025-07-01 13:34:47 - Xác thực đầu vào thành công
2025-07-01 13:34:47 - Tạo địa chỉ giao hàng mới với ID: 68 cho pickup
2025-07-01 13:34:47 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '68', '650000', 'Chờ xử lý', '2025-07-01 06:34:47', '')
2025-07-01 13:34:47 - Chèn đơn hàng với ID: 75
2025-07-01 13:34:48 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('75', 'Admin', 'RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8 (x1)', '650000', 'Lấy tại cửa hàng', 'cod')
2025-07-01 13:34:48 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('75', 'cod', '650000', 'Chưa thanh toán')
2025-07-01 13:34:48 - Giao dịch COD được xác nhận thành công
2025-07-01 13:34:48 - Đóng kết nối cơ sở dữ liệu
2025-07-01 22:34:07 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 22:34:07 - Yêu cầu OPTIONS được nhận
2025-07-01 22:53:40 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 22:53:40 - Yêu cầu OPTIONS được nhận
2025-07-01 22:53:46 - Nhận yêu cầu: GET /payments.php
2025-07-01 22:53:46 - Kết nối cơ sở dữ liệu thành công
2025-07-01 22:53:46 - Dữ liệu thô: 
2025-07-01 22:53:46 - JSON không hợp lệ: Syntax error
2025-07-01 22:59:43 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 22:59:43 - Yêu cầu OPTIONS được nhận
2025-07-01 23:01:33 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 23:01:33 - Yêu cầu OPTIONS được nhận
2025-07-01 23:05:28 - Nhận yêu cầu: OPTIONS /payments.php
2025-07-01 23:05:28 - Yêu cầu OPTIONS được nhận
2025-07-01 23:10:34 - Nhận yêu cầu: POST /payments.php
2025-07-01 23:10:34 - Kết nối cơ sở dữ liệu thành công
2025-07-01 23:10:34 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":8,"ten":"Ổ cứng di động Sandisk E61 Extreme V2 SSD 1TB USB 3.2","gia":3090000,"so_luong":1,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":3090000,"orderDate":"2025-07-01T16:10:34.108Z"}
2025-07-01 23:10:34 - Chuyển đổi ngay_dat_hang: 2025-07-01T16:10:34.108Z thành 2025-07-01 16:10:34
2025-07-01 23:10:34 - Xác thực đầu vào thành công
2025-07-01 23:10:34 - Tạo địa chỉ giao hàng mới với ID: 65 cho pickup
2025-07-01 23:10:34 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '65', '3090000', 'Chờ xử lý', '2025-07-01 16:10:34', '')
2025-07-01 23:10:34 - Chèn đơn hàng với ID: 72
2025-07-01 23:10:34 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('72', 'Admin', 'Ổ cứng di động Sandisk E61 Extreme V2 SSD 1TB USB 3.2 (x1)', '3090000', 'Lấy tại cửa hàng', 'cod')
2025-07-01 23:10:34 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('72', 'cod', '3090000', 'Chưa thanh toán')
2025-07-01 23:10:34 - Giao dịch COD được xác nhận thành công
2025-07-01 23:10:34 - Đóng kết nối cơ sở dữ liệu
2025-07-01 23:13:17 - Nhận yêu cầu: POST /payments.php
2025-07-01 23:13:17 - Kết nối cơ sở dữ liệu thành công
2025-07-01 23:13:17 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":8,"ten":"Ổ cứng di động Sandisk E61 Extreme V2 SSD 1TB USB 3.2","gia":3090000,"so_luong":1,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":3090000,"orderDate":"2025-07-01T16:13:16.759Z"}
2025-07-01 23:13:17 - Chuyển đổi ngay_dat_hang: 2025-07-01T16:13:16.759Z thành 2025-07-01 16:13:16
2025-07-01 23:13:17 - Xác thực đầu vào thành công
2025-07-01 23:13:17 - Tạo địa chỉ giao hàng mới với ID: 66 cho pickup
2025-07-01 23:13:17 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '66', '3090000', 'Chờ xử lý', '2025-07-01 16:13:16', '')
2025-07-01 23:13:17 - Chèn đơn hàng với ID: 73
2025-07-01 23:13:17 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('73', 'Admin', 'Ổ cứng di động Sandisk E61 Extreme V2 SSD 1TB USB 3.2 (x1)', '3090000', 'Lấy tại cửa hàng', 'cod')
2025-07-01 23:13:17 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('73', 'cod', '3090000', 'Chưa thanh toán')
2025-07-01 23:13:17 - Giao dịch COD được xác nhận thành công
2025-07-01 23:13:17 - Đóng kết nối cơ sở dữ liệu
2025-07-02 13:44:14 - Nhận yêu cầu: POST /payments.php
2025-07-02 13:44:14 - Kết nối cơ sở dữ liệu thành công
2025-07-02 13:44:14 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"loai":"GPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Thành phố Hà Nội","district":"Thị xã Sơn Tây","ward":"Xã Sơn Đông","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":109990000,"orderDate":"2025-07-02T06:44:14.161Z"}
2025-07-02 13:44:14 - Chuyển đổi ngay_dat_hang: 2025-07-02T06:44:14.161Z thành 2025-07-02 06:44:14
2025-07-02 13:44:14 - Xác thực đầu vào thành công
2025-07-02 13:44:14 - Tạo địa chỉ giao hàng mới với ID: 65
2025-07-02 13:44:14 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '65', '109990000', 'Chờ xử lý', '2025-07-02 06:44:14', '')
2025-07-02 13:44:14 - Chèn đơn hàng với ID: 72
2025-07-02 13:44:14 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('72', 'Admin', 'VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x1)', '109990000', 'HCM, Xã Sơn Đông, Thị xã Sơn Tây, Thành phố Hà Nội', 'cod')
2025-07-02 13:44:14 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('72', 'cod', '109990000', 'Chưa thanh toán')
2025-07-02 13:44:14 - Giao dịch COD được xác nhận thành công
2025-07-02 13:44:14 - Đóng kết nối cơ sở dữ liệu
2025-07-03 08:28:44 - Nhận yêu cầu: POST /payments.php
2025-07-03 08:28:44 - Kết nối cơ sở dữ liệu thành công
2025-07-03 08:28:44 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"loai":"GPU"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"HCM","city":"Thành phố Hà Nội","district":"Quận Ba Đình","ward":"Phường Vĩnh Phúc","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":109990000,"orderDate":"2025-07-03T01:28:43.771Z"}
2025-07-03 08:28:44 - Chuyển đổi ngay_dat_hang: 2025-07-03T01:28:43.771Z thành 2025-07-03 01:28:43
2025-07-03 08:28:44 - Xác thực đầu vào thành công
2025-07-03 08:28:44 - Tạo địa chỉ giao hàng mới với ID: 66
2025-07-03 08:28:44 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '66', '109990000', 'Chờ xử lý', '2025-07-03 01:28:43', '')
2025-07-03 08:28:44 - Chèn đơn hàng với ID: 73
2025-07-03 08:28:44 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('73', 'Admin', 'VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x1)', '109990000', 'HCM, Phường Vĩnh Phúc, Quận Ba Đình, Thành phố Hà Nội', 'vnpay')
2025-07-03 08:28:44 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('73', 'vnpay', '109990000', 'Chưa thanh toán')
2025-07-03 08:28:44 - Chuỗi truy vấn VNPay: vnp_Amount=10999000000&vnp_Command=pay&vnp_CreateDate=20250703082844&vnp_CurrCode=VND&vnp_ExpireDate=20250703085844&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+73&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%3A8080%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=73&vnp_Version=2.1.0&
2025-07-03 08:28:44 - Dữ liệu băm VNPay: vnp_Amount=10999000000&vnp_Command=pay&vnp_CreateDate=20250703082844&vnp_CurrCode=VND&vnp_ExpireDate=20250703085844&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+73&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%3A8080%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=73&vnp_Version=2.1.0
2025-07-03 08:28:44 - Hash VNPay được tạo: 62cb3b74e34440357b7bd2d39860d27daf7da00143507b359033b911199787e346b4e7d374ea44bae94b4f19cdb0dc5a09d5ea5787340f1e2220b7d370f430cf
2025-07-03 08:28:44 - Khởi tạo thanh toán VNPay cho đơn hàng 73: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=10999000000&vnp_Command=pay&vnp_CreateDate=20250703082844&vnp_CurrCode=VND&vnp_ExpireDate=20250703085844&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+73&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%3A8080%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=73&vnp_Version=2.1.0&vnp_SecureHash=62cb3b74e34440357b7bd2d39860d27daf7da00143507b359033b911199787e346b4e7d374ea44bae94b4f19cdb0dc5a09d5ea5787340f1e2220b7d370f430cf
2025-07-03 08:30:39 - Nhận yêu cầu: GET /payments.php?vnp_Amount=10999000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP15052782&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+73&vnp_PayDate=20250703083127&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=15052782&vnp_TransactionStatus=00&vnp_TxnRef=73&vnp_SecureHash=41efdb83fd5d3f23f1416bb68e9940bfb129b122b6b3211bfae31c5e35b5b4ec2bf3c58122cfa6820158046aee79c477550d80277a4e0a66054d2f774a0628ca
2025-07-03 08:30:39 - --------- Gỡ lỗi Callback VNPay ---------
2025-07-03 08:30:39 - Tất cả tham số GET: {"vnp_Amount":"10999000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15052782","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 73","vnp_PayDate":"20250703083127","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15052782","vnp_TransactionStatus":"00","vnp_TxnRef":"73","vnp_SecureHash":"41efdb83fd5d3f23f1416bb68e9940bfb129b122b6b3211bfae31c5e35b5b4ec2bf3c58122cfa6820158046aee79c477550d80277a4e0a66054d2f774a0628ca"}
2025-07-03 08:30:39 - vnp_SecureHash nhận được: 41efdb83fd5d3f23f1416bb68e9940bfb129b122b6b3211bfae31c5e35b5b4ec2bf3c58122cfa6820158046aee79c477550d80277a4e0a66054d2f774a0628ca
2025-07-03 08:30:39 - inputData sau khi sắp xếp: {"vnp_Amount":"10999000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15052782","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 73","vnp_PayDate":"20250703083127","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15052782","vnp_TransactionStatus":"00","vnp_TxnRef":"73"}
2025-07-03 08:30:39 - Chuỗi hashData: vnp_Amount=10999000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP15052782&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+73&vnp_PayDate=20250703083127&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=15052782&vnp_TransactionStatus=00&vnp_TxnRef=73
2025-07-03 08:30:39 - secureHash được tạo: 41efdb83fd5d3f23f1416bb68e9940bfb129b122b6b3211bfae31c5e35b5b4ec2bf3c58122cfa6820158046aee79c477550d80277a4e0a66054d2f774a0628ca
2025-07-03 08:30:39 - Khớp hash: Có
2025-07-03 08:30:39 - Trạng thái thanh toán được cập nhật cho đơn hàng 73: Đã thanh toán
2025-07-03 08:30:39 - Cập nhật trạng thái đơn hàng 73 thành 'Đã thanh toán'
2025-07-03 09:15:02 - Nhận yêu cầu: POST /payments.php
2025-07-03 09:15:02 - Kết nối cơ sở dữ liệu thành công
2025-07-03 09:15:02 - Dữ liệu thô: {"userId":"15","cartItems":[{"id":54,"ten":"Ổ cứng SSD ADATA LEGEND 860 PCIE GEN4 X4 M.2 2280 (R 6000/W 5000) 1TB","gia":1690000,"so_luong":18,"loai":"storage"},{"id":57,"ten":"Ổ cứng di động HDD Transcend Storejet 25M3C USB-C 2TB","gia":2590000,"so_luong":1,"loai":"storage"}],"customerInfo":{"fullName":"bt huyền","email":"huyen1@gmail.com","phone":"0987654321","address":"12  abc","city":"Tỉnh Vĩnh Phúc","district":"Huyện Vĩnh Tường","ward":"Thị trấn Tứ Trưng","note":"shop giao nhanh giúp mình"},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":33010000,"orderDate":"2025-07-03T02:15:04.930Z"}
2025-07-03 09:15:02 - Chuyển đổi ngay_dat_hang: 2025-07-03T02:15:04.930Z thành 2025-07-03 02:15:04
2025-07-03 09:15:02 - Xác thực đầu vào thành công
2025-07-03 09:15:02 - Tạo địa chỉ giao hàng mới với ID: 67
2025-07-03 09:15:02 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('15', '67', '33010000', 'Chờ xử lý', '2025-07-03 02:15:04', 'shop giao nhanh giúp mình')
2025-07-03 09:15:02 - Chèn đơn hàng với ID: 74
2025-07-03 09:15:02 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('74', 'bt huyền', 'Ổ cứng SSD ADATA LEGEND 860 PCIE GEN4 X4 M.2 2280 (R 6000/W 5000) 1TB (x18), Ổ cứng di động HDD Transcend Storejet 25M3C USB-C 2TB (x1)', '33010000', '12  abc, Thị trấn Tứ Trưng, Huyện Vĩnh Tường, Tỉnh Vĩnh Phúc', 'cod')
2025-07-03 09:15:02 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('74', 'cod', '33010000', 'Chưa thanh toán')
2025-07-03 09:15:02 - Giao dịch COD được xác nhận thành công
2025-07-03 09:15:02 - Đóng kết nối cơ sở dữ liệu
2025-07-03 09:17:42 - Nhận yêu cầu: POST /payments.php
2025-07-03 09:17:42 - Kết nối cơ sở dữ liệu thành công
2025-07-03 09:17:42 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":1990000,"orderDate":"2025-07-03T02:17:42.159Z"}
2025-07-03 09:17:42 - Chuyển đổi ngay_dat_hang: 2025-07-03T02:17:42.159Z thành 2025-07-03 02:17:42
2025-07-03 09:17:42 - Xác thực đầu vào thành công
2025-07-03 09:17:42 - Tạo địa chỉ giao hàng mới với ID: 68 cho pickup
2025-07-03 09:17:42 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '68', '1990000', 'Chờ xử lý', '2025-07-03 02:17:42', '')
2025-07-03 09:17:42 - Chèn đơn hàng với ID: 75
2025-07-03 09:17:42 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('75', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x1)', '1990000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 09:17:42 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('75', 'cod', '1990000', 'Chưa thanh toán')
2025-07-03 09:17:43 - Giao dịch COD được xác nhận thành công
2025-07-03 09:17:43 - Đóng kết nối cơ sở dữ liệu
2025-07-03 09:20:27 - Nhận yêu cầu: POST /payments.php
2025-07-03 09:20:27 - Kết nối cơ sở dữ liệu thành công
2025-07-03 09:20:27 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":1990000,"orderDate":"2025-07-03T02:20:27.160Z"}
2025-07-03 09:20:27 - Chuyển đổi ngay_dat_hang: 2025-07-03T02:20:27.160Z thành 2025-07-03 02:20:27
2025-07-03 09:20:27 - Xác thực đầu vào thành công
2025-07-03 09:20:27 - Tạo địa chỉ giao hàng mới với ID: 69 cho pickup
2025-07-03 09:20:27 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '69', '1990000', 'Chờ xử lý', '2025-07-03 02:20:27', '')
2025-07-03 09:20:27 - Chèn đơn hàng với ID: 76
2025-07-03 09:20:27 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('76', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x1)', '1990000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 09:20:27 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('76', 'cod', '1990000', 'Chưa thanh toán')
2025-07-03 09:20:27 - Giao dịch COD được xác nhận thành công
2025-07-03 09:20:27 - Đóng kết nối cơ sở dữ liệu
2025-07-03 09:52:54 - Nhận yêu cầu: POST /payments.php
2025-07-03 09:52:54 - Kết nối cơ sở dữ liệu thành công
2025-07-03 09:52:54 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":1990000,"orderDate":"2025-07-03T02:52:53.826Z"}
2025-07-03 09:52:54 - Chuyển đổi ngay_dat_hang: 2025-07-03T02:52:53.826Z thành 2025-07-03 02:52:53
2025-07-03 09:52:54 - Xác thực đầu vào thành công
2025-07-03 09:52:54 - Tạo địa chỉ giao hàng mới với ID: 70 cho pickup
2025-07-03 09:52:54 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '70', '1990000', 'Chờ xử lý', '2025-07-03 02:52:53', '')
2025-07-03 09:52:54 - Chèn đơn hàng với ID: 77
2025-07-03 09:52:54 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('77', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x1)', '1990000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 09:52:54 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('77', 'cod', '1990000', 'Chưa thanh toán')
2025-07-03 09:52:54 - Giao dịch COD được xác nhận thành công
2025-07-03 09:52:54 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:06:50 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:06:50 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:06:50 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":1990000,"orderDate":"2025-07-03T03:06:50.506Z"}
2025-07-03 10:06:50 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:06:50.506Z thành 2025-07-03 03:06:50
2025-07-03 10:06:50 - Xác thực đầu vào thành công
2025-07-03 10:06:50 - Tạo địa chỉ giao hàng mới với ID: 71 cho pickup
2025-07-03 10:06:51 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '71', '1990000', 'Chờ xử lý', '2025-07-03 03:06:50', '')
2025-07-03 10:06:51 - Chèn đơn hàng với ID: 78
2025-07-03 10:06:51 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('78', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x1)', '1990000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:06:51 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('78', 'cod', '1990000', 'Chưa thanh toán')
2025-07-03 10:06:51 - Giao dịch COD được xác nhận thành công
2025-07-03 10:06:51 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:08:11 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:08:11 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:08:11 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":1990000,"orderDate":"2025-07-03T03:08:10.878Z"}
2025-07-03 10:08:11 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:08:10.878Z thành 2025-07-03 03:08:10
2025-07-03 10:08:11 - Xác thực đầu vào thành công
2025-07-03 10:08:11 - Tạo địa chỉ giao hàng mới với ID: 72 cho pickup
2025-07-03 10:08:11 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '72', '1990000', 'Chờ xử lý', '2025-07-03 03:08:10', '')
2025-07-03 10:08:11 - Chèn đơn hàng với ID: 79
2025-07-03 10:08:11 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('79', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x1)', '1990000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:08:11 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('79', 'cod', '1990000', 'Chưa thanh toán')
2025-07-03 10:08:11 - Giao dịch COD được xác nhận thành công
2025-07-03 10:08:11 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:09:39 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:09:39 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:09:39 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":58,"ten":"Ổ cứng di động Transcend ESD410C 2000MB/s 1TB","gia":2390000,"so_luong":3,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":7170000,"orderDate":"2025-07-03T03:09:38.541Z"}
2025-07-03 10:09:39 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:09:38.541Z thành 2025-07-03 03:09:38
2025-07-03 10:09:39 - Xác thực đầu vào thành công
2025-07-03 10:09:39 - Tạo địa chỉ giao hàng mới với ID: 73 cho pickup
2025-07-03 10:09:39 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '73', '7170000', 'Chờ xử lý', '2025-07-03 03:09:38', '')
2025-07-03 10:09:39 - Chèn đơn hàng với ID: 80
2025-07-03 10:09:39 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('80', 'Admin', 'Ổ cứng di động Transcend ESD410C 2000MB/s 1TB (x3)', '7170000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:09:39 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('80', 'cod', '7170000', 'Chưa thanh toán')
2025-07-03 10:09:39 - Giao dịch COD được xác nhận thành công
2025-07-03 10:09:39 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:11:46 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:11:46 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:11:46 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":3,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":5970000,"orderDate":"2025-07-03T03:11:44.798Z"}
2025-07-03 10:11:46 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:11:44.798Z thành 2025-07-03 03:11:44
2025-07-03 10:11:46 - Xác thực đầu vào thành công
2025-07-03 10:11:46 - Tạo địa chỉ giao hàng mới với ID: 74 cho pickup
2025-07-03 10:11:46 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '74', '5970000', 'Chờ xử lý', '2025-07-03 03:11:44', '')
2025-07-03 10:11:46 - Chèn đơn hàng với ID: 81
2025-07-03 10:11:46 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('81', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x3)', '5970000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:11:46 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('81', 'cod', '5970000', 'Chưa thanh toán')
2025-07-03 10:11:46 - Giao dịch COD được xác nhận thành công
2025-07-03 10:11:46 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:14:10 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:14:10 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:14:10 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":3,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":5970000,"orderDate":"2025-07-03T03:14:10.405Z"}
2025-07-03 10:14:10 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:14:10.405Z thành 2025-07-03 03:14:10
2025-07-03 10:14:10 - Xác thực đầu vào thành công
2025-07-03 10:14:10 - Tạo địa chỉ giao hàng mới với ID: 75 cho pickup
2025-07-03 10:14:10 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '75', '5970000', 'Chờ xử lý', '2025-07-03 03:14:10', '')
2025-07-03 10:14:10 - Chèn đơn hàng với ID: 82
2025-07-03 10:14:10 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('82', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x3)', '5970000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:14:10 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('82', 'cod', '5970000', 'Chưa thanh toán')
2025-07-03 10:14:10 - Giao dịch COD được xác nhận thành công
2025-07-03 10:14:10 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:17:09 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:17:09 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:17:09 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":3,"loai":"GPU"}],"customerInfo":{"fullName":"Admin","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":329970000,"orderDate":"2025-07-03T03:17:09.250Z"}
2025-07-03 10:17:09 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:17:09.250Z thành 2025-07-03 03:17:09
2025-07-03 10:17:09 - Xác thực đầu vào thành công
2025-07-03 10:17:09 - Tạo địa chỉ giao hàng mới với ID: 76 cho pickup
2025-07-03 10:17:09 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '76', '329970000', 'Chờ xử lý', '2025-07-03 03:17:09', '')
2025-07-03 10:17:09 - Chèn đơn hàng với ID: 83
2025-07-03 10:17:09 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('83', 'Admin', 'VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x3)', '329970000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:17:09 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('83', 'cod', '329970000', 'Chưa thanh toán')
2025-07-03 10:17:09 - Giao dịch COD được xác nhận thành công
2025-07-03 10:17:09 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:22:58 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:22:58 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:22:58 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":2,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":3980000,"orderDate":"2025-07-03T03:22:57.445Z"}
2025-07-03 10:22:58 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:22:57.445Z thành 2025-07-03 03:22:57
2025-07-03 10:22:58 - Xác thực đầu vào thành công
2025-07-03 10:22:58 - Tạo địa chỉ giao hàng mới với ID: 77 cho pickup
2025-07-03 10:22:58 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '77', '3980000', 'Chờ xử lý', '2025-07-03 03:22:57', '')
2025-07-03 10:22:58 - Chèn đơn hàng với ID: 84
2025-07-03 10:22:58 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('84', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x2)', '3980000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:22:58 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('84', 'cod', '3980000', 'Chưa thanh toán')
2025-07-03 10:22:58 - Giao dịch COD được xác nhận thành công
2025-07-03 10:22:58 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:27:13 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:27:13 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:27:13 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":2,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":3980000,"orderDate":"2025-07-03T03:27:13.377Z"}
2025-07-03 10:27:13 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:27:13.377Z thành 2025-07-03 03:27:13
2025-07-03 10:27:13 - Xác thực đầu vào thành công
2025-07-03 10:27:13 - Tạo địa chỉ giao hàng mới với ID: 78 cho pickup
2025-07-03 10:27:13 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '78', '3980000', 'Chờ xử lý', '2025-07-03 03:27:13', '')
2025-07-03 10:27:13 - Chèn đơn hàng với ID: 85
2025-07-03 10:27:13 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('85', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x2)', '3980000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:27:13 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('85', 'cod', '3980000', 'Chưa thanh toán')
2025-07-03 10:27:14 - Giao dịch COD được xác nhận thành công
2025-07-03 10:27:14 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:37:54 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:37:54 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:37:54 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":3,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":5970000,"orderDate":"2025-07-03T03:37:54.379Z"}
2025-07-03 10:37:54 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:37:54.379Z thành 2025-07-03 03:37:54
2025-07-03 10:37:54 - Xác thực đầu vào thành công
2025-07-03 10:37:54 - Tạo địa chỉ giao hàng mới với ID: 79 cho pickup
2025-07-03 10:37:54 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '79', '5970000', 'Chờ xử lý', '2025-07-03 03:37:54', '')
2025-07-03 10:37:54 - Chèn đơn hàng với ID: 86
2025-07-03 10:37:54 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('86', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x3)', '5970000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:37:54 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('86', 'cod', '5970000', 'Chưa thanh toán')
2025-07-03 10:37:54 - Giao dịch COD được xác nhận thành công
2025-07-03 10:37:54 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:38:39 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:38:39 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:38:39 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":3,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"hoa@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":5970000,"orderDate":"2025-07-03T03:38:39.130Z"}
2025-07-03 10:38:39 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:38:39.130Z thành 2025-07-03 03:38:39
2025-07-03 10:38:39 - Xác thực đầu vào thành công
2025-07-03 10:38:39 - Tạo địa chỉ giao hàng mới với ID: 80 cho pickup
2025-07-03 10:38:39 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '80', '5970000', 'Chờ xử lý', '2025-07-03 03:38:39', '')
2025-07-03 10:38:39 - Chèn đơn hàng với ID: 87
2025-07-03 10:38:39 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('87', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x3)', '5970000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:38:39 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('87', 'cod', '5970000', 'Chưa thanh toán')
2025-07-03 10:38:39 - Giao dịch COD được xác nhận thành công
2025-07-03 10:38:39 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:40:34 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:40:34 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:40:34 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":2,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":3980000,"orderDate":"2025-07-03T03:40:33.870Z"}
2025-07-03 10:40:34 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:40:33.870Z thành 2025-07-03 03:40:33
2025-07-03 10:40:34 - Xác thực đầu vào thành công
2025-07-03 10:40:34 - Tạo địa chỉ giao hàng mới với ID: 81 cho pickup
2025-07-03 10:40:34 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '81', '3980000', 'Chờ xử lý', '2025-07-03 03:40:33', '')
2025-07-03 10:40:34 - Chèn đơn hàng với ID: 88
2025-07-03 10:40:34 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('88', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x2)', '3980000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:40:34 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('88', 'cod', '3980000', 'Chưa thanh toán')
2025-07-03 10:40:34 - Giao dịch COD được xác nhận thành công
2025-07-03 10:40:34 - Đóng kết nối cơ sở dữ liệu
2025-07-03 10:51:43 - Nhận yêu cầu: POST /payments.php
2025-07-03 10:51:43 - Kết nối cơ sở dữ liệu thành công
2025-07-03 10:51:43 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":3,"loai":"storage"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":5970000,"orderDate":"2025-07-03T03:51:43.497Z"}
2025-07-03 10:51:43 - Chuyển đổi ngay_dat_hang: 2025-07-03T03:51:43.497Z thành 2025-07-03 03:51:43
2025-07-03 10:51:43 - Xác thực đầu vào thành công
2025-07-03 10:51:43 - Tạo địa chỉ giao hàng mới với ID: 82 cho pickup
2025-07-03 10:51:43 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('2', '82', '5970000', 'Chờ xử lý', '2025-07-03 03:51:43', '')
2025-07-03 10:51:43 - Chèn đơn hàng với ID: 89
2025-07-03 10:51:43 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('89', 'Admin', 'Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x3)', '5970000', 'Lấy tại cửa hàng', 'cod')
2025-07-03 10:51:43 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('89', 'cod', '5970000', 'Chưa thanh toán')
2025-07-03 10:51:43 - Giao dịch COD được xác nhận thành công
2025-07-03 10:51:43 - Đóng kết nối cơ sở dữ liệu
2025-07-05 02:16:40 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:16:40 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:16:40 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"unkown","email":"unkown@gmail.com","phone":"7878987909","address":"nhà số 1","city":"Tỉnh Phú Thọ","district":"Huyện Tân Sơn","ward":"Xã Long Cốc","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":109990000,"orderDate":"2025-07-04T19:16:40.545Z"}
2025-07-05 02:16:40 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:16:40.545Z thành 2025-07-04 19:16:40
2025-07-05 02:16:40 - Xác thực đầu vào thành công
2025-07-05 02:16:40 - Tạo địa chỉ giao hàng mới với ID: 1
2025-07-05 02:16:40 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, ngay_dat, ghi_chu)
                 VALUES ('1', '1', '109990000', 'Chờ xử lý', '2025-07-04 19:16:40', '')
2025-07-05 02:16:40 - Lỗi khi xử lý đơn hàng: Unknown column 'ngay_dat' in 'field list'
2025-07-05 02:18:15 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:18:15 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:18:15 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"unkown","email":"unkown@gmail.com","phone":"7878987909","address":"nhà số 1","city":"Tỉnh Phú Thọ","district":"Huyện Tân Sơn","ward":"Xã Xuân Sơn","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":109990000,"orderDate":"2025-07-04T19:18:15.641Z"}
2025-07-05 02:18:15 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:18:15.641Z thành 2025-07-04 19:18:15
2025-07-05 02:18:15 - Xác thực đầu vào thành công
2025-07-05 02:18:15 - Tạo địa chỉ giao hàng mới với ID: 2
2025-07-05 02:18:15 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '2', '109990000', 'Chờ xử lý', '2025-07-04 19:18:15', '')
2025-07-05 02:18:15 - Chèn đơn hàng với ID: 1
2025-07-05 02:18:16 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, ten_nguoi, ten_san_pham, tong_tien, dia_chi, phuong_thuc_thanh_toan)
                   VALUES ('1', 'unkown', 'VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x1)', '109990000', 'nhà số 1, Xã Xuân Sơn, Huyện Tân Sơn, Tỉnh Phú Thọ', 'cod')
2025-07-05 02:18:16 - Lỗi khi xử lý đơn hàng: Unknown column 'ten_nguoi' in 'field list'
2025-07-05 02:20:22 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:20:22 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:20:22 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"unkown","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":109990000,"orderDate":"2025-07-04T19:20:22.369Z"}
2025-07-05 02:20:22 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:20:22.369Z thành 2025-07-04 19:20:22
2025-07-05 02:20:22 - Xác thực đầu vào thành công
2025-07-05 02:20:22 - Tạo địa chỉ giao hàng mới với ID: 3 cho pickup
2025-07-05 02:20:22 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '3', '109990000', 'Chờ xử lý', '2025-07-04 19:20:22', '')
2025-07-05 02:20:22 - Chèn đơn hàng với ID: 2
2025-07-05 02:20:22 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('2', 'Khách: unkown; Sản phẩm: VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x1); Địa chỉ: Lấy tại cửa hàng; Ghi chú: ; Phương thức: cod', '109990000')
2025-07-05 02:20:22 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('2', 'cod', '109990000', 'Chưa thanh toán')
2025-07-05 02:20:22 - Lỗi khi xử lý đơn hàng: Unknown column 'phuong_thuc_thanh_toan' in 'field list'
2025-07-05 02:20:55 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:20:55 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:20:55 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"unkown","email":"unkown@gmail.com","phone":"7878987909","address":"nhà số 1","city":"Tỉnh Hà Giang","district":"Thành phố Hà Giang","ward":"Phường Quang Trung","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":109990000,"orderDate":"2025-07-04T19:20:55.398Z"}
2025-07-05 02:20:55 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:20:55.398Z thành 2025-07-04 19:20:55
2025-07-05 02:20:55 - Xác thực đầu vào thành công
2025-07-05 02:20:55 - Tạo địa chỉ giao hàng mới với ID: 4
2025-07-05 02:20:55 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '4', '109990000', 'Chờ xử lý', '2025-07-04 19:20:55', '')
2025-07-05 02:20:55 - Chèn đơn hàng với ID: 3
2025-07-05 02:20:55 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('3', 'Khách: unkown; Sản phẩm: VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x1); Địa chỉ: nhà số 1, Phường Quang Trung, Thành phố Hà Giang, Tỉnh Hà Giang; Ghi chú: ; Phương thức: cod', '109990000')
2025-07-05 02:20:55 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc_thanh_toan, tong_so_tien, trang_thai_thanh_toan)
                   VALUES ('3', 'cod', '109990000', 'Chưa thanh toán')
2025-07-05 02:20:55 - Lỗi khi xử lý đơn hàng: Unknown column 'phuong_thuc_thanh_toan' in 'field list'
2025-07-05 02:22:09 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:22:09 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:22:09 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"unkown","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":109990000,"orderDate":"2025-07-04T19:22:09.338Z"}
2025-07-05 02:22:09 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:22:09.338Z thành 2025-07-04 19:22:09
2025-07-05 02:22:09 - Xác thực đầu vào thành công
2025-07-05 02:22:09 - Tạo địa chỉ giao hàng mới với ID: 5 cho pickup
2025-07-05 02:22:09 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '5', '109990000', 'Chờ xử lý', '2025-07-04 19:22:09', '')
2025-07-05 02:22:09 - Chèn đơn hàng với ID: 4
2025-07-05 02:22:09 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('4', 'Khách: unkown; Sản phẩm: VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x1); Địa chỉ: Lấy tại cửa hàng; Ghi chú: ; Phương thức: cod', '109990000')
2025-07-05 02:22:09 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('4', 'cod', '109990000', 'Chưa thanh toán')
2025-07-05 02:22:09 - Giao dịch COD được xác nhận thành công
2025-07-05 02:22:09 - Đóng kết nối cơ sở dữ liệu
2025-07-05 02:27:34 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:27:34 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:27:34 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":15,"ten":"CPU Intel Core i5 12400F","gia":2890000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"unkown","email":"unkown@gmail.com","phone":"7878987909","address":"nhà số 1","city":"Tỉnh Hà Giang","district":"Huyện Xín Mần","ward":"Xã Nấm Dẩn","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":2890000,"orderDate":"2025-07-04T19:27:33.956Z"}
2025-07-05 02:27:34 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:27:33.956Z thành 2025-07-04 19:27:33
2025-07-05 02:27:34 - Xác thực đầu vào thành công
2025-07-05 02:27:34 - Tạo địa chỉ giao hàng mới với ID: 6
2025-07-05 02:27:34 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '6', '2890000', 'Chờ xử lý', '2025-07-04 19:27:33', '')
2025-07-05 02:27:34 - Chèn đơn hàng với ID: 5
2025-07-05 02:27:34 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('5', '15', '1', '2890000', '0')
2025-07-05 02:27:34 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('5', 'Khách: unkown; Sản phẩm: CPU Intel Core i5 12400F (x1); Địa chỉ: nhà số 1, Xã Nấm Dẩn, Huyện Xín Mần, Tỉnh Hà Giang; Ghi chú: ; Phương thức: cod', '2890000')
2025-07-05 02:27:34 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('5', 'cod', '2890000', 'Chưa thanh toán')
2025-07-05 02:27:34 - Giao dịch COD được xác nhận thành công
2025-07-05 02:27:34 - Đóng kết nối cơ sở dữ liệu
2025-07-05 02:31:37 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:31:37 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:31:37 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":44,"ten":"Mainboard Gigabyte B760M Gaming Plus Wifi D4","gia":3190000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"unkown","email":"unkown@gmail.com","phone":"7878987909","address":"17 đường 18 ngọc trà 2","city":"Tỉnh Thanh Hóa","district":"Thành phố Thanh Hóa","ward":"Phường Quảng Thắng","note":""},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":3190000,"orderDate":"2025-07-04T19:31:37.557Z"}
2025-07-05 02:31:37 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:31:37.557Z thành 2025-07-04 19:31:37
2025-07-05 02:31:37 - Xác thực đầu vào thành công
2025-07-05 02:31:37 - Tạo địa chỉ giao hàng mới với ID: 7
2025-07-05 02:31:37 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '7', '3190000', '0', 'Chờ xử lý', '2025-07-04 19:31:37', '')
2025-07-05 02:31:37 - Chèn đơn hàng với ID: 6
2025-07-05 02:31:37 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('6', '44', '1', '3190000', '0')
2025-07-05 02:31:37 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('6', 'Khách: unkown; Sản phẩm: Mainboard Gigabyte B760M Gaming Plus Wifi D4 (x1); Địa chỉ: 17 đường 18 ngọc trà 2, Phường Quảng Thắng, Thành phố Thanh Hóa, Tỉnh Thanh Hóa; Ghi chú: ; Phương thức: cod', '3190000')
2025-07-05 02:31:38 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('6', 'cod', '3190000', 'Chưa thanh toán')
2025-07-05 02:31:38 - Giao dịch COD được xác nhận thành công
2025-07-05 02:31:38 - Đóng kết nối cơ sở dữ liệu
2025-07-05 02:35:29 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:35:29 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:35:29 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":5,"ten":"RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8","gia":650000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"unkown","email":"unkown@gmail.com","phone":"7878987909","address":"17 đường 18 ngọc trà 2","city":"Tỉnh Thanh Hóa","district":"Thành phố Sầm Sơn","ward":"Phường Quảng Cư","note":""},"paymentMethod":"cod","shippingMethod":"ship","shippingCost":30000,"totalAmount":650000,"orderDate":"2025-07-04T19:35:28.987Z"}
2025-07-05 02:35:29 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:35:28.987Z thành 2025-07-04 19:35:28
2025-07-05 02:35:29 - Xác thực đầu vào thành công
2025-07-05 02:35:29 - Tạo địa chỉ giao hàng mới với ID: 8
2025-07-05 02:35:29 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '8', '680000', '30000', 'Chờ xử lý', '2025-07-04 19:35:28', '')
2025-07-05 02:35:29 - Chèn đơn hàng với ID: 7
2025-07-05 02:35:29 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('7', '5', '1', '650000', '0')
2025-07-05 02:35:29 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('7', 'Khách: unkown; Sản phẩm: RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8 (x1); Địa chỉ: 17 đường 18 ngọc trà 2, Phường Quảng Cư, Thành phố Sầm Sơn, Tỉnh Thanh Hóa; Ghi chú: ; Phương thức: cod', '680000')
2025-07-05 02:35:29 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('7', 'cod', '680000', 'Chưa thanh toán')
2025-07-05 02:35:29 - Giao dịch COD được xác nhận thành công
2025-07-05 02:35:29 - Đóng kết nối cơ sở dữ liệu
2025-07-05 02:37:19 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:37:19 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:37:19 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":5,"ten":"RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8","gia":650000,"so_luong":8,"loai":"Linh kiện"}],"customerInfo":{"fullName":"unkown","email":"ubuntu20.04.2@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","shippingCost":0,"totalAmount":5200000,"orderDate":"2025-07-04T19:37:19.613Z"}
2025-07-05 02:37:19 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:37:19.613Z thành 2025-07-04 19:37:19
2025-07-05 02:37:19 - Xác thực đầu vào thành công
2025-07-05 02:37:19 - Tạo địa chỉ giao hàng mới với ID: 9 cho pickup
2025-07-05 02:37:19 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '9', '5200000', '0', 'Chờ xử lý', '2025-07-04 19:37:19', '')
2025-07-05 02:37:19 - Chèn đơn hàng với ID: 8
2025-07-05 02:37:19 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('8', '5', '8', '650000', '0')
2025-07-05 02:37:20 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('8', 'Khách: unkown; Sản phẩm: RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8 (x8); Địa chỉ: Lấy tại cửa hàng; Ghi chú: ; Phương thức: cod', '5200000')
2025-07-05 02:37:20 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('8', 'cod', '5200000', 'Chưa thanh toán')
2025-07-05 02:37:20 - Giao dịch COD được xác nhận thành công
2025-07-05 02:37:20 - Đóng kết nối cơ sở dữ liệu
2025-07-05 02:45:15 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:45:15 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:45:15 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":5,"ten":"RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8","gia":650000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"Admin","email":"ubuntu20.04.2@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","shippingCost":0,"totalAmount":650000,"orderDate":"2025-07-04T19:45:15.318Z"}
2025-07-05 02:45:15 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:45:15.318Z thành 2025-07-04 19:45:15
2025-07-05 02:45:15 - Xác thực đầu vào thành công
2025-07-05 02:45:15 - Tạo địa chỉ giao hàng mới với ID: 10 cho pickup
2025-07-05 02:45:15 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('2', '10', '650000', '0', 'Chờ xử lý', '2025-07-04 19:45:15', '')
2025-07-05 02:45:15 - Chèn đơn hàng với ID: 9
2025-07-05 02:45:15 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('9', '5', '1', '650000', '0')
2025-07-05 02:45:15 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('9', 'Khách: Admin; Sản phẩm: RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8 (x1); Địa chỉ: Lấy tại cửa hàng; Ghi chú: ; Phương thức: vnpay', '650000')
2025-07-05 02:45:15 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('9', 'vnpay', '650000', 'Chưa thanh toán')
2025-07-05 02:45:15 - Chuỗi truy vấn VNPay: vnp_Amount=65000000&vnp_Command=pay&vnp_CreateDate=20250705024515&vnp_CurrCode=VND&vnp_ExpireDate=20250705031515&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+9&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%3A8080%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=9&vnp_Version=2.1.0&
2025-07-05 02:45:15 - Dữ liệu băm VNPay: vnp_Amount=65000000&vnp_Command=pay&vnp_CreateDate=20250705024515&vnp_CurrCode=VND&vnp_ExpireDate=20250705031515&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+9&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%3A8080%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=9&vnp_Version=2.1.0
2025-07-05 02:45:15 - Hash VNPay được tạo: 97aef2466192b2d6d9506f7dde9df56b42f5087614c695c12cc23396890b66834a0cfab511ff24114c4e45c715589f7b079556f7f0c0d3489b47e954c5282d93
2025-07-05 02:45:15 - Khởi tạo thanh toán VNPay cho đơn hàng 9: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=65000000&vnp_Command=pay&vnp_CreateDate=20250705024515&vnp_CurrCode=VND&vnp_ExpireDate=20250705031515&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+9&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%3A8080%2Fpayments.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=9&vnp_Version=2.1.0&vnp_SecureHash=97aef2466192b2d6d9506f7dde9df56b42f5087614c695c12cc23396890b66834a0cfab511ff24114c4e45c715589f7b079556f7f0c0d3489b47e954c5282d93
2025-07-05 02:46:16 - Nhận yêu cầu: GET /payments.php?vnp_Amount=65000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP15056659&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+9&vnp_PayDate=20250705024701&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=15056659&vnp_TransactionStatus=00&vnp_TxnRef=9&vnp_SecureHash=45f1bed384860e1461c4a6968e161720ddf45743b3c7754bbc68780cb341ea2f837ed0c22bcb9cfb32abab91d7b9594d3a6667260ad7b9670d37a4de8470148e
2025-07-05 02:46:16 - --------- Gỡ lỗi Callback VNPay ---------
2025-07-05 02:46:16 - Tất cả tham số GET: {"vnp_Amount":"65000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15056659","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 9","vnp_PayDate":"20250705024701","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15056659","vnp_TransactionStatus":"00","vnp_TxnRef":"9","vnp_SecureHash":"45f1bed384860e1461c4a6968e161720ddf45743b3c7754bbc68780cb341ea2f837ed0c22bcb9cfb32abab91d7b9594d3a6667260ad7b9670d37a4de8470148e"}
2025-07-05 02:46:16 - vnp_SecureHash nhận được: 45f1bed384860e1461c4a6968e161720ddf45743b3c7754bbc68780cb341ea2f837ed0c22bcb9cfb32abab91d7b9594d3a6667260ad7b9670d37a4de8470148e
2025-07-05 02:46:16 - inputData sau khi sắp xếp: {"vnp_Amount":"65000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15056659","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 9","vnp_PayDate":"20250705024701","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15056659","vnp_TransactionStatus":"00","vnp_TxnRef":"9"}
2025-07-05 02:46:16 - Chuỗi hashData: vnp_Amount=65000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP15056659&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+9&vnp_PayDate=20250705024701&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=15056659&vnp_TransactionStatus=00&vnp_TxnRef=9
2025-07-05 02:46:16 - secureHash được tạo: 45f1bed384860e1461c4a6968e161720ddf45743b3c7754bbc68780cb341ea2f837ed0c22bcb9cfb32abab91d7b9594d3a6667260ad7b9670d37a4de8470148e
2025-07-05 02:46:16 - Khớp hash: Có
2025-07-05 02:52:15 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:52:15 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:52:15 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":5,"ten":"RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8","gia":650000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"Admin","email":"ubuntu20.04.2@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","shippingCost":0,"totalAmount":650000,"orderDate":"2025-07-04T19:52:15.434Z"}
2025-07-05 02:52:15 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:52:15.434Z thành 2025-07-04 19:52:15
2025-07-05 02:52:15 - Xác thực đầu vào thành công
2025-07-05 02:52:15 - Tạo địa chỉ giao hàng mới với ID: 11 cho pickup
2025-07-05 02:52:15 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('2', '11', '650000', '0', 'Chờ xử lý', '2025-07-04 19:52:15', '')
2025-07-05 02:52:15 - Chèn đơn hàng với ID: 10
2025-07-05 02:52:15 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('10', '5', '1', '650000', '0')
2025-07-05 02:52:15 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('10', 'Khách: Admin; Sản phẩm: RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8 (x1); Địa chỉ: Lấy tại cửa hàng; Ghi chú: ; Phương thức: vnpay', '650000')
2025-07-05 02:52:15 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('10', 'vnpay', '650000', 'Chưa thanh toán')
2025-07-05 02:52:15 - Đơn hàng VNPay đã tạo, trả về orderId để frontend tự gọi sang vnpay_create.php
2025-07-05 02:54:22 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:54:22 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:54:22 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":5,"ten":"RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8","gia":650000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"17 đường 18 ngọc trà 2","city":"Tỉnh Thanh Hóa","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","shippingCost":0,"totalAmount":650000,"orderDate":"2025-07-04T19:54:22.081Z"}
2025-07-05 02:54:22 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:54:22.081Z thành 2025-07-04 19:54:22
2025-07-05 02:54:22 - Xác thực đầu vào thành công
2025-07-05 02:54:22 - Tạo địa chỉ giao hàng mới với ID: 12 cho pickup
2025-07-05 02:54:22 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('2', '12', '650000', '0', 'Chờ xử lý', '2025-07-04 19:54:22', '')
2025-07-05 02:54:22 - Chèn đơn hàng với ID: 11
2025-07-05 02:54:22 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('11', '5', '1', '650000', '0')
2025-07-05 02:54:22 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('11', 'Khách: Admin; Sản phẩm: RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8 (x1); Địa chỉ: Lấy tại cửa hàng; Ghi chú: ; Phương thức: vnpay', '650000')
2025-07-05 02:54:22 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('11', 'vnpay', '650000', 'Chưa thanh toán')
2025-07-05 02:54:22 - Đơn hàng VNPay đã tạo, trả về orderId để frontend tự gọi sang vnpay_create.php
2025-07-05 02:55:21 - Nhận yêu cầu: POST /payments.php
2025-07-05 02:55:21 - Kết nối cơ sở dữ liệu thành công
2025-07-05 02:55:21 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":5,"ten":"RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8","gia":650000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"17 đường 18 ngọc trà 2","city":"Tỉnh Thanh Hóa","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","shippingCost":0,"totalAmount":650000,"orderDate":"2025-07-04T19:55:21.555Z"}
2025-07-05 02:55:21 - Chuyển đổi ngay_dat_hang: 2025-07-04T19:55:21.555Z thành 2025-07-04 19:55:21
2025-07-05 02:55:21 - Xác thực đầu vào thành công
2025-07-05 02:55:21 - Tạo địa chỉ giao hàng mới với ID: 13 cho pickup
2025-07-05 02:55:21 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('2', '13', '650000', '0', 'Chờ xử lý', '2025-07-04 19:55:21', '')
2025-07-05 02:55:21 - Chèn đơn hàng với ID: 12
2025-07-05 02:55:21 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('12', '5', '1', '650000', '0')
2025-07-05 02:55:21 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('12', 'Khách: Admin; Sản phẩm: RAM Laptop Kingston 1.2V 8GB 3200MHz KVR32S22S8/8 (x1); Địa chỉ: Lấy tại cửa hàng; Ghi chú: ; Phương thức: vnpay', '650000')
2025-07-05 02:55:21 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('12', 'vnpay', '650000', 'Chưa thanh toán')
2025-07-05 02:55:22 - Đơn hàng VNPay đã tạo, trả về orderId để frontend tự gọi sang vnpay_create.php
2025-07-05 02:55:22 - Khởi tạo thanh toán VNPay cho đơn hàng 12: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=65000000&vnp_Command=pay&vnp_CreateDate=20250705025522&vnp_CurrCode=VND&vnp_ExpireDate=20250705032522&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+12&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%3A8080%2Fvnpay_callback.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=12&vnp_Version=2.1.0&vnp_SecureHash=bff1f84acdde99e2d04bb1dd5eb18f229d2a56c56f5c86f27e3f845461a467889d132b8a8ead964806fd815b4fda026544cc40926adb325931a431724d524629
2025-07-05 02:55:54 - --------- Gỡ lỗi Callback VNPay ---------
2025-07-05 02:55:54 - Tất cả tham số GET: {"vnp_Amount":"65000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15056660","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 12","vnp_PayDate":"20250705025640","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15056660","vnp_TransactionStatus":"00","vnp_TxnRef":"12","vnp_SecureHash":"4ff2cc6475f6dedd08b53b2a6320cc7aa99fedc70cbec24cd8a99b804e76a35cf596bfab131d9e84140afa7484a76ec393fe49e4aa9dc6b9007fb6642abf451b"}
2025-07-05 02:55:54 - vnp_SecureHash nhận được: 4ff2cc6475f6dedd08b53b2a6320cc7aa99fedc70cbec24cd8a99b804e76a35cf596bfab131d9e84140afa7484a76ec393fe49e4aa9dc6b9007fb6642abf451b
2025-07-05 02:55:54 - inputData sau khi sắp xếp: {"vnp_Amount":"65000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15056660","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 12","vnp_PayDate":"20250705025640","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15056660","vnp_TransactionStatus":"00","vnp_TxnRef":"12"}
2025-07-05 02:55:54 - Chuỗi hashData: vnp_Amount=65000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP15056660&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+12&vnp_PayDate=20250705025640&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=15056660&vnp_TransactionStatus=00&vnp_TxnRef=12
2025-07-05 02:55:54 - secureHash được tạo: 4ff2cc6475f6dedd08b53b2a6320cc7aa99fedc70cbec24cd8a99b804e76a35cf596bfab131d9e84140afa7484a76ec393fe49e4aa9dc6b9007fb6642abf451b
2025-07-05 02:55:54 - Khớp hash: Có
2025-07-05 02:55:54 - Trạng thái thanh toán được cập nhật cho đơn hàng 12: Đã thanh toán
2025-07-05 02:55:54 - Cập nhật trạng thái đơn hàng 12 thành 'Đã thanh toán'
2025-07-05 03:25:12 - Nhận yêu cầu: POST /payments.php
2025-07-05 03:25:12 - Kết nối cơ sở dữ liệu thành công
2025-07-05 03:25:12 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","shippingCost":0,"totalAmount":1990000,"orderDate":"2025-07-04T20:25:12.520Z"}
2025-07-05 03:25:12 - Chuyển đổi ngay_dat_hang: 2025-07-04T20:25:12.520Z thành 2025-07-04 20:25:12
2025-07-05 03:25:12 - Xác thực đầu vào thành công
2025-07-05 03:25:12 - Tạo địa chỉ giao hàng mới với ID: 14 cho pickup
2025-07-05 03:25:12 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('2', '14', '1990000', '0', 'Chờ xử lý', '2025-07-04 20:25:12', '')
2025-07-05 03:25:12 - Chèn đơn hàng với ID: 13
2025-07-05 03:25:12 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('13', '1', '1', '1990000', '0')
2025-07-05 03:25:12 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('13', 'Khách: Admin; Sản phẩm: Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x1); Địa chỉ: Lấy tại cửa hàng; Ghi chú: ; Phương thức: cod', '1990000')
2025-07-05 03:25:12 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('13', 'cod', '1990000', 'Chưa thanh toán')
2025-07-05 03:25:12 - Giao dịch COD được xác nhận thành công
2025-07-05 03:25:12 - Đóng kết nối cơ sở dữ liệu
2025-07-05 11:18:26 - Nhận yêu cầu: POST /payments.php
2025-07-05 11:18:26 - Kết nối cơ sở dữ liệu thành công
2025-07-05 11:18:26 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"Admin","email":"unkown@gmail.com","phone":"7878987909","address":"17 đường 18 ngọc trà 2","city":"Tỉnh Thanh Hóa","district":"Thành phố Sầm Sơn","ward":"Phường Trung Sơn","note":""},"paymentMethod":"cod","shippingMethod":"ship","shippingCost":0,"totalAmount":109990000,"orderDate":"2025-07-05T04:18:26.041Z"}
2025-07-05 11:18:26 - Chuyển đổi ngay_dat_hang: 2025-07-05T04:18:26.041Z thành 2025-07-05 04:18:26
2025-07-05 11:18:26 - Xác thực đầu vào thành công
2025-07-05 11:18:26 - Tạo địa chỉ giao hàng mới với ID: 15
2025-07-05 11:18:26 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('2', '15', '109990000', '0', 'Chờ xử lý', '2025-07-05 04:18:26', '')
2025-07-05 11:18:26 - Chèn đơn hàng với ID: 14
2025-07-05 11:18:26 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('14', '2', '1', '109990000', '0')
2025-07-05 11:18:26 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('14', 'Khách: Admin; Sản phẩm: VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x1); Địa chỉ: 17 đường 18 ngọc trà 2, Phường Trung Sơn, Thành phố Sầm Sơn, Tỉnh Thanh Hóa; Ghi chú: ; Phương thức: cod', '109990000')
2025-07-05 11:18:26 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('14', 'cod', '109990000', 'Chưa thanh toán')
2025-07-05 11:18:26 - Giao dịch COD được xác nhận thành công
2025-07-05 11:18:26 - Đóng kết nối cơ sở dữ liệu
2025-07-05 12:41:34 - Nhận yêu cầu: POST /payments.php
2025-07-05 12:41:34 - Kết nối cơ sở dữ liệu thành công
2025-07-05 12:41:34 - Dữ liệu thô: {"userId":"2","cartItems":[{"id":4,"ten":"Ổ cứng di động SSD Transcend ESD310C 1050MB/s 128GB","gia":650000,"so_luong":3,"loai":"Linh kiện"},{"id":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":2,"loai":"Linh kiện"}],"customerInfo":{"fullName":"Admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Huyện Mê Linh","ward":"Xã Tự Lập","note":"giao hàng gấp"},"paymentMethod":"cod","shippingMethod":"ship","shippingCost":0,"totalAmount":221930000,"orderDate":"2025-07-05T05:41:34.860Z"}
2025-07-05 12:41:34 - Chuyển đổi ngay_dat_hang: 2025-07-05T05:41:34.860Z thành 2025-07-05 05:41:34
2025-07-05 12:41:35 - Xác thực đầu vào thành công
2025-07-05 12:41:35 - Tạo địa chỉ giao hàng mới với ID: 16
2025-07-05 12:41:35 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('2', '16', '221930000', '0', 'Chờ xử lý', '2025-07-05 05:41:34', 'giao hàng gấp')
2025-07-05 12:41:35 - Chèn đơn hàng với ID: 15
2025-07-05 12:41:35 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('15', '4', '3', '650000', '0')
2025-07-05 12:41:35 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('15', '2', '2', '109990000', '0')
2025-07-05 12:41:35 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('15', 'Khách: Admin; Sản phẩm: Ổ cứng di động SSD Transcend ESD310C 1050MB/s 128GB (x3), VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x2); Địa chỉ: nhà số 1, Xã Tự Lập, Huyện Mê Linh, Thành phố Hà Nội; Ghi chú: giao hàng gấp; Phương thức: cod', '221930000')
2025-07-05 12:41:35 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('15', 'cod', '221930000', 'Chưa thanh toán')
2025-07-05 12:41:35 - Giao dịch COD được xác nhận thành công
2025-07-05 12:41:35 - Đóng kết nối cơ sở dữ liệu
2025-07-06 16:34:39 - Nhận yêu cầu: POST /payments.php
2025-07-06 16:34:39 - Kết nối cơ sở dữ liệu thành công
2025-07-06 16:34:39 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Quận Ba Đình","ward":"Phường Kim Mã","note":""},"paymentMethod":"cod","shippingMethod":"ship","shippingCost":30000,"totalAmount":1990000,"orderDate":"2025-07-06T09:34:39.211Z"}
2025-07-06 16:34:39 - Chuyển đổi ngay_dat_hang: 2025-07-06T09:34:39.211Z thành 2025-07-06 09:34:39
2025-07-06 16:34:39 - Xác thực đầu vào thành công
2025-07-06 16:34:39 - Tạo địa chỉ giao hàng mới với ID: 1
2025-07-06 16:34:39 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '1', '2020000', '30000', 'Chờ xử lý', '2025-07-06 09:34:39', '')
2025-07-06 16:34:39 - Chèn đơn hàng với ID: 1
2025-07-06 16:34:39 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('1', '1', '1', '1990000', '0')
2025-07-06 16:34:39 - Lỗi khi xử lý đơn hàng: Unknown column 'ma_sp' in 'field list'
2025-07-06 16:36:50 - Nhận yêu cầu: POST /payments.php
2025-07-06 16:36:50 - Kết nối cơ sở dữ liệu thành công
2025-07-06 16:36:50 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Quận Ba Đình","ward":"Phường Kim Mã","note":""},"paymentMethod":"cod","shippingMethod":"ship","shippingCost":30000,"totalAmount":1990000,"orderDate":"2025-07-06T09:36:49.955Z"}
2025-07-06 16:36:50 - Chuyển đổi ngay_dat_hang: 2025-07-06T09:36:49.955Z thành 2025-07-06 09:36:49
2025-07-06 16:36:50 - Xác thực đầu vào thành công
2025-07-06 16:36:50 - Tạo địa chỉ giao hàng mới với ID: 2
2025-07-06 16:36:50 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '2', '2020000', '30000', 'Chờ xử lý', '2025-07-06 09:36:49', '')
2025-07-06 16:36:50 - Chèn đơn hàng với ID: 2
2025-07-06 16:36:50 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('2', '1', '1', '1990000', '0')
2025-07-06 16:36:50 - Lỗi khi xử lý đơn hàng: Cannot add or update a child row: a foreign key constraint fails (`form`.`chi_tiet_don_hang`, CONSTRAINT `chi_tiet_don_hang_ibfk_2` FOREIGN KEY (`ma_sp`) REFERENCES `san_pham` (`ma_sp`) ON DELETE CASCADE)
2025-07-06 16:38:08 - Nhận yêu cầu: POST /payments.php
2025-07-06 16:38:08 - Kết nối cơ sở dữ liệu thành công
2025-07-06 16:38:08 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Quận Ba Đình","ward":"Phường Kim Mã","note":""},"paymentMethod":"cod","shippingMethod":"ship","shippingCost":30000,"totalAmount":1990000,"orderDate":"2025-07-06T09:38:07.804Z"}
2025-07-06 16:38:08 - Chuyển đổi ngay_dat_hang: 2025-07-06T09:38:07.804Z thành 2025-07-06 09:38:07
2025-07-06 16:38:08 - Xác thực đầu vào thành công
2025-07-06 16:38:08 - Tạo địa chỉ giao hàng mới với ID: 3
2025-07-06 16:38:08 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '3', '2020000', '30000', 'Chờ xử lý', '2025-07-06 09:38:07', '')
2025-07-06 16:38:08 - Chèn đơn hàng với ID: 3
2025-07-06 16:38:08 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('3', '', '1', '1990000', '0')
2025-07-06 16:38:08 - Lỗi khi xử lý đơn hàng: Cannot add or update a child row: a foreign key constraint fails (`form`.`chi_tiet_don_hang`, CONSTRAINT `chi_tiet_don_hang_ibfk_2` FOREIGN KEY (`ma_sp`) REFERENCES `san_pham` (`ma_sp`) ON DELETE CASCADE)
2025-07-06 16:39:17 - Nhận yêu cầu: POST /payments.php
2025-07-06 16:39:17 - Kết nối cơ sở dữ liệu thành công
2025-07-06 16:39:17 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Quận Ba Đình","ward":"Phường Kim Mã","note":""},"paymentMethod":"cod","shippingMethod":"ship","shippingCost":30000,"totalAmount":1990000,"orderDate":"2025-07-06T09:39:17.010Z"}
2025-07-06 16:39:17 - Chuyển đổi ngay_dat_hang: 2025-07-06T09:39:17.010Z thành 2025-07-06 09:39:17
2025-07-06 16:39:17 - Xác thực đầu vào thành công
2025-07-06 16:39:17 - Tạo địa chỉ giao hàng mới với ID: 4
2025-07-06 16:39:17 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '4', '2020000', '30000', 'Chờ xử lý', '2025-07-06 09:39:17', '')
2025-07-06 16:39:17 - Chèn đơn hàng với ID: 4
2025-07-06 16:39:17 - Lỗi khi xử lý đơn hàng: Mục giỏ hàng tại chỉ số 0 thiếu hoặc sai mã sản phẩm (ma_sp): {"id":1,"ten":"\u1ed4 c\u1ee9ng di \u0111\u1ed9ng SSD ADATA SC750 USB 3.2 Gen 2 1050MB\/s 1TB","gia":1990000,"so_luong":1,"loai":"Linh ki\u1ec7n"}
2025-07-06 16:40:53 - Nhận yêu cầu: POST /payments.php
2025-07-06 16:40:53 - Kết nối cơ sở dữ liệu thành công
2025-07-06 16:40:53 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":1,"ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Quận Ba Đình","ward":"Phường Kim Mã","note":""},"paymentMethod":"cod","shippingMethod":"ship","shippingCost":30000,"totalAmount":1990000,"orderDate":"2025-07-06T09:40:53.861Z"}
2025-07-06 16:40:54 - Chuyển đổi ngay_dat_hang: 2025-07-06T09:40:53.861Z thành 2025-07-06 09:40:53
2025-07-06 16:40:54 - Xác thực đầu vào thành công
2025-07-06 16:40:54 - Tạo địa chỉ giao hàng mới với ID: 5
2025-07-06 16:40:54 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '5', '2020000', '30000', 'Chờ xử lý', '2025-07-06 09:40:53', '')
2025-07-06 16:40:54 - Chèn đơn hàng với ID: 5
2025-07-06 16:40:54 - Lỗi khi xử lý đơn hàng: Mục giỏ hàng tại chỉ số 0 thiếu hoặc sai mã sản phẩm (ma_sp): {"id":1,"ten":"\u1ed4 c\u1ee9ng di \u0111\u1ed9ng SSD ADATA SC750 USB 3.2 Gen 2 1050MB\/s 1TB","gia":1990000,"so_luong":1,"loai":"Linh ki\u1ec7n"}
2025-07-06 16:42:12 - Nhận yêu cầu: POST /payments.php
2025-07-06 16:42:12 - Kết nối cơ sở dữ liệu thành công
2025-07-06 16:42:12 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":1,"ma_sp":"SP00001","ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Quận Ba Đình","ward":"Phường Kim Mã","note":""},"paymentMethod":"cod","shippingMethod":"ship","shippingCost":30000,"totalAmount":1990000,"orderDate":"2025-07-06T09:42:12.902Z"}
2025-07-06 16:42:13 - Chuyển đổi ngay_dat_hang: 2025-07-06T09:42:12.902Z thành 2025-07-06 09:42:12
2025-07-06 16:42:13 - Xác thực đầu vào thành công
2025-07-06 16:42:13 - Tạo địa chỉ giao hàng mới với ID: 6
2025-07-06 16:42:13 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '6', '2020000', '30000', 'Chờ xử lý', '2025-07-06 09:42:12', '')
2025-07-06 16:42:13 - Chèn đơn hàng với ID: 6
2025-07-06 16:42:13 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('6', 'SP00001', '1', '1990000', '0')
2025-07-06 16:42:13 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('6', 'Khách: admin; Sản phẩm: Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x1); Địa chỉ: nhà số 1, Phường Kim Mã, Quận Ba Đình, Thành phố Hà Nội; Ghi chú: ; Phương thức: cod', '2020000')
2025-07-06 16:42:13 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('6', 'cod', '2020000', 'Chưa thanh toán')
2025-07-06 16:42:13 - Giao dịch COD được xác nhận thành công
2025-07-06 16:42:13 - Đóng kết nối cơ sở dữ liệu
2025-07-06 16:44:07 - Nhận yêu cầu: POST /payments.php
2025-07-06 16:44:07 - Kết nối cơ sở dữ liệu thành công
2025-07-06 16:44:07 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":2,"ma_sp":"SP00002","ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Quận Hoàn Kiếm","ward":"Phường Hàng Trống","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","shippingCost":0,"totalAmount":109990000,"orderDate":"2025-07-06T09:44:07.663Z"}
2025-07-06 16:44:07 - Chuyển đổi ngay_dat_hang: 2025-07-06T09:44:07.663Z thành 2025-07-06 09:44:07
2025-07-06 16:44:07 - Xác thực đầu vào thành công
2025-07-06 16:44:07 - Tạo địa chỉ giao hàng mới với ID: 7
2025-07-06 16:44:07 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '7', '109990000', '0', 'Chờ xử lý', '2025-07-06 09:44:07', '')
2025-07-06 16:44:07 - Chèn đơn hàng với ID: 7
2025-07-06 16:44:07 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('7', 'SP00002', '1', '109990000', '0')
2025-07-06 16:44:08 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('7', 'Khách: admin; Sản phẩm: VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x1); Địa chỉ: nhà số 1, Phường Hàng Trống, Quận Hoàn Kiếm, Thành phố Hà Nội; Ghi chú: ; Phương thức: vnpay', '109990000')
2025-07-06 16:44:08 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('7', 'vnpay', '109990000', 'Chưa thanh toán')
2025-07-06 16:44:08 - Đơn hàng VNPay đã tạo, trả về orderId để frontend tự gọi sang vnpay_create.php
2025-07-06 16:44:08 - Khởi tạo thanh toán VNPay cho đơn hàng 7: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=10999000000&vnp_Command=pay&vnp_CreateDate=20250706164408&vnp_CurrCode=VND&vnp_ExpireDate=20250706171408&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+7&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%3A8080%2Fvnpay_callback.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=7&vnp_Version=2.1.0&vnp_SecureHash=ff65400da2149a79ce19e38b4112d85fb579727e43d4f419f1f60ef60c877c50ba9c4355f2676ebcca690b58bb1054a47a2536854483c1d7e5f2276b5f66eb5a
2025-07-06 16:44:55 - --------- Gỡ lỗi Callback VNPay ---------
2025-07-06 16:44:55 - Tất cả tham số GET: {"vnp_Amount":"10999000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15058686","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 7","vnp_PayDate":"20250706164544","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15058686","vnp_TransactionStatus":"00","vnp_TxnRef":"7","vnp_SecureHash":"9bfdbd2e09d7913edb221c768d32860ebd4d84a4cd20a6df7e5c8c377d789ca650332cb0d0e6bbbe772aacc146eedb2ece025ec7a5748a4b53ab8b0f2b75fb02"}
2025-07-06 16:44:55 - vnp_SecureHash nhận được: 9bfdbd2e09d7913edb221c768d32860ebd4d84a4cd20a6df7e5c8c377d789ca650332cb0d0e6bbbe772aacc146eedb2ece025ec7a5748a4b53ab8b0f2b75fb02
2025-07-06 16:44:55 - inputData sau khi sắp xếp: {"vnp_Amount":"10999000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15058686","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 7","vnp_PayDate":"20250706164544","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15058686","vnp_TransactionStatus":"00","vnp_TxnRef":"7"}
2025-07-06 16:44:55 - Chuỗi hashData: vnp_Amount=10999000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP15058686&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+7&vnp_PayDate=20250706164544&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=15058686&vnp_TransactionStatus=00&vnp_TxnRef=7
2025-07-06 16:44:55 - secureHash được tạo: 9bfdbd2e09d7913edb221c768d32860ebd4d84a4cd20a6df7e5c8c377d789ca650332cb0d0e6bbbe772aacc146eedb2ece025ec7a5748a4b53ab8b0f2b75fb02
2025-07-06 16:44:55 - Khớp hash: Có
2025-07-06 16:44:55 - Trạng thái thanh toán được cập nhật cho đơn hàng 7: Đã thanh toán
2025-07-06 16:44:55 - Cập nhật trạng thái đơn hàng 7 thành 'Đã thanh toán'
2025-07-06 17:13:51 - Nhận yêu cầu: POST /payments.php
2025-07-06 17:13:51 - Kết nối cơ sở dữ liệu thành công
2025-07-06 17:13:51 - Dữ liệu thô: {"userId":"1","cartItems":[{"id":1,"ma_sp":"SP00001","ten":"Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB","gia":1990000,"so_luong":1,"loai":"Linh kiện"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"","ward":"","note":""},"paymentMethod":"vnpay","shippingMethod":"pickup","shippingCost":0,"totalAmount":1990000,"orderDate":"2025-07-06T10:13:51.229Z"}
2025-07-06 17:13:51 - Chuyển đổi ngay_dat_hang: 2025-07-06T10:13:51.229Z thành 2025-07-06 10:13:51
2025-07-06 17:13:51 - Xác thực đầu vào thành công
2025-07-06 17:13:51 - Tạo địa chỉ giao hàng mới với ID: 8 cho pickup
2025-07-06 17:13:51 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '8', '1990000', '0', 'Chờ xử lý', '2025-07-06 10:13:51', '')
2025-07-06 17:13:51 - Chèn đơn hàng với ID: 8
2025-07-06 17:13:51 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('8', 'SP00001', '1', '1990000', '0')
2025-07-06 17:13:51 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('8', 'Khách: admin; Sản phẩm: Ổ cứng di động SSD ADATA SC750 USB 3.2 Gen 2 1050MB/s 1TB (x1); Địa chỉ: Lấy tại cửa hàng; Ghi chú: ; Phương thức: vnpay', '1990000')
2025-07-06 17:13:51 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('8', 'vnpay', '1990000', 'Chưa thanh toán')
2025-07-06 17:13:51 - Đơn hàng VNPay đã tạo, trả về orderId để frontend tự gọi sang vnpay_create.php
2025-07-06 17:13:52 - Khởi tạo thanh toán VNPay cho đơn hàng 8: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=199000000&vnp_Command=pay&vnp_CreateDate=20250706171352&vnp_CurrCode=VND&vnp_ExpireDate=20250706174352&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+8&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%3A8080%2Fvnpay_callback.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=8&vnp_Version=2.1.0&vnp_SecureHash=dce549dc81b65146b098850116df192b51933140aa594ee0fe8bfee28e0c6424d5ccf6cf6053dc141eeff436e154be46921af26d8782d69dfc7a2cf667fad396
2025-07-06 17:14:27 - --------- Gỡ lỗi Callback VNPay ---------
2025-07-06 17:14:27 - Tất cả tham số GET: {"vnp_Amount":"199000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15058731","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 8","vnp_PayDate":"20250706171516","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15058731","vnp_TransactionStatus":"00","vnp_TxnRef":"8","vnp_SecureHash":"3392f7fb50b00593074ccf839bfb468e35841dc4c7f9535ac1bd4777de97caa79861a873c51fd12a9e041735c316546d6a3b56f49b11b16ed34d3ea990ecfc81"}
2025-07-06 17:14:27 - vnp_SecureHash nhận được: 3392f7fb50b00593074ccf839bfb468e35841dc4c7f9535ac1bd4777de97caa79861a873c51fd12a9e041735c316546d6a3b56f49b11b16ed34d3ea990ecfc81
2025-07-06 17:14:28 - inputData sau khi sắp xếp: {"vnp_Amount":"199000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15058731","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 8","vnp_PayDate":"20250706171516","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15058731","vnp_TransactionStatus":"00","vnp_TxnRef":"8"}
2025-07-06 17:14:28 - Chuỗi hashData: vnp_Amount=199000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP15058731&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+8&vnp_PayDate=20250706171516&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=15058731&vnp_TransactionStatus=00&vnp_TxnRef=8
2025-07-06 17:14:28 - secureHash được tạo: 3392f7fb50b00593074ccf839bfb468e35841dc4c7f9535ac1bd4777de97caa79861a873c51fd12a9e041735c316546d6a3b56f49b11b16ed34d3ea990ecfc81
2025-07-06 17:14:28 - Khớp hash: Có
2025-07-06 17:14:28 - Trạng thái thanh toán được cập nhật cho đơn hàng 8: Đã thanh toán
2025-07-06 17:14:28 - Cập nhật trạng thái đơn hàng 8 thành 'Đã thanh toán'
2025-07-07 18:01:45 - Nhận yêu cầu: POST /payments.php
2025-07-07 18:01:45 - Kết nối cơ sở dữ liệu thành công
2025-07-07 18:01:45 - Dữ liệu thô: {"userId":"1","cartItems":[{"id_product":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"danh_muc":"Card màn hình"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":109990000,"orderDate":"2025-07-07T11:01:44.907Z"}
2025-07-07 18:01:45 - Chuyển đổi ngay_dat_hang: 2025-07-07T11:01:44.907Z thành 2025-07-07 11:01:44
2025-07-07 18:01:45 - Xác thực đầu vào thành công
2025-07-07 18:01:45 - Tạo địa chỉ giao hàng mới với ID: 9 cho pickup
2025-07-07 18:01:45 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '9', '109990000', '0', 'Chờ xử lý', '2025-07-07 11:01:44', '')
2025-07-07 18:01:45 - Chèn đơn hàng với ID: 9
2025-07-07 18:01:45 - Lỗi khi xử lý đơn hàng: Mục giỏ hàng tại chỉ số 0 thiếu hoặc sai mã sản phẩm (ma_sp): {"id_product":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"danh_muc":"Card m\u00e0n h\u00ecnh"}
2025-07-07 18:05:27 - Nhận yêu cầu: GET /payments.php
2025-07-07 18:05:27 - Kết nối cơ sở dữ liệu thành công
2025-07-07 18:05:27 - Dữ liệu thô: 
2025-07-07 18:05:51 - Nhận yêu cầu: POST /payments.php
2025-07-07 18:05:51 - Kết nối cơ sở dữ liệu thành công
2025-07-07 18:05:51 - Dữ liệu thô: 
2025-07-07 18:11:57 - Nhận yêu cầu: POST /payments.php
2025-07-07 18:11:57 - Kết nối cơ sở dữ liệu thành công
2025-07-07 18:11:57 - Dữ liệu thô: {"userId":"1","cartItems":[{"ma_sp":2,"ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"danh_muc":"Card màn hình"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":109990000,"orderDate":"2025-07-07T11:11:57.399Z"}
2025-07-07 18:11:57 - Chuyển đổi ngay_dat_hang: 2025-07-07T11:11:57.399Z thành 2025-07-07 11:11:57
2025-07-07 18:11:57 - Xác thực đầu vào thành công
2025-07-07 18:11:57 - Tạo địa chỉ giao hàng mới với ID: 10 cho pickup
2025-07-07 18:11:57 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '10', '109990000', '0', 'Chờ xử lý', '2025-07-07 11:11:57', '')
2025-07-07 18:11:57 - Chèn đơn hàng với ID: 10
2025-07-07 18:11:57 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('10', '2', '1', '109990000', '0')
2025-07-07 18:11:57 - Lỗi khi xử lý đơn hàng: Cannot add or update a child row: a foreign key constraint fails (`form`.`chi_tiet_don_hang`, CONSTRAINT `chi_tiet_don_hang_ibfk_2` FOREIGN KEY (`ma_sp`) REFERENCES `san_pham` (`ma_sp`) ON DELETE CASCADE)
2025-07-07 18:13:56 - Nhận yêu cầu: POST /payments.php
2025-07-07 18:13:56 - Kết nối cơ sở dữ liệu thành công
2025-07-07 18:13:56 - Dữ liệu thô: {"userId":"1","cartItems":[{"ma_sp":"SP00002","ten":"VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING","gia":109990000,"so_luong":1,"danh_muc":"Card màn hình"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"","city":"","district":"","ward":"","note":""},"paymentMethod":"cod","shippingMethod":"pickup","totalAmount":109990000,"orderDate":"2025-07-07T11:13:56.339Z"}
2025-07-07 18:13:56 - Chuyển đổi ngay_dat_hang: 2025-07-07T11:13:56.339Z thành 2025-07-07 11:13:56
2025-07-07 18:13:56 - Xác thực đầu vào thành công
2025-07-07 18:13:56 - Tạo địa chỉ giao hàng mới với ID: 11 cho pickup
2025-07-07 18:13:56 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '11', '109990000', '0', 'Chờ xử lý', '2025-07-07 11:13:56', '')
2025-07-07 18:13:56 - Chèn đơn hàng với ID: 11
2025-07-07 18:13:56 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('11', 'SP00002', '1', '109990000', '0')
2025-07-07 18:13:56 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('11', 'Khách: admin; Sản phẩm: VGA Asus ROG Astral Geforce RTX 5090 OC 32GB ROG-ASTRAL-RTX5090-O32G-GAMING (x1); Địa chỉ: Lấy tại cửa hàng; Ghi chú: ; Phương thức: cod', '109990000')
2025-07-07 18:13:56 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('11', 'cod', '109990000', 'Chưa thanh toán')
2025-07-07 18:13:56 - Giao dịch COD được xác nhận thành công
2025-07-07 18:13:56 - Đóng kết nối cơ sở dữ liệu
2025-07-07 18:16:11 - Nhận yêu cầu: POST /payments.php
2025-07-07 18:16:11 - Kết nối cơ sở dữ liệu thành công
2025-07-07 18:16:11 - Dữ liệu thô: {"userId":"1","cartItems":[{"ma_sp":"SP00003","ten":"Ổ cứng di động SSD Kingston XS1000 USB 3.2 Gen 2 1TB Đen","gia":2090000,"so_luong":1,"danh_muc":"Ổ cứng"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Quận Ba Đình","ward":"Phường Kim Mã","note":"hola"},"paymentMethod":"cod","shippingMethod":"ship","totalAmount":2090000,"orderDate":"2025-07-07T11:16:11.095Z"}
2025-07-07 18:16:11 - Chuyển đổi ngay_dat_hang: 2025-07-07T11:16:11.095Z thành 2025-07-07 11:16:11
2025-07-07 18:16:11 - Xác thực đầu vào thành công
2025-07-07 18:16:11 - Tạo địa chỉ giao hàng mới với ID: 12
2025-07-07 18:16:11 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '12', '2090000', '0', 'Chờ xử lý', '2025-07-07 11:16:11', 'hola')
2025-07-07 18:16:11 - Chèn đơn hàng với ID: 12
2025-07-07 18:16:11 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('12', 'SP00003', '1', '2090000', '0')
2025-07-07 18:16:11 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('12', 'Khách: admin; Sản phẩm: Ổ cứng di động SSD Kingston XS1000 USB 3.2 Gen 2 1TB Đen (x1); Địa chỉ: nhà số 1, Phường Kim Mã, Quận Ba Đình, Thành phố Hà Nội; Ghi chú: hola; Phương thức: cod', '2090000')
2025-07-07 18:16:11 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('12', 'cod', '2090000', 'Chưa thanh toán')
2025-07-07 18:16:11 - Giao dịch COD được xác nhận thành công
2025-07-07 18:16:11 - Đóng kết nối cơ sở dữ liệu
2025-07-07 18:18:26 - Nhận yêu cầu: POST /payments.php
2025-07-07 18:18:26 - Kết nối cơ sở dữ liệu thành công
2025-07-07 18:18:26 - Dữ liệu thô: {"userId":"1","cartItems":[{"ma_sp":"SP00023","ten":"Card màn hình ASUS Phoenix GT 1030 OC Edition 2GB GDDR5","gia":2090000,"so_luong":1,"danh_muc":"Card màn hình"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Quận Hoàn Kiếm","ward":"Phường Hàng Bông","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":2090000,"orderDate":"2025-07-07T11:18:26.211Z"}
2025-07-07 18:18:26 - Chuyển đổi ngay_dat_hang: 2025-07-07T11:18:26.211Z thành 2025-07-07 11:18:26
2025-07-07 18:18:26 - Xác thực đầu vào thành công
2025-07-07 18:18:26 - Tạo địa chỉ giao hàng mới với ID: 13
2025-07-07 18:18:26 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '13', '2090000', '0', 'Chờ xử lý', '2025-07-07 11:18:26', '')
2025-07-07 18:18:26 - Chèn đơn hàng với ID: 13
2025-07-07 18:18:26 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('13', 'SP00023', '1', '2090000', '0')
2025-07-07 18:18:26 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('13', 'Khách: admin; Sản phẩm: Card màn hình ASUS Phoenix GT 1030 OC Edition 2GB GDDR5 (x1); Địa chỉ: nhà số 1, Phường Hàng Bông, Quận Hoàn Kiếm, Thành phố Hà Nội; Ghi chú: ; Phương thức: vnpay', '2090000')
2025-07-07 18:18:26 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('13', 'vnpay', '2090000', 'Chưa thanh toán')
2025-07-07 18:18:26 - Đơn hàng VNPay đã tạo, trả về orderId để frontend tự gọi sang vnpay_create.php
2025-07-07 18:21:36 - Nhận yêu cầu: POST /payments.php
2025-07-07 18:21:36 - Kết nối cơ sở dữ liệu thành công
2025-07-07 18:21:36 - Dữ liệu thô: {"userId":"1","cartItems":[{"ma_sp":"SP00023","ten":"Card màn hình ASUS Phoenix GT 1030 OC Edition 2GB GDDR5","gia":2090000,"so_luong":1,"danh_muc":"Card màn hình"}],"customerInfo":{"fullName":"admin","email":"admin@gmail.com","phone":"1234567890","address":"nhà số 1","city":"Thành phố Hà Nội","district":"Huyện Mê Linh","ward":"Xã Tiền Phong","note":""},"paymentMethod":"vnpay","shippingMethod":"ship","totalAmount":2090000,"orderDate":"2025-07-07T11:21:36.015Z"}
2025-07-07 18:21:36 - Chuyển đổi ngay_dat_hang: 2025-07-07T11:21:36.015Z thành 2025-07-07 11:21:36
2025-07-07 18:21:36 - Xác thực đầu vào thành công
2025-07-07 18:21:36 - Tạo địa chỉ giao hàng mới với ID: 14
2025-07-07 18:21:36 - Thực thi truy vấn chèn đơn hàng: INSERT INTO don_hang (ma_nguoi_dung, ma_dia_chi, tong_tien, phi_van_chuyen, trang_thai, created_at, ghi_chu)
                 VALUES ('1', '14', '2090000', '0', 'Chờ xử lý', '2025-07-07 11:21:36', '')
2025-07-07 18:21:36 - Chèn đơn hàng với ID: 14
2025-07-07 18:21:36 - Thực thi truy vấn chèn chi_tiet_don_hang: INSERT INTO chi_tiet_don_hang (ma_don_hang, ma_sp, so_luong, don_gia, giam_gia) VALUES ('14', 'SP00023', '1', '2090000', '0')
2025-07-07 18:21:36 - Thực thi truy vấn chèn hóa đơn: INSERT INTO hoa_don (ma_don_hang, noi_dung, tong_tien) VALUES ('14', 'Khách: admin; Sản phẩm: Card màn hình ASUS Phoenix GT 1030 OC Edition 2GB GDDR5 (x1); Địa chỉ: nhà số 1, Xã Tiền Phong, Huyện Mê Linh, Thành phố Hà Nội; Ghi chú: ; Phương thức: vnpay', '2090000')
2025-07-07 18:21:36 - Thực thi truy vấn chèn thanh toán: INSERT INTO thanh_toan (ma_don_hang, phuong_thuc, tong_tien, trang_thai) VALUES ('14', 'vnpay', '2090000', 'Chưa thanh toán')
2025-07-07 18:21:36 - Đơn hàng VNPay đã tạo, trả về orderId để frontend tự gọi sang vnpay_create.php
2025-07-07 18:21:36 - Khởi tạo thanh toán VNPay cho đơn hàng 14: https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=209000000&vnp_Command=pay&vnp_CreateDate=20250707182136&vnp_CurrCode=VND&vnp_ExpireDate=20250707185136&vnp_IpAddr=172.18.0.1&vnp_Locale=vn&vnp_OrderInfo=Thanh+toan+don+hang+14&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2Flocalhost%3A8080%2Fvnpay_callback.php&vnp_TmnCode=LYE5QSH7&vnp_TxnRef=14&vnp_Version=2.1.0&vnp_SecureHash=65a7affae66d13953623f5849be9bad1d3d92c3410d029e3cb0af283f723234819a342163bffd544a69f75116b02947bf9aa401c2579af08206c19732c9a095a
2025-07-07 18:22:15 - --------- Gỡ lỗi Callback VNPay ---------
2025-07-07 18:22:15 - Tất cả tham số GET: {"vnp_Amount":"209000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15060713","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 14","vnp_PayDate":"20250707182304","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15060713","vnp_TransactionStatus":"00","vnp_TxnRef":"14","vnp_SecureHash":"e2a302f4009072445c4cf2cb7d237f6e2a99fc7e35027dae356cad2c7e5371a023e27397f3795c00f1bd04029bfc93d94919982b058e6eb66778aecdc7686116"}
2025-07-07 18:22:15 - vnp_SecureHash nhận được: e2a302f4009072445c4cf2cb7d237f6e2a99fc7e35027dae356cad2c7e5371a023e27397f3795c00f1bd04029bfc93d94919982b058e6eb66778aecdc7686116
2025-07-07 18:22:15 - inputData sau khi sắp xếp: {"vnp_Amount":"209000000","vnp_BankCode":"NCB","vnp_BankTranNo":"VNP15060713","vnp_CardType":"ATM","vnp_OrderInfo":"Thanh toan don hang 14","vnp_PayDate":"20250707182304","vnp_ResponseCode":"00","vnp_TmnCode":"LYE5QSH7","vnp_TransactionNo":"15060713","vnp_TransactionStatus":"00","vnp_TxnRef":"14"}
2025-07-07 18:22:15 - Chuỗi hashData: vnp_Amount=209000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP15060713&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang+14&vnp_PayDate=20250707182304&vnp_ResponseCode=00&vnp_TmnCode=LYE5QSH7&vnp_TransactionNo=15060713&vnp_TransactionStatus=00&vnp_TxnRef=14
2025-07-07 18:22:15 - secureHash được tạo: e2a302f4009072445c4cf2cb7d237f6e2a99fc7e35027dae356cad2c7e5371a023e27397f3795c00f1bd04029bfc93d94919982b058e6eb66778aecdc7686116
2025-07-07 18:22:15 - Khớp hash: Có
2025-07-07 18:22:16 - Trạng thái thanh toán được cập nhật cho đơn hàng 14: Đã thanh toán
2025-07-07 18:22:16 - Cập nhật trạng thái đơn hàng 14 thành 'Đã thanh toán'
